<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bill Cresko">

<title>Week 5a - Statistics for Bioengineering – BioEngineering Statistics Spring 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">BioEngineering Statistics Spring 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Policies.html"> 
<span class="menu-text">Policies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Lectures.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Homework.html"> 
<span class="menu-text">Homeworks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#this-week" id="toc-this-week" class="nav-link active" data-scroll-target="#this-week">This week</a></li>
  <li><a href="#statistical-power" id="toc-statistical-power" class="nav-link" data-scroll-target="#statistical-power">Statistical Power</a>
  <ul class="collapse">
  <li><a href="#power" id="toc-power" class="nav-link" data-scroll-target="#power">Power</a></li>
  <li><a href="#power-1" id="toc-power-1" class="nav-link" data-scroll-target="#power-1">Power</a></li>
  <li><a href="#key-components-of-power" id="toc-key-components-of-power" class="nav-link" data-scroll-target="#key-components-of-power">Key components of power</a></li>
  <li><a href="#effect-size-measured-as-cohens-d" id="toc-effect-size-measured-as-cohens-d" class="nav-link" data-scroll-target="#effect-size-measured-as-cohens-d">Effect size measured as Cohen’s D</a></li>
  <li><a href="#why-perform-power-analysis" id="toc-why-perform-power-analysis" class="nav-link" data-scroll-target="#why-perform-power-analysis">Why Perform Power Analysis?</a></li>
  <li><a href="#power-2" id="toc-power-2" class="nav-link" data-scroll-target="#power-2">Power</a></li>
  <li><a href="#power---rough-calculation" id="toc-power---rough-calculation" class="nav-link" data-scroll-target="#power---rough-calculation">Power - rough calculation</a></li>
  <li><a href="#parametric-power-in-r" id="toc-parametric-power-in-r" class="nav-link" data-scroll-target="#parametric-power-in-r">Parametric Power in R</a></li>
  <li><a href="#calculate-sample-size-needed" id="toc-calculate-sample-size-needed" class="nav-link" data-scroll-target="#calculate-sample-size-needed">Calculate sample size needed</a></li>
  <li><a href="#generate-power-curve-for-two-sample-t-test" id="toc-generate-power-curve-for-two-sample-t-test" class="nav-link" data-scroll-target="#generate-power-curve-for-two-sample-t-test">Generate Power Curve for Two-Sample t-Test</a></li>
  <li><a href="#generate-power-curve-for-two-sample-t-test-1" id="toc-generate-power-curve-for-two-sample-t-test-1" class="nav-link" data-scroll-target="#generate-power-curve-for-two-sample-t-test-1">Generate Power Curve for Two-Sample t-Test</a></li>
  <li><a href="#generate-a-sample-curve-for-two-sample-t-test" id="toc-generate-a-sample-curve-for-two-sample-t-test" class="nav-link" data-scroll-target="#generate-a-sample-curve-for-two-sample-t-test">Generate a Sample Curve for Two-Sample t-Test</a></li>
  <li><a href="#plot-power-curve" id="toc-plot-power-curve" class="nav-link" data-scroll-target="#plot-power-curve">Plot power curve</a></li>
  <li><a href="#conduct-a-priori-power-analysis-for-one-way-anova" id="toc-conduct-a-priori-power-analysis-for-one-way-anova" class="nav-link" data-scroll-target="#conduct-a-priori-power-analysis-for-one-way-anova">Conduct A Priori Power Analysis for One-Way ANOVA</a></li>
  <li><a href="#cohens-f" id="toc-cohens-f" class="nav-link" data-scroll-target="#cohens-f">Cohen’s f</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation" id="toc-on-your-own---bootstrap-resampling-power-calculation" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-1" id="toc-on-your-own---bootstrap-resampling-power-calculation-1" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-1">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-2" id="toc-on-your-own---bootstrap-resampling-power-calculation-2" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-2">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-3" id="toc-on-your-own---bootstrap-resampling-power-calculation-3" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-3">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-4" id="toc-on-your-own---bootstrap-resampling-power-calculation-4" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-4">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-5" id="toc-on-your-own---bootstrap-resampling-power-calculation-5" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-5">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-6" id="toc-on-your-own---bootstrap-resampling-power-calculation-6" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-6">On your own - Bootstrap resampling power calculation</a></li>
  </ul></li>
  <li><a href="#linear-models-and-regression" id="toc-linear-models-and-regression" class="nav-link" data-scroll-target="#linear-models-and-regression">Linear Models and Regression</a></li>
  <li><a href="#what-is-a-linear-model" id="toc-what-is-a-linear-model" class="nav-link" data-scroll-target="#what-is-a-linear-model">What is a linear model?</a>
  <ul class="collapse">
  <li><a href="#covariance" id="toc-covariance" class="nav-link" data-scroll-target="#covariance">Covariance</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation">Correlation</a></li>
  <li><a href="#correlation-1" id="toc-correlation-1" class="nav-link" data-scroll-target="#correlation-1">Correlation</a></li>
  <li><a href="#testing-for-correlation" id="toc-testing-for-correlation" class="nav-link" data-scroll-target="#testing-for-correlation">Testing for Correlation</a></li>
  <li><a href="#testing-for-correlation---parametric" id="toc-testing-for-correlation---parametric" class="nav-link" data-scroll-target="#testing-for-correlation---parametric">Testing for Correlation - Parametric</a></li>
  <li><a href="#assumptions-of-parametric-correlation-tests" id="toc-assumptions-of-parametric-correlation-tests" class="nav-link" data-scroll-target="#assumptions-of-parametric-correlation-tests">Assumptions of Parametric Correlation Tests</a></li>
  <li><a href="#nonparametric-correlation-tests" id="toc-nonparametric-correlation-tests" class="nav-link" data-scroll-target="#nonparametric-correlation-tests">Nonparametric Correlation tests</a></li>
  <li><a href="#nonparametric-correlation-tests-1" id="toc-nonparametric-correlation-tests-1" class="nav-link" data-scroll-target="#nonparametric-correlation-tests-1">Nonparametric Correlation tests</a></li>
  <li><a href="#lets-try-it---correlation" id="toc-lets-try-it---correlation" class="nav-link" data-scroll-target="#lets-try-it---correlation">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-1" id="toc-lets-try-it---correlation-1" class="nav-link" data-scroll-target="#lets-try-it---correlation-1">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-2" id="toc-lets-try-it---correlation-2" class="nav-link" data-scroll-target="#lets-try-it---correlation-2">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-3" id="toc-lets-try-it---correlation-3" class="nav-link" data-scroll-target="#lets-try-it---correlation-3">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-4" id="toc-lets-try-it---correlation-4" class="nav-link" data-scroll-target="#lets-try-it---correlation-4">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-5" id="toc-lets-try-it---correlation-5" class="nav-link" data-scroll-target="#lets-try-it---correlation-5">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-6" id="toc-lets-try-it---correlation-6" class="nav-link" data-scroll-target="#lets-try-it---correlation-6">Let’s try it - Correlation</a></li>
  </ul></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a>
  <ul class="collapse">
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#parent-offspring-regression" id="toc-parent-offspring-regression" class="nav-link" data-scroll-target="#parent-offspring-regression">Parent offspring regression</a></li>
  <li><a href="#bivariate-normality" id="toc-bivariate-normality" class="nav-link" data-scroll-target="#bivariate-normality">Bivariate normality</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation">Covariance and correlation</a></li>
  <li><a href="#anscombes-quartet" id="toc-anscombes-quartet" class="nav-link" data-scroll-target="#anscombes-quartet">Anscombe’s Quartet</a></li>
  <li><a href="#anscombes-quartet-1" id="toc-anscombes-quartet-1" class="nav-link" data-scroll-target="#anscombes-quartet-1">Anscombe’s Quartet</a></li>
  <li><a href="#a-linear-model-to-relate-two-variables" id="toc-a-linear-model-to-relate-two-variables" class="nav-link" data-scroll-target="#a-linear-model-to-relate-two-variables">A linear model to relate two variables</a></li>
  <li><a href="#many-approaches-are-linear-models" id="toc-many-approaches-are-linear-models" class="nav-link" data-scroll-target="#many-approaches-are-linear-models">Many approaches are linear models</a></li>
  <li><a href="#many-approaches-are-linear-models-1" id="toc-many-approaches-are-linear-models-1" class="nav-link" data-scroll-target="#many-approaches-are-linear-models-1">Many approaches are linear models</a></li>
  <li><a href="#plethora-of-linear-models" id="toc-plethora-of-linear-models" class="nav-link" data-scroll-target="#plethora-of-linear-models">Plethora of linear models</a></li>
  <li><a href="#linear-models" id="toc-linear-models" class="nav-link" data-scroll-target="#linear-models">Linear models</a></li>
  <li><a href="#linear-model-parameters" id="toc-linear-model-parameters" class="nav-link" data-scroll-target="#linear-model-parameters">linear model parameters</a></li>
  <li><a href="#linear-model-parameters-1" id="toc-linear-model-parameters-1" class="nav-link" data-scroll-target="#linear-model-parameters-1">linear model parameters</a></li>
  <li><a href="#linear-models-in-r" id="toc-linear-models-in-r" class="nav-link" data-scroll-target="#linear-models-in-r">linear models in R</a></li>
  <li><a href="#r-interlude" id="toc-r-interlude" class="nav-link" data-scroll-target="#r-interlude">R INTERLUDE</a></li>
  <li><a href="#r-interlude-1" id="toc-r-interlude-1" class="nav-link" data-scroll-target="#r-interlude-1">R INTERLUDE</a></li>
  <li><a href="#r-interlude---checking-the-output" id="toc-r-interlude---checking-the-output" class="nav-link" data-scroll-target="#r-interlude---checking-the-output">R INTERLUDE - Checking the output</a></li>
  <li><a href="#model-fitting-and-hypothesis-tests-in-regression" id="toc-model-fitting-and-hypothesis-tests-in-regression" class="nav-link" data-scroll-target="#model-fitting-and-hypothesis-tests-in-regression">Model fitting and hypothesis tests in regression</a></li>
  <li><a href="#model-fitting-and-hypothesis-tests-in-regression-1" id="toc-model-fitting-and-hypothesis-tests-in-regression-1" class="nav-link" data-scroll-target="#model-fitting-and-hypothesis-tests-in-regression-1">Model fitting and hypothesis tests in regression</a></li>
  <li><a href="#hypothesis-tests-in-linear-regression" id="toc-hypothesis-tests-in-linear-regression" class="nav-link" data-scroll-target="#hypothesis-tests-in-linear-regression">Hypothesis tests in linear regression</a></li>
  <li><a href="#hypothesis-tests-in-linear-regression-1" id="toc-hypothesis-tests-in-linear-regression-1" class="nav-link" data-scroll-target="#hypothesis-tests-in-linear-regression-1">Hypothesis tests in linear regression</a></li>
  <li><a href="#hypothesis-tests-in-linear-regression-2" id="toc-hypothesis-tests-in-linear-regression-2" class="nav-link" data-scroll-target="#hypothesis-tests-in-linear-regression-2">Hypothesis tests in linear regression</a></li>
  <li><a href="#r2-as-a-measure-of-model-fit" id="toc-r2-as-a-measure-of-model-fit" class="nav-link" data-scroll-target="#r2-as-a-measure-of-model-fit"><span class="math inline">\(r^2\)</span> as a measure of model fit</a></li>
  <li><a href="#relationship-of-correlation-and-regression" id="toc-relationship-of-correlation-and-regression" class="nav-link" data-scroll-target="#relationship-of-correlation-and-regression">Relationship of correlation and regression</a></li>
  <li><a href="#residual-analysis-did-we-meet-our-assumptions" id="toc-residual-analysis-did-we-meet-our-assumptions" class="nav-link" data-scroll-target="#residual-analysis-did-we-meet-our-assumptions">Residual Analysis | did we meet our assumptions?</a></li>
  <li><a href="#residual-analysis-did-we-meet-our-assumptions-1" id="toc-residual-analysis-did-we-meet-our-assumptions-1" class="nav-link" data-scroll-target="#residual-analysis-did-we-meet-our-assumptions-1">Residual Analysis | did we meet our assumptions?</a></li>
  <li><a href="#residual-analysis" id="toc-residual-analysis" class="nav-link" data-scroll-target="#residual-analysis">Residual Analysis</a></li>
  <li><a href="#residual-analysis-1" id="toc-residual-analysis-1" class="nav-link" data-scroll-target="#residual-analysis-1">Residual Analysis</a></li>
  <li><a href="#handling-violations-of-the-assumptions-of-linear-models" id="toc-handling-violations-of-the-assumptions-of-linear-models" class="nav-link" data-scroll-target="#handling-violations-of-the-assumptions-of-linear-models">Handling violations of the assumptions of linear models</a></li>
  <li><a href="#anscombes-quartet-again-what-would-residual-plots-look-like-for-these" id="toc-anscombes-quartet-again-what-would-residual-plots-look-like-for-these" class="nav-link" data-scroll-target="#anscombes-quartet-again-what-would-residual-plots-look-like-for-these">Anscombe’s quartet again | what would residual plots look like for these?</a></li>
  <li><a href="#anscombes-quartet-again-what-would-residual-plots-look-like-for-these-1" id="toc-anscombes-quartet-again-what-would-residual-plots-look-like-for-these-1" class="nav-link" data-scroll-target="#anscombes-quartet-again-what-would-residual-plots-look-like-for-these-1">Anscombe’s quartet again | what would residual plots look like for these?</a></li>
  <li><a href="#residual-plots-spotting-assumption-violations" id="toc-residual-plots-spotting-assumption-violations" class="nav-link" data-scroll-target="#residual-plots-spotting-assumption-violations">Residual Plots | Spotting assumption violations</a></li>
  <li><a href="#residuals-leverage-and-influence" id="toc-residuals-leverage-and-influence" class="nav-link" data-scroll-target="#residuals-leverage-and-influence">Residuals | leverage and influence</a></li>
  <li><a href="#residuals-leverage-and-influence-1" id="toc-residuals-leverage-and-influence-1" class="nav-link" data-scroll-target="#residuals-leverage-and-influence-1">Residuals | leverage and influence</a></li>
  <li><a href="#r-interlude-residual-analyses" id="toc-r-interlude-residual-analyses" class="nav-link" data-scroll-target="#r-interlude-residual-analyses">R INTERLUDE | residual analyses</a></li>
  <li><a href="#r-interlude-residual-analyses-1" id="toc-r-interlude-residual-analyses-1" class="nav-link" data-scroll-target="#r-interlude-residual-analyses-1">R INTERLUDE | residual analyses</a></li>
  <li><a href="#r-interlude-2" id="toc-r-interlude-2" class="nav-link" data-scroll-target="#r-interlude-2">R INTERLUDE</a></li>
  <li><a href="#r-interlude-3" id="toc-r-interlude-3" class="nav-link" data-scroll-target="#r-interlude-3">R INTERLUDE</a></li>
  <li><a href="#what-is-a-glm" id="toc-what-is-a-glm" class="nav-link" data-scroll-target="#what-is-a-glm">What is a GLM?</a></li>
  <li><a href="#how-do-we-factor-in-categorical-variables" id="toc-how-do-we-factor-in-categorical-variables" class="nav-link" data-scroll-target="#how-do-we-factor-in-categorical-variables">How do we factor in categorical variables?</a></li>
  <li><a href="#a-generalized-linear-model" id="toc-a-generalized-linear-model" class="nav-link" data-scroll-target="#a-generalized-linear-model">A Generalized Linear Model</a></li>
  <li><a href="#first-steps-use-a-glm-to-test-wolbachia-infection" id="toc-first-steps-use-a-glm-to-test-wolbachia-infection" class="nav-link" data-scroll-target="#first-steps-use-a-glm-to-test-wolbachia-infection">First steps: use a glm to test Wolbachia infection</a></li>
  <li><a href="#first-steps-use-a-glm-to-test-wolbachia-infection-1" id="toc-first-steps-use-a-glm-to-test-wolbachia-infection-1" class="nav-link" data-scroll-target="#first-steps-use-a-glm-to-test-wolbachia-infection-1">First steps: use a glm to test Wolbachia infection</a></li>
  <li><a href="#interpreting-the-glm" id="toc-interpreting-the-glm" class="nav-link" data-scroll-target="#interpreting-the-glm">Interpreting the GLM</a></li>
  <li><a href="#second-steps---adding-more-variables" id="toc-second-steps---adding-more-variables" class="nav-link" data-scroll-target="#second-steps---adding-more-variables">Second steps - adding more variables</a></li>
  <li><a href="#second-steps---adding-more-variables-1" id="toc-second-steps---adding-more-variables-1" class="nav-link" data-scroll-target="#second-steps---adding-more-variables-1">Second steps - adding more variables</a></li>
  <li><a href="#interpreting-the-glm-1" id="toc-interpreting-the-glm-1" class="nav-link" data-scroll-target="#interpreting-the-glm-1">Interpreting the GLM</a></li>
  <li><a href="#interaction-effects-in-glms" id="toc-interaction-effects-in-glms" class="nav-link" data-scroll-target="#interaction-effects-in-glms">Interaction effects in GLMs</a></li>
  <li><a href="#third-steps---adding-interaction-effects" id="toc-third-steps---adding-interaction-effects" class="nav-link" data-scroll-target="#third-steps---adding-interaction-effects">Third steps - adding interaction effects</a></li>
  <li><a href="#third-steps---adding-interaction-effects-1" id="toc-third-steps---adding-interaction-effects-1" class="nav-link" data-scroll-target="#third-steps---adding-interaction-effects-1">Third steps - adding interaction effects</a></li>
  <li><a href="#how-do-we-know-which-model-to-use" id="toc-how-do-we-know-which-model-to-use" class="nav-link" data-scroll-target="#how-do-we-know-which-model-to-use">How do we know which model to use?</a></li>
  <li><a href="#r-interlude-4" id="toc-r-interlude-4" class="nav-link" data-scroll-target="#r-interlude-4">R INTERLUDE</a></li>
  </ul></li>
  <li><a href="#different-types-of-regression---model-1-and-model-2" id="toc-different-types-of-regression---model-1-and-model-2" class="nav-link" data-scroll-target="#different-types-of-regression---model-1-and-model-2">Different Types of Regression - Model 1 and Model 2</a>
  <ul class="collapse">
  <li><a href="#different-types-of-regression-model-1-and-model-2" id="toc-different-types-of-regression-model-1-and-model-2" class="nav-link" data-scroll-target="#different-types-of-regression-model-1-and-model-2">Different Types of Regression | Model 1 and Model 2</a></li>
  <li><a href="#different-types-of-regression-model-1-and-model-2-1" id="toc-different-types-of-regression-model-1-and-model-2-1" class="nav-link" data-scroll-target="#different-types-of-regression-model-1-and-model-2-1">Different Types of Regression | Model 1 and Model 2</a></li>
  <li><a href="#different-types-of-regression-model-1-and-model-2-2" id="toc-different-types-of-regression-model-1-and-model-2-2" class="nav-link" data-scroll-target="#different-types-of-regression-model-1-and-model-2-2">Different Types of Regression | Model 1 and Model 2</a></li>
  <li><a href="#fitting-more-complicated-models" id="toc-fitting-more-complicated-models" class="nav-link" data-scroll-target="#fitting-more-complicated-models">Fitting more complicated models</a></li>
  <li><a href="#smoothers-and-local-regression" id="toc-smoothers-and-local-regression" class="nav-link" data-scroll-target="#smoothers-and-local-regression">Smoothers and local regression</a></li>
  <li><a href="#r-interlude-model-i-and-ii-regression" id="toc-r-interlude-model-i-and-ii-regression" class="nav-link" data-scroll-target="#r-interlude-model-i-and-ii-regression">R INTERLUDE | Model I and II regression</a></li>
  <li><a href="#r-interlude-model-i-and-ii-regression-1" id="toc-r-interlude-model-i-and-ii-regression-1" class="nav-link" data-scroll-target="#r-interlude-model-i-and-ii-regression-1">R INTERLUDE | Model I and II regression</a></li>
  <li><a href="#r-interlude-model-i-and-ii-regression-2" id="toc-r-interlude-model-i-and-ii-regression-2" class="nav-link" data-scroll-target="#r-interlude-model-i-and-ii-regression-2">R INTERLUDE | Model I and II regression</a></li>
  </ul></li>
  <li><a href="#how-to-present-your-statistical-results" id="toc-how-to-present-your-statistical-results" class="nav-link" data-scroll-target="#how-to-present-your-statistical-results">How to present your statistical results</a>
  <ul class="collapse">
  <li><a href="#style-of-a-results-section" id="toc-style-of-a-results-section" class="nav-link" data-scroll-target="#style-of-a-results-section">Style of a results section</a></li>
  <li><a href="#function-of-a-results-section" id="toc-function-of-a-results-section" class="nav-link" data-scroll-target="#function-of-a-results-section">Function of a results section</a></li>
  <li><a href="#summaries-of-the-statistical-analyses" id="toc-summaries-of-the-statistical-analyses" class="nav-link" data-scroll-target="#summaries-of-the-statistical-analyses">Summaries of the statistical analyses</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#differences-directionality-and-magnitude" id="toc-differences-directionality-and-magnitude" class="nav-link" data-scroll-target="#differences-directionality-and-magnitude">Differences, directionality, and magnitude</a></li>
  <li><a href="#statistical-results-in-text" id="toc-statistical-results-in-text" class="nav-link" data-scroll-target="#statistical-results-in-text">Statistical results in text</a></li>
  <li><a href="#statistical-results-in-text-1" id="toc-statistical-results-in-text-1" class="nav-link" data-scroll-target="#statistical-results-in-text-1">Statistical results in text</a></li>
  </ul></li>
  <li><a href="#ethics-in-statistics-and-data-science" id="toc-ethics-in-statistics-and-data-science" class="nav-link" data-scroll-target="#ethics-in-statistics-and-data-science">Ethics in Statistics and Data Science</a></li>
  <li><a href="#the-history-of-statistics" id="toc-the-history-of-statistics" class="nav-link" data-scroll-target="#the-history-of-statistics">The History of Statistics</a>
  <ul class="collapse">
  <li><a href="#galton-as-the-father-of-eugenics" id="toc-galton-as-the-father-of-eugenics" class="nav-link" data-scroll-target="#galton-as-the-father-of-eugenics">Galton as the Father of Eugenics</a></li>
  <li><a href="#galton-as-the-father-of-eugenics-1" id="toc-galton-as-the-father-of-eugenics-1" class="nav-link" data-scroll-target="#galton-as-the-father-of-eugenics-1">Galton as the Father of Eugenics</a></li>
  <li><a href="#a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s" id="toc-a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s" class="nav-link" data-scroll-target="#a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s">A common sight at state fairs around the U.S. in the 1930s</a></li>
  <li><a href="#galton-with-charles-davenport-and-g.-stanley-hall" id="toc-galton-with-charles-davenport-and-g.-stanley-hall" class="nav-link" data-scroll-target="#galton-with-charles-davenport-and-g.-stanley-hall">Galton with Charles Davenport and G. Stanley Hall</a></li>
  <li><a href="#logo-of-the-us-eugenics-society" id="toc-logo-of-the-us-eugenics-society" class="nav-link" data-scroll-target="#logo-of-the-us-eugenics-society">Logo of the US eugenics society</a></li>
  <li><a href="#eugenics-societies-in-america" id="toc-eugenics-societies-in-america" class="nav-link" data-scroll-target="#eugenics-societies-in-america">Eugenics societies in America</a></li>
  <li><a href="#ra-fisher-and-eugenics-in-london" id="toc-ra-fisher-and-eugenics-in-london" class="nav-link" data-scroll-target="#ra-fisher-and-eugenics-in-london">RA Fisher and Eugenics in London</a></li>
  <li><a href="#ra-fisher-and-eugenics" id="toc-ra-fisher-and-eugenics" class="nav-link" data-scroll-target="#ra-fisher-and-eugenics">RA Fisher and Eugenics</a></li>
  <li><a href="#eugenics-has-a-direct-line-to-hitler-and-nazism" id="toc-eugenics-has-a-direct-line-to-hitler-and-nazism" class="nav-link" data-scroll-target="#eugenics-has-a-direct-line-to-hitler-and-nazism">Eugenics has a direct line to Hitler and Nazism</a></li>
  <li><a href="#sterilizations-continue-in-america" id="toc-sterilizations-continue-in-america" class="nav-link" data-scroll-target="#sterilizations-continue-in-america">Sterilizations continue in America</a></li>
  <li><a href="#so-what-do-we-do-from-here" id="toc-so-what-do-we-do-from-here" class="nav-link" data-scroll-target="#so-what-do-we-do-from-here">So, what do we do from here?</a></li>
  <li><a href="#interested-in-learning-more" id="toc-interested-in-learning-more" class="nav-link" data-scroll-target="#interested-in-learning-more">Interested in learning more?</a></li>
  </ul></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Week5a.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 5a - Statistics for Bioengineering</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bill Cresko </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights23)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="this-week" class="level2">
<h2 class="anchored" data-anchor-id="this-week">This week</h2>
<ul>
<li><p>Finish Power</p></li>
<li><p>Start linear models</p></li>
<li><p>Eugenics foundations of statistics</p></li>
</ul>
</section>
<section id="statistical-power" class="level1">
<h1>Statistical Power</h1>
<section id="power" class="level2">
<h2 class="anchored" data-anchor-id="power">Power</h2>
<ul>
<li>Helps us to interpret the failure to reject a null hypothesis</li>
<li>What factors can affect the power of our experiment - our ability to avoid a Type 2 error?
<ul>
<li>Sample size</li>
<li>Effect size (difference between the groups)</li>
<li>Variance (range of values for this trait/measure)</li>
</ul></li>
</ul>
</section>
<section id="power-1" class="level2">
<h2 class="anchored" data-anchor-id="power-1">Power</h2>
<ul>
<li><strong>Type 1 error</strong> - <span class="math inline">\(\alpha\)</span> - incorrectly rejecting a true null hypothesis
<ul>
<li>This is saying that there is an effect when there isn’t</li>
</ul></li>
<li><strong>Type 2 error</strong> - <span class="math inline">\(\beta\)</span> - incorrectly accepting a false null hypothesis
<ul>
<li>This is saying that there isn’t an effect when there is</li>
</ul></li>
<li>Power is the probability of rejecting a false null hypothesis and avoiding type II error</li>
<li>Mostly we shoot for a power of around 80%</li>
<li>Just like <span class="math inline">\(\alpha\)</span>, we want to calculate our power <strong>in advance</strong></li>
</ul>
</section>
<section id="key-components-of-power" class="level2">
<h2 class="anchored" data-anchor-id="key-components-of-power">Key components of power</h2>
<ul>
<li><strong>Effect Size (ES)</strong>: The magnitude of the difference you expect to detect.</li>
<li><strong>Sampling standard deviation (sd):</strong> a measure of variability within groups</li>
<li><strong>Sample Size (n)</strong>: The number of observations in the study.</li>
<li><strong>Significance Level (</strong><span class="math inline">\(\alpha\)</span><strong>)</strong>: The probability of committing a Type I error (rejecting the null hypothesis when it is true), typically set at 0.05.</li>
<li><strong>Power (1 -</strong> <span class="math inline">\(\beta\)</span><strong>)</strong>: The probability of correctly rejecting the null hypothesis, commonly set at 0.80 or 80%.</li>
</ul>
</section>
<section id="effect-size-measured-as-cohens-d" class="level2">
<h2 class="anchored" data-anchor-id="effect-size-measured-as-cohens-d">Effect size measured as Cohen’s D</h2>
<ul>
<li>Cohen’s d is a statistical measure that quantifies the effect size between two group means, expressing the difference in standard deviation units.</li>
<li>It’s used to determine the magnitude of the difference between two groups in studies, like those using t-tests or ANOVA.</li>
<li>Cohen’s d is calculated by dividing the difference between the two group means by the pooled standard deviation.</li>
</ul>
</section>
<section id="why-perform-power-analysis" class="level2">
<h2 class="anchored" data-anchor-id="why-perform-power-analysis">Why Perform Power Analysis?</h2>
<p>Here are the main reasons Why we Perform Power Analysis.</p>
<ul>
<li><strong><em>Determine Sample Size</em></strong>: To ensure your study has enough participants to detect the expected effect.</li>
<li><strong><em>Assess Test Feasibility</em></strong>: To understand if your study can achieve meaningful results with available resources.</li>
<li><strong><em>Optimize Resource Allocation</em></strong>: To avoid over- or under-sampling, ensuring efficient use of time and resources.</li>
</ul>
</section>
<section id="power-2" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="power-2">Power</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6b.002.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="power---rough-calculation" class="level2">
<h2 class="anchored" data-anchor-id="power---rough-calculation">Power - rough calculation</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6b.003.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="parametric-power-in-r" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="parametric-power-in-r">Parametric Power in R</h2>
<p>R provides several packages for conducting power analysis, including <code>pwr</code> and <code>statmod</code>. We’ll explore examples using the <code>pwr</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>effect_size <span class="ot">&lt;-</span> <span class="fl">0.4</span> <span class="co"># The difference between null and alternative hypotheses</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># The number of observations in each group</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># The standard deviation</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># The significance level</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Type II Error</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pwr_result <span class="ot">&lt;-</span><span class="fu">pwr.t.test</span>(<span class="at">n =</span> sample_size, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">d =</span> effect_size <span class="sc">/</span> sd, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sig.level =</span> alpha,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">"two.sample"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>type_II_error <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pwr_result<span class="sc">$</span>power</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> pwr_result<span class="sc">$</span>power</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(type_II_error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.921476</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07852399</code></pre>
</div>
</div>
</section>
<section id="calculate-sample-size-needed" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="calculate-sample-size-needed">Calculate sample size needed</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for two-sample t-test</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>effect_size_t <span class="ot">&lt;-</span> <span class="fl">2.0</span>  </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sd <span class="sc">&lt;</span> <span class="sc">-</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>d_calc <span class="ot">&lt;-</span> effect_size_t<span class="sc">/</span>sd <span class="co"># Moderate effect size (Cohen's d)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>alpha_t <span class="ot">&lt;-</span> <span class="fl">0.05</span>       <span class="co"># Significance level</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>power_t <span class="ot">&lt;-</span> <span class="fl">0.8</span>        <span class="co"># Desired power</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate required sample size</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>sample_size_t <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(<span class="at">d =</span> d_calc, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sig.level =</span> alpha_t, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">power =</span> power_t, </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">"two.sample"</span>)<span class="sc">$</span>n</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the result</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample Size for Two-Sample t-Test:"</span>, sample_size_t, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Size for Two-Sample t-Test: 63.76561 </code></pre>
</div>
</div>
</section>
<section id="generate-power-curve-for-two-sample-t-test" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="generate-power-curve-for-two-sample-t-test">Generate Power Curve for Two-Sample t-Test</h2>
<p>Now we will generate power curve for Two-Sample t-Test.</p>
<ul>
<li><p>sample_size_curve: Specifies the sample size per group (100 in this case).</p></li>
<li><p>effect_sizes_curve: Defines a range of effect sizes (Cohen’s d) from 0.2 to 0.8 with a step of 0.1.</p></li>
<li><p>Next calculates the power values for the power curve by iterating through the specified range of effect sizes and using the <code>pwr.t.test</code> function for each effect size to calculate power based on the given sample size, significance level, and type of test.</p></li>
<li><p>Finally, plots the power curve using the calculated power values against the effect sizes, with appropriate labels for the axes and title for the plot. It visualizes how power varies with different effect sizes in the two-sample t-test scenario.</p></li>
</ul>
</section>
<section id="generate-power-curve-for-two-sample-t-test-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="generate-power-curve-for-two-sample-t-test-1">Generate Power Curve for Two-Sample t-Test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for power curve</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sample_size_curve <span class="ot">&lt;-</span> <span class="dv">100</span>    <span class="co"># Sample size per group</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>effect_sizes_curve <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="at">by =</span> <span class="fl">0.1</span>)  <span class="co"># Range of effect sizes</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate power values</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>power_values_curve <span class="ot">&lt;-</span> <span class="fu">sapply</span>(effect_sizes_curve, <span class="cf">function</span>(d) <span class="fu">pwr.t.test</span>(<span class="at">d =</span> d, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">n =</span> sample_size_curve, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">sig.level =</span> alpha_t, </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">type =</span> <span class="st">"two.sample"</span>)<span class="sc">$</span>power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot power curve</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(effect_sizes_curve, power_values_curve, <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Power Curve for Two-Sample t-Test"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Effect Size (Cohen's d)"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Power"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="generate-a-sample-curve-for-two-sample-t-test" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="generate-a-sample-curve-for-two-sample-t-test">Generate a Sample Curve for Two-Sample t-Test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>effect_size_t <span class="ot">&lt;-</span> <span class="fl">2.0</span>  </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sd <span class="sc">&lt;</span> <span class="sc">-</span> <span class="fl">2.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>d_calc <span class="ot">&lt;-</span> effect_size_t<span class="sc">/</span>sd  <span class="co"># Moderate effect size (Cohen's d)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>alpha_t <span class="ot">&lt;-</span> <span class="fl">0.05</span>             <span class="co"># Significance level</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>power_t <span class="ot">&lt;-</span> <span class="fl">0.8</span>              <span class="co"># Desired power</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>sample_sizes_curve <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">2</span>)     <span class="co"># Sample size per group</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>effect_sizes_curve <span class="ot">&lt;-</span> <span class="fl">0.4</span>                     <span class="co"># Range of effect sizes</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate power values</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>power_values_curve <span class="ot">&lt;-</span> <span class="fu">sapply</span>(effect_sizes_curve, <span class="cf">function</span>(d) <span class="fu">pwr.t.test</span>(<span class="at">d =</span> d_calc, </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">n =</span> sample_sizes_curve, </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">sig.level =</span> alpha_t, </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">type =</span> <span class="st">"two.sample"</span>)<span class="sc">$</span>power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-power-curve" class="level2">
<h2 class="anchored" data-anchor-id="plot-power-curve">Plot power curve</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sample_sizes_curve, power_values_curve, <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Sample sizes for Two-Sample t-Test"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Sample size"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Power"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conduct-a-priori-power-analysis-for-one-way-anova" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="conduct-a-priori-power-analysis-for-one-way-anova">Conduct A Priori Power Analysis for One-Way ANOVA</h2>
<p>Here, we set the parameters for conducting a one-way ANOVA power analysis, similar to the t-test but with different effect size and significance level.</p>
<p><code>pwr.anova.test</code> function to calculate the required sample size (<code>sample_size_anova</code>) for the one-way ANOVA based on the specified effect size, number of groups (k = 3), significance level, and desired power.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for one-way ANOVA</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>effect_size_anova <span class="ot">&lt;-</span> <span class="fl">0.25</span>  <span class="co"># Small effect size (Cohen's f)</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>alpha_anova <span class="ot">&lt;-</span> <span class="fl">0.05</span>        <span class="co"># Significance level</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>power_anova <span class="ot">&lt;-</span> <span class="fl">0.8</span>         <span class="co"># Desired power</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate required sample size</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>sample_size_anova <span class="ot">&lt;-</span> <span class="fu">pwr.anova.test</span>(<span class="at">k =</span> <span class="dv">3</span>, <span class="at">f =</span> effect_size_anova, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">sig.level =</span> alpha_anova, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">power =</span> power_anova)<span class="sc">$</span>n</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the result</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample Size for One-Way ANOVA:"</span>, sample_size_anova, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Size for One-Way ANOVA: 52.3966 </code></pre>
</div>
</div>
</section>
<section id="cohens-f" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="cohens-f">Cohen’s f</h2>
<ul>
<li><p>Cohen’s f is an effect size statistic used in Analysis of Variance (ANOVA).</p></li>
<li><p>It measures the amount of variance in the dependent variable that is explained by the independent variable(s), or more generally, how much the group means differ from the grand mean.</p></li>
<li><p>Cohen’s f, along with other effect size measures, provides a standardized way to assess the magnitude of the effect observed in an ANOVA, going beyond simply determining statistical significance.</p></li>
<li><p>Cohen’s f is calculated as the square root of the variance due to the independent variable(s) divided by the total variance (or the variance within groups, depending on the specific type of ANOVA).</p></li>
<li><p>Cohen (1988) suggested the following interpretation for f:</p>
<ul>
<li>f = 0.10 is considered a small effect.</li>
<li>f = 0.25 is considered a medium effect.</li>
<li>f = 0.40 is considered a large effect.</li>
</ul></li>
</ul>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation">On your own - Bootstrap resampling power calculation</h2>
<p>Step 1: simulating our true populations</p>
<ul>
<li><p>What is the distribution type?</p></li>
<li><p>What is the effect size: difference in means between populations?</p></li>
<li><p>What is the variance?</p></li>
</ul>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-1">On your own - Bootstrap resampling power calculation</h2>
<p>Step 1: simulating our true populations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>senior <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">5000</span>, <span class="at">lambda =</span> <span class="dv">10</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fresh <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">5000</span>, <span class="at">lambda =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(senior)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fresh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-2">On your own - Bootstrap resampling power calculation</h2>
<p>Step 2: drawing a sample</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sample_s <span class="ot">&lt;-</span> <span class="fu">sample</span>(senior, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>sample_f <span class="ot">&lt;-</span> <span class="fu">sample</span>(fresh, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Step 2: drawing a sample</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-3" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-3">On your own - Bootstrap resampling power calculation</h2>
<p>Step 3: statistical test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sample_f, sample_s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  sample_f and sample_s
t = 2.4498, df = 15.803, p-value = 0.02634
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.4682687 6.5317313
sample estimates:
mean of x mean of y 
     13.3       9.8 </code></pre>
</div>
</div>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-4" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-4">On your own - Bootstrap resampling power calculation</h2>
<p>Step 4: setting up our replicates</p>
<p>Take a look at the “samps_var” vectors, how are they arranged? How would we begin conducting t-tests using each replicate from the two populations?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sample size of 10</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>samps_var_s <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="fu">sample</span>(senior, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>samps_var_f <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="fu">sample</span>(fresh, <span class="at">size =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-5" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-5">On your own - Bootstrap resampling power calculation</h2>
<p>Step 4: Testing our replicates</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setting up a "test" dataframe</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>tests <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>tests<span class="sc">$</span>SampleSize <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"10"</span>, <span class="dv">100</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(samps_var_f)){</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  tests<span class="sc">$</span>result[i] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(samps_var_s[,i], samps_var_f[,i])<span class="sc">$</span>p.value</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tests<span class="sc">$</span>result <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
   68    32 </code></pre>
</div>
</div>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-6" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-6">On your own - Bootstrap resampling power calculation</h2>
<p>Requires a more complex for loop</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># using seq to set up the sample sizes</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>)){</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  samps_var_s <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="fu">sample</span>(senior, <span class="at">size =</span> x))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  samps_var_f <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="fu">sample</span>(fresh, <span class="at">size =</span> x))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  tests <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  tests<span class="sc">$</span>SampleSize <span class="ot">&lt;-</span> <span class="fu">rep</span>(x, <span class="dv">100</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    tests<span class="sc">$</span>p.value[i] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(samps_var_s[,i], samps_var_f[,i])<span class="sc">$</span>p.value</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, tests)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="linear-models-and-regression" class="level1">
<h1>Linear Models and Regression</h1>
</section>
<section id="what-is-a-linear-model" class="level1">
<h1>What is a linear model?</h1>
<ul>
<li><p>So far, we’ve been comparing a single quantitative trait between two groups</p></li>
<li><p>What if we want to compare two quantitative traits and see if there is an interaction between them?</p></li>
<li><p>We can model linear relationships</p>
<p><span class="math display">\[ y = B_0 + B_1 x + e \]</span></p>
<ul>
<li>e represents the “error” (or “residual”) in the model</li>
</ul></li>
<li><p>Function <code>lm()</code> in R</p></li>
</ul>
<section id="covariance" class="level2">
<h2 class="anchored" data-anchor-id="covariance">Covariance</h2>
<ul>
<li>How do we convey that 2 variables covary?</li>
<li>Covariance statistic: multiplies each y and x deviation from its respective mean, sums that product across all observations, and divides by the total number of observations to yield an average</li>
<li>Positive or negative covariance depending on the direction of the relationship, covariance of 0 if no relationship between the two</li>
</ul>
</section>
<section id="correlation" class="level2">
<h2 class="anchored" data-anchor-id="correlation">Correlation</h2>
<ul>
<li>Remember when we said that the larger the mean, the greater the variance?
<ul>
<li>Example: trying to compare mean body weight between elephants and mice</li>
</ul></li>
<li>This also applies to covariance</li>
<li>We can calculate a <em>correlation coefficient</em> to standardize the covariance measure
<ul>
<li>Dividing the covariance y the standard deviations of x and y variables</li>
<li>Ranges from -1 to 1, with closer to 1 indicating a perfect linear relationship, and values close to 0 indicating no relationship</li>
</ul></li>
</ul>
</section>
<section id="correlation-1" class="level2">
<h2 class="anchored" data-anchor-id="correlation-1">Correlation</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="images/week8_correlation.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="testing-for-correlation" class="level2">
<h2 class="anchored" data-anchor-id="testing-for-correlation">Testing for Correlation</h2>
<ul>
<li>We can calculate a t-statistic for our null hypothesis, and there’s a function in R for this!
<ul>
<li><code>cor.test()</code></li>
</ul></li>
<li>What were the null and alternative hypotheses?</li>
</ul>
</section>
<section id="testing-for-correlation---parametric" class="level2">
<h2 class="anchored" data-anchor-id="testing-for-correlation---parametric">Testing for Correlation - Parametric</h2>
<ul>
<li>R function <code>cor.test()</code></li>
<li>Formal hypothesis tests for correlation
<ul>
<li>Null hypothesis is no correlation (CC = 0)</li>
<li>Alternative hypothesis is some correlation (CC &gt; 0 or &lt; 0)</li>
</ul></li>
<li>Remember that parametric tests come with assumptions
<ul>
<li>The relationship being tested is assumed to be linear (as opposed to strongly curvilinear)</li>
<li>The probability distribution of the 2 variables is assumed to be normal</li>
</ul></li>
</ul>
</section>
<section id="assumptions-of-parametric-correlation-tests" class="level2">
<h2 class="anchored" data-anchor-id="assumptions-of-parametric-correlation-tests">Assumptions of Parametric Correlation Tests</h2>
<ul>
<li>Remember that parametric tests come with assumptions</li>
<li>The relationship being tested is assumed to be linear (as opposed to strongly curvilinear)</li>
<li>The probability distribution of the 2 variables is assumed to be normal</li>
</ul>
</section>
<section id="nonparametric-correlation-tests" class="level2">
<h2 class="anchored" data-anchor-id="nonparametric-correlation-tests">Nonparametric Correlation tests</h2>
<ul>
<li><p>Association between variables is monotonic (consistently increasing or decreasing)</p></li>
<li><p>Spearman’s rank correlation test: good for small sample sizes (&lt; 30)</p></li>
<li><p>Kendall’s tau test: appropriate for larger sample sizes (&gt; 30)Testing for Correlation</p></li>
<li><p>Formal hypothesis tests for correlation</p>
<ul>
<li>Null hypothesis is no correlation (CC = 0)</li>
<li>Alternative hypothesis is some correlation (CC &gt; 0 or &lt; 0)</li>
</ul></li>
<li><p>We can calculate a t-statistic for our null hypothesis, and there’s a function in R for this!</p>
<ul>
<li><code>cor.test()</code></li>
</ul></li>
</ul>
</section>
<section id="nonparametric-correlation-tests-1" class="level2">
<h2 class="anchored" data-anchor-id="nonparametric-correlation-tests-1">Nonparametric Correlation tests</h2>
<ul>
<li>Association between variables is monotonic (consistently increasing or decreasing)</li>
<li>Spearman’s rank correlation test: good for small sample sizes (&lt; 30)</li>
<li>Kendall’s tau test: appropriate for larger sample sizes (&gt; 30)</li>
</ul>
</section>
<section id="lets-try-it---correlation" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation">Let’s try it - Correlation</h2>
<ul>
<li>Check out the help page for <code>cor.test()</code></li>
</ul>
</section>
<section id="lets-try-it---correlation-1" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-1">Let’s try it - Correlation</h2>
<ul>
<li>Work with the <code>Drerio_development_complete.csv</code> data set</li>
<li>Load it into R, and refamiliarize yourself with the contents</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fish <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span><span class="st">"Drerio_development_complete.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lets-try-it---correlation-2" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-2">Let’s try it - Correlation</h2>
<ul>
<li>What variables might be correlated in this data set?</li>
<li>Try creating a scatterplot with the different variables. Does anything appear to be correlated?</li>
<li>Plot a histogram of the variables - do they appear to be normally distributed?</li>
</ul>
</section>
<section id="lets-try-it---correlation-3" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-3">Let’s try it - Correlation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fish<span class="sc">$</span>Weight_mg, fish<span class="sc">$</span>Length_cm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lets-try-it---correlation-4" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-4">Let’s try it - Correlation</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lets-try-it---correlation-5" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-5">Let’s try it - Correlation</h2>
<ul>
<li>Run a correlation test</li>
<li>Which method should you use?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lets-try-it---correlation-6" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-6">Let’s try it - Correlation</h2>
<ul>
<li>Run a correlation test</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(fish<span class="sc">$</span>Weight_mg, fish<span class="sc">$</span>Length_cm, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"kendall"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kendall's rank correlation tau

data:  fish$Weight_mg and fish$Length_cm
z = 29.898, p-value &lt; 2.2e-16
alternative hypothesis: true tau is not equal to 0
sample estimates:
      tau 
0.8161046 </code></pre>
</div>
</div>
</section>
</section>
<section id="section" class="level1">
<h1></h1>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">Linear Regression</h2>
<ul>
<li>We can model linear relationships
<ul>
<li><span class="math display">\[ y = B_0 + B_1 x + e \]</span></li>
<li>e represents the “error” (or “residual”) in the model, which accounts for “noise” or random errors in y unexplained by the effect of x</li>
</ul></li>
<li>Function <code>lm()</code> in R</li>
</ul>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
</section>
<section id="parent-offspring-regression" class="level2">
<h2 class="anchored" data-anchor-id="parent-offspring-regression">Parent offspring regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.002.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bivariate-normality" class="level2">
<h2 class="anchored" data-anchor-id="bivariate-normality">Bivariate normality</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.005.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="covariance-and-correlation" class="level2">
<h2 class="anchored" data-anchor-id="covariance-and-correlation">Covariance and correlation</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.006.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anscombes-quartet" class="level2">
<h2 class="anchored" data-anchor-id="anscombes-quartet">Anscombe’s Quartet</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.007.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anscombes-quartet-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="anscombes-quartet-1">Anscombe’s Quartet</h2>
<ul>
<li><p><em>Mean</em> of x in each case 9 (exact)</p></li>
<li><p><em>Variance</em> of x in each case 11 (exact)</p></li>
<li><p>Mean of y in each case 7.50 (to 2 decimal places)</p></li>
<li><p>Variance of y in each case 4.122 or 4.127 (to 3 decimal places)</p></li>
<li><p>Correlation between x and y in each case 0.816 (to 3 decimal places)</p></li>
<li><p>Linear regression line in each case <span class="math display">\[ y = 3.00 + 0.50x\]</span></p></li>
</ul>
</section>
<section id="a-linear-model-to-relate-two-variables" class="level2">
<h2 class="anchored" data-anchor-id="a-linear-model-to-relate-two-variables">A linear model to relate two variables</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.008.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="many-approaches-are-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="many-approaches-are-linear-models">Many approaches are linear models</h2>
<ul>
<li>Is flexible: Applicable to many different study designs</li>
<li>Provides a common set of tools (lm in R for fixed effects)</li>
<li>Includes tools to estimate parameters:
<ul>
<li>(e.g.&nbsp;sizes of effects, like the slope, or change in means)</li>
</ul></li>
<li>Is easier to work with, especially with multiple variables</li>
</ul>
</section>
<section id="many-approaches-are-linear-models-1" class="level2">
<h2 class="anchored" data-anchor-id="many-approaches-are-linear-models-1">Many approaches are linear models</h2>
<ul>
<li>Linear regression</li>
<li>Single factor ANOVA</li>
<li>Analysis of covariance</li>
<li>Multiple regression</li>
<li>Multi-factor ANOVA</li>
<li>Repeated-measures ANOVA</li>
</ul>
</section>
<section id="plethora-of-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="plethora-of-linear-models">Plethora of linear models</h2>
<ul>
<li><p>General Linear Model (<strong>GLM</strong>) - two or more continuous variables</p></li>
<li><p>General Linear Mixed Model (<strong>GLMM</strong>) - a continuous response variable with a mix of continuous and categorical predictor variables</p></li>
<li><p>Generalized Linear Model - a GLMM that doesn’t assume normality of the response (we’ll get to this later)</p></li>
<li><p>Generalized Additive Model (<strong>GAM</strong>) - a model that doesn’t assume linearity (we won’t get to this later)</p></li>
</ul>
</section>
<section id="linear-models" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="linear-models">Linear models</h2>
<p>All an be written in the form</p>
<p>response variable = intercept + (explanatory_variables) + random_error</p>
<p>in the general form:</p>
<p><span class="math display">\[ Y=\beta_0 +\beta_1*X_1 + \beta_2*X_2 +... + error\]</span></p>
<p>where <span class="math inline">\(\beta_0, \beta_1, \beta_2, ....\)</span> are the parameters of the linear model</p>
</section>
<section id="linear-model-parameters" class="level2">
<h2 class="anchored" data-anchor-id="linear-model-parameters">linear model parameters</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.010.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="linear-model-parameters-1" class="level2">
<h2 class="anchored" data-anchor-id="linear-model-parameters-1">linear model parameters</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.009.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="linear-models-in-r" class="level2">
<h2 class="anchored" data-anchor-id="linear-models-in-r">linear models in R</h2>
<p>All of these will <em>include</em> the intercept</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>Y<span class="sc">~</span>X</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>Y<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span>X</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>Y<span class="sc">~</span>X<span class="sc">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All of these will <em>exclude</em> the intercept</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Y<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>X</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>Y<span class="sc">~</span>X<span class="dv">-1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Need to fit the model and then ‘read’ the output</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>trial_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (trial_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude">R INTERLUDE</h2>
<p>Write a script to read in the perchlorate data set. Now, add the code to perform a linear model of two continuous variables. Notice how the output of the linear model is specified to a new variable. Also note that the variables and dataset are placeholders</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>my_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dataset<span class="sc">$</span>variable1 <span class="sc">~</span> dataset<span class="sc">$</span>variable2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now look at a summary of the linear model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my_lm)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s produce a nice regression plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dataset<span class="sc">$</span>variable1 <span class="sc">~</span> dataset<span class="sc">$</span>variable2, <span class="at">col =</span> “blue”)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(my_lm, <span class="at">col =</span> “red”)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that you are adding the fitted line from your linear model Finally, remake this plot in GGPlot2</p>
</section>
<section id="r-interlude-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-1">R INTERLUDE</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Perchlorate_Data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"perchlorate_data.tsv"</span>, <span class="at">header=</span>T)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Perchlorate_Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Strain Perchlorate_Level T4_Hormone_Level Follicle_Area Number_of_Follicles
1     WK                 A         14.54394       704.939                   9
2     WK                 A         26.95434       935.739                   9
3     WK                 A         17.19650       399.945                   9
4     WK                 A         24.01719       568.041                   9
5     WK                 A         20.80560       661.448                  13
6     WK                 A         14.15130       493.970                  13
  Age_Category Testes_Area Testes_Stage
1       Embryo   125119.90            0
2       Embryo   537018.88            0
3       Embryo   407869.97            0
4       Embryo    39241.09            0
5       Embryo     2286.20            0
6       Embryo    27451.35            0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> Perchlorate_Data<span class="sc">$</span>T4_Hormone_Level</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Perchlorate_Data<span class="sc">$</span>Testes_Area</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>perc_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (perc_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
    Min      1Q  Median      3Q     Max 
-295380 -212504 -142136  214571  757801 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 245576.8    30930.4   7.940 2.21e-14 ***
x              727.5      711.5   1.022    0.307    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 270600 on 388 degrees of freedom
Multiple R-squared:  0.002687,  Adjusted R-squared:  0.0001169 
F-statistic: 1.045 on 1 and 388 DF,  p-value: 0.3072</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(perc_lm, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-interlude---checking-the-output" class="level2">
<h2 class="anchored" data-anchor-id="r-interlude---checking-the-output">R INTERLUDE - Checking the output</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lmtable.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-fitting-and-hypothesis-tests-in-regression" class="level2">
<h2 class="anchored" data-anchor-id="model-fitting-and-hypothesis-tests-in-regression">Model fitting and hypothesis tests in regression</h2>
<p><span class="math display">\[H_0 : \beta_0 = 0\]</span> <span class="math display">\[H_0 : \beta_1 = 0\]</span></p>
<p>full model - <span class="math inline">\(y_i = \beta_0 + \beta_1*x_i + error_i\)</span></p>
<p>reduced model - <span class="math inline">\(y_i = \beta_0 + 0*x_i + error_i\)</span></p>
<ol type="1">
<li>fits a “reduced” model without slope term (H0)</li>
<li>fits the “full” model with slope term added back</li>
<li>compares fit of full and reduced models using an F test</li>
</ol>
</section>
<section id="model-fitting-and-hypothesis-tests-in-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="model-fitting-and-hypothesis-tests-in-regression-1">Model fitting and hypothesis tests in regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.011.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hypothesis-tests-in-linear-regression" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="hypothesis-tests-in-linear-regression">Hypothesis tests in linear regression</h2>
<p>Estimation of the variation that is explained by the model (SS_model)</p>
<p>SS_model = SS_total(reduced model) - SS_residual(full model)</p>
<p>The variation that is unexplained by the model (SS_residual)</p>
<p>SS_residual(full model)</p>
</section>
<section id="hypothesis-tests-in-linear-regression-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="hypothesis-tests-in-linear-regression-1">Hypothesis tests in linear regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.012.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hypothesis-tests-in-linear-regression-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="hypothesis-tests-in-linear-regression-2">Hypothesis tests in linear regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.013.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r2-as-a-measure-of-model-fit" class="level2">
<h2 class="anchored" data-anchor-id="r2-as-a-measure-of-model-fit"><span class="math inline">\(r^2\)</span> as a measure of model fit</h2>
<p><span class="math display">\[r^2 = SS_{regression}/SS_{total} = 1 - (SS_{residual}/SS_{total})\]</span> or <span class="math display">\[r^2 = 1 - (SS_{residual(full)}/SS_{total(reduced)})\]</span> Which is the proportion of the variance in Y that is explained by X</p>
</section>
<section id="relationship-of-correlation-and-regression" class="level2">
<h2 class="anchored" data-anchor-id="relationship-of-correlation-and-regression">Relationship of correlation and regression</h2>
<p><span class="math display">\[\beta_{YX}=\rho_{YX}*\sigma_Y/\sigma_X\]</span> <span class="math display">\[b_{YX} = r_{YX}*S_Y/S_X\]</span></p>
</section>
<section id="residual-analysis-did-we-meet-our-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="residual-analysis-did-we-meet-our-assumptions">Residual Analysis | did we meet our assumptions?</h2>
<ul>
<li>Independent errors (residuals)</li>
<li>Equal variance of residuals in all groups</li>
<li>Normally-distributed residuals</li>
<li>Robustness to departures from these assumptions is improved when sample size is large and design is balanced</li>
</ul>
</section>
<section id="residual-analysis-did-we-meet-our-assumptions-1" class="level2">
<h2 class="anchored" data-anchor-id="residual-analysis-did-we-meet-our-assumptions-1">Residual Analysis | did we meet our assumptions?</h2>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 * x_I + \epsilon_i\]</span></p>
</section>
<section id="residual-analysis" class="level2">
<h2 class="anchored" data-anchor-id="residual-analysis">Residual Analysis</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.015.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residual-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="residual-analysis-1">Residual Analysis</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.016.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="handling-violations-of-the-assumptions-of-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="handling-violations-of-the-assumptions-of-linear-models">Handling violations of the assumptions of linear models</h2>
<ul>
<li><p>What if your residuals aren’t normal because of outliers?</p></li>
<li><p>Nonparametric methods exist, but these don’t provide parameter estimates with CIs.</p></li>
<li><p>Robust regression (rlm)</p></li>
<li><p>Randomization tests</p></li>
</ul>
</section>
<section id="anscombes-quartet-again-what-would-residual-plots-look-like-for-these" class="level2">
<h2 class="anchored" data-anchor-id="anscombes-quartet-again-what-would-residual-plots-look-like-for-these">Anscombe’s quartet again | what would residual plots look like for these?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anscombes-quartet-again-what-would-residual-plots-look-like-for-these-1" class="level2">
<h2 class="anchored" data-anchor-id="anscombes-quartet-again-what-would-residual-plots-look-like-for-these-1">Anscombe’s quartet again | what would residual plots look like for these?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.018.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residual-plots-spotting-assumption-violations" class="level2">
<h2 class="anchored" data-anchor-id="residual-plots-spotting-assumption-violations">Residual Plots | Spotting assumption violations</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.020.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residuals-leverage-and-influence" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="residuals-leverage-and-influence">Residuals | leverage and influence</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.021.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>1 is an outlier for both Y and X</li>
<li>2 is not an outlier for either Y or X but has a high residual</li>
<li>3 is an outlier in just X - and thus a high residual - and therefore has high influence as measured by Cook’s D</li>
</ul>
</section>
<section id="residuals-leverage-and-influence-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="residuals-leverage-and-influence-1">Residuals | leverage and influence</h2>
<ul>
<li><p><strong>Leverage</strong> - a measure of how much of an outlier each point is in x-space (on x-axis) and thus only applies to the predictor variable. (Values &gt; 2*(2/n) for simple regression are cause for concern)</p></li>
<li><p><strong>Residuals</strong> - As the residuals are the differences between the observed and predicted values along a vertical plane, they provide a measure of how much of an outlier each point is in y-space (on y-axis). The patterns of residuals against predicted y values (residual plot) are also useful diagnostic tools for investigating linearity and homogeneity of variance assumptions</p></li>
<li><p><strong>Cook’s D</strong> statistic is a measure of the influence of each point on the fitted model (estimated slope) and incorporates both leverage and residuals. Values ≥ 1 (or even approaching 1) correspond to highly influential observations.</p></li>
</ul>
</section>
<section id="r-interlude-residual-analyses" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-residual-analyses">R INTERLUDE | residual analyses</h2>
<p>Let’s look at the zebrafish diet data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> zfish_diet<span class="sc">$</span>Protein</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> zfish_diet<span class="sc">$</span>Weight</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>zfish_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (zfish_lm)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(zfish_lm, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(zfish_lm), <span class="at">breaks=</span><span class="dv">30</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (<span class="fu">residuals</span>(zfish_lm) <span class="sc">~</span> <span class="fu">fitted.values</span>(zfish_lm))</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (<span class="fu">residuals</span>(zfish_lm) <span class="sc">~</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude-residual-analyses-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-residual-analyses-1">R INTERLUDE | residual analyses</h2>
<p>Or apply the plot() function to the linear model object directly</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zfish_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Figure out what these plots are telling you</p>
</section>
<section id="r-interlude-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-2">R INTERLUDE</h2>
<p>How about using the influence.measures function???</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influence.measures</span>(zfish_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Do we have any high leverage observations we need to worry about??? Now go back and try to recreate these graphs in GGPlot2</p>
</section>
<section id="r-interlude-3" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-3">R INTERLUDE</h2>
<hr>
</section>
<section id="what-is-a-glm" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-glm">What is a GLM?</h2>
<ul>
<li><p>General Linear Model (<strong>GLM</strong>) - two or more continuous variables</p>
<ul>
<li>You’ll notice that the function <code>lm()</code> in R can work with a GLM too (via PS6)</li>
</ul></li>
<li><p>Generalized Linear Model - used to conduct linear regressions on non-continuous data, and non-normal data</p></li>
<li><p>General Linear Mixed Model (<strong>GLMM</strong>) - a continuous response variable with a mix of continuous and categorical predictor variables, can be used to model random effects (for more on this, see Peter Ralph’s Advanced Bio Stats class)</p></li>
</ul>
</section>
<section id="how-do-we-factor-in-categorical-variables" class="level2">
<h2 class="anchored" data-anchor-id="how-do-we-factor-in-categorical-variables">How do we factor in categorical variables?</h2>
<ul>
<li>For a single categorical predictor, we can include effects of each factor level:</li>
</ul>
<p><span class="math display">\[ y = B_0 + B_1(x~level1) + B_2(x~level2) +~... ~+ e \]</span></p>
<ul>
<li>Each factor level (ex: for Wolbachia: Yes or No) becomes it’s own “effector” that will change the value of y</li>
<li>Instead of x being a continuous numerical value, for categorical data it will be either a 0 or 1</li>
</ul>
</section>
<section id="a-generalized-linear-model" class="level2">
<h2 class="anchored" data-anchor-id="a-generalized-linear-model">A Generalized Linear Model</h2>
<ul>
<li>Check out the help page in RStudio for <code>glm()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="first-steps-use-a-glm-to-test-wolbachia-infection" class="level2">
<h2 class="anchored" data-anchor-id="first-steps-use-a-glm-to-test-wolbachia-infection">First steps: use a glm to test Wolbachia infection</h2>
<ul>
<li>Set up a <code>glm()</code> to test for the effect of Wolbachia infection on Recombinant Fraction</li>
</ul>
</section>
<section id="first-steps-use-a-glm-to-test-wolbachia-infection-1" class="level2">
<h2 class="anchored" data-anchor-id="first-steps-use-a-glm-to-test-wolbachia-infection-1">First steps: use a glm to test Wolbachia infection</h2>
<ul>
<li>What do these components mean?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(fly<span class="sc">$</span>RecombinantFraction <span class="sc">~</span> fly<span class="sc">$</span>Wolbachia, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">"identity"</span>))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpreting-the-glm" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-glm">Interpreting the GLM</h2>
<ul>
<li>Why is our intercept significant?
<ul>
<li>Remember that the null hypothesis is a model with an intercept and slope of 0</li>
</ul></li>
<li>How would you interpret the “WolbachiaYes” coefficient, especially the estimate and the p value?</li>
</ul>
</section>
<section id="second-steps---adding-more-variables" class="level2">
<h2 class="anchored" data-anchor-id="second-steps---adding-more-variables">Second steps - adding more variables</h2>
<ul>
<li>Now let’s add Food to our model - how does this change our model results?</li>
</ul>
</section>
<section id="second-steps---adding-more-variables-1" class="level2">
<h2 class="anchored" data-anchor-id="second-steps---adding-more-variables-1">Second steps - adding more variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(fly<span class="sc">$</span>RecombinantFraction <span class="sc">~</span> fly<span class="sc">$</span>Wolbachia <span class="sc">+</span> fly<span class="sc">$</span>Food, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpreting-the-glm-1" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-glm-1">Interpreting the GLM</h2>
<ul>
<li>How would you interpret the Intercept and Food coefficients, especially the estimate and the p value?</li>
</ul>
</section>
<section id="interaction-effects-in-glms" class="level2">
<h2 class="anchored" data-anchor-id="interaction-effects-in-glms">Interaction effects in GLMs</h2>
<ul>
<li>You can also model interactions between two categorical variables in glms
<ul>
<li>What if variable x and variable z interact in non-additive ways?</li>
</ul></li>
<li>Use the notation x*z in the formula</li>
</ul>
</section>
<section id="third-steps---adding-interaction-effects" class="level2">
<h2 class="anchored" data-anchor-id="third-steps---adding-interaction-effects">Third steps - adding interaction effects</h2>
<ul>
<li>Let’s finally add an interaction between Wolbachia infection and Food to represent Wolbachia titer in our model</li>
<li>Run the model - what are the results?</li>
</ul>
</section>
<section id="third-steps---adding-interaction-effects-1" class="level2">
<h2 class="anchored" data-anchor-id="third-steps---adding-interaction-effects-1">Third steps - adding interaction effects</h2>
<ul>
<li>How do we interpret these findings?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(fly<span class="sc">$</span>RecombinantFraction <span class="sc">~</span> fly<span class="sc">$</span>Wolbachia <span class="sc">+</span> fly<span class="sc">$</span>Food <span class="sc">+</span> fly<span class="sc">$</span>Wolbachia<span class="sc">*</span>fly<span class="sc">$</span>Food, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="how-do-we-know-which-model-to-use" class="level2">
<h2 class="anchored" data-anchor-id="how-do-we-know-which-model-to-use">How do we know which model to use?</h2>
<ul>
<li>Want to be careful not to <em>overfit</em> your linear model (give too many variables)</li>
<li>The Akaike information criterion (AIC) is a metric for comparing different models to find the best fit
<ul>
<li>Notice the AIC score in your output?</li>
<li>For more on this, take Advanced Bio Stats! Or do some reading on the internet.</li>
</ul></li>
</ul>
<hr>
</section>
<section id="r-interlude-4" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-4">R INTERLUDE</h2>
</section>
</section>
<section id="different-types-of-regression---model-1-and-model-2" class="level1">
<h1>Different Types of Regression - Model 1 and Model 2</h1>
<section id="different-types-of-regression-model-1-and-model-2" class="level2">
<h2 class="anchored" data-anchor-id="different-types-of-regression-model-1-and-model-2">Different Types of Regression | Model 1 and Model 2</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5a.001.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="different-types-of-regression-model-1-and-model-2-1" class="level2">
<h2 class="anchored" data-anchor-id="different-types-of-regression-model-1-and-model-2-1">Different Types of Regression | Model 1 and Model 2</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5a.002.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="different-types-of-regression-model-1-and-model-2-2" class="level2">
<h2 class="anchored" data-anchor-id="different-types-of-regression-model-1-and-model-2-2">Different Types of Regression | Model 1 and Model 2</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5a.003.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fitting-more-complicated-models" class="level2">
<h2 class="anchored" data-anchor-id="fitting-more-complicated-models">Fitting more complicated models</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5a.004.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="smoothers-and-local-regression" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="smoothers-and-local-regression">Smoothers and local regression</h2>
<ul>
<li><strong>running medians</strong> (or less robust running means) generate predicted values that are the medians of the responses in the bands surrounding each observation.</li>
<li><strong>loess and lowesse</strong> (locally weighted scatterplot smoothing) - fit least squares regression lines to successive subsets of the observations weighted according to their distance from the target observation and thus depict changes in the trends throughout the data cloud.</li>
<li><strong>kernel smoothers</strong> - new smoothed y-values are computed as the weighted averages of points within a defined window (bandwidth) or neighbourhood of the original x-values. Hence the bandwidth depends on the scale of the x-axis. Weightings are determined by the type of kernel smoother specified, and for. Nevertheless, the larger the window, the greater the degree of smoothing.</li>
<li><strong>splines</strong> - join together a series of polynomial fits that have been generated after the entire data cloud is split up into a number of smaller windows, the widths of which determine the smoothness of the resulting piecewise polynomial.</li>
</ul>
</section>
<section id="r-interlude-model-i-and-ii-regression" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-model-i-and-ii-regression">R INTERLUDE | Model I and II regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> zfish<span class="sc">$</span>SL</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> zfish<span class="sc">$</span>Weight</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>size_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(size_lm)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y<span class="sc">~</span>x, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(size_lm, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that when we run the <code>lm()</code> function we use Model I regression. Is this appropriate?</p>
</section>
<section id="r-interlude-model-i-and-ii-regression-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-model-i-and-ii-regression-1">R INTERLUDE | Model I and II regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(“lmodel2”)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmodel2)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>size_lm_ModII <span class="ot">&lt;-</span> <span class="fu">lmodel2</span>(y <span class="sc">~</span> x)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>size_lm_ModII</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fl">0.1912797</span>, <span class="at">b=</span><span class="fl">0.1097880</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You should have generated OLS, MA, and SMA regression models, and the last plots SMA line from parameter estimates</p>
</section>
<section id="r-interlude-model-i-and-ii-regression-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-model-i-and-ii-regression-2">R INTERLUDE | Model I and II regression</h2>
<ul>
<li><p>Say you measured green fluorescent protein abundance in cell culture across several key, carefully controlled temperatures.</p></li>
<li><p>You ultimately want to know whether protein expression changes as a function of temperature in your experiment.</p></li>
<li><p>Read in the gfp_temp.tsv data and perform a regression analysis.</p></li>
<li><p>Address the following questions</p>
<ul>
<li>Which is X and which is Y?</li>
<li>Are residual assumptions met?</li>
<li>What model of regression should we use in this case and why?</li>
<li>What is our decision regarding our null hypothesis of no relationship?</li>
</ul></li>
</ul>
</section>
</section>
<section id="how-to-present-your-statistical-results" class="level1">
<h1>How to present your statistical results</h1>
<section id="style-of-a-results-section" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="style-of-a-results-section">Style of a results section</h2>
<ul>
<li>Write the text of the Results section concisely and objectively.</li>
<li>The passive voice will likely dominate here, but use the active voice as much as possible.</li>
<li>Use the past tense.</li>
<li>Avoid repetitive paragraph structures. Do not interpret the data here.</li>
</ul>
</section>
<section id="function-of-a-results-section" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="function-of-a-results-section">Function of a results section</h2>
<ul>
<li><p>The function is to objectively present your key results, without interpretation, in an orderly and logical sequence using both text and illustrative materials (Tables and Figures).</p></li>
<li><p>The results section always begins with text, reporting the key results and referring to figures and tables as you proceed.</p></li>
<li><p>The text of the Results section should be crafted to follow this sequence and highlight the evidence needed to answer the questions/hypotheses you investigated.</p></li>
<li><p>Important negative results should be reported, too. Authors usually write the text of the results section based upon the sequence of Tables and Figures.</p></li>
</ul>
</section>
<section id="summaries-of-the-statistical-analyses" class="level2 smaller flexbox vcenter">
<h2 class="smaller flexbox vcenter anchored" data-anchor-id="summaries-of-the-statistical-analyses">Summaries of the statistical analyses</h2>
<p>May appear either in the text (usually parenthetically) or in the relevant Tables or Figures (in the legend or as footnotes to the Table or Figure). Each Table and Figure must be referenced in the text portion of the results, and you must tell the reader what the key result(s) is that each Table or Figure conveys.</p>
<ul>
<li>Tables and Figures are assigned numbers separately and in the sequence that you will refer to them from the text.
<ul>
<li>The first Table you refer to is Table 1, the next Table 2 and so forth.</li>
<li>Similarly, the first Figure is Figure 1, the next Figure 2, etc.</li>
</ul></li>
<li>Each Table or Figure must include a brief description of the results being presented and other necessary information in a legend.
<ul>
<li>Table legends go above the Table; tables are read from top to bottom.</li>
<li>Figure legends go below the figure; figures are usually viewed from bottom to top.</li>
</ul></li>
<li>When referring to a Figure from the text, “Figure” is abbreviated as Fig.,e.g., (Fig. 1. Table is never abbreviated, e.g., Table 1.</li>
</ul>
</section>
<section id="example" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="example">Example</h2>
<p>For example, suppose you asked the question, “Is the average height of male students the same as female students in a pool of randomly selected Biology majors?” You would first collect height data from large random samples of male and female students. You would then calculate the descriptive statistics for those samples (mean, SD, n, range, etc) and plot these numbers. Suppose you found that male Biology majors are, on average, 12.5 cm taller than female majors; this is the answer to the question. Notice that the outcome of a statistical analysis is not a key result, but rather an analytical tool that helps us understand what is our key result.</p>
</section>
<section id="differences-directionality-and-magnitude" class="level2 smaller flexbox vcenter">
<h2 class="smaller flexbox vcenter anchored" data-anchor-id="differences-directionality-and-magnitude">Differences, directionality, and magnitude</h2>
<ul>
<li><p>Report your results so as to provide as much information as possible to the reader about the nature of differences or relationships.</p></li>
<li><p>For example, if you are testing for differences among groups, and you find a significant difference, it is not sufficient to simply report that “groups A and B were significantly different”. How are they different? How much are they different?</p></li>
<li><p>It is much more informative to say something like, “Group A individuals were 23% larger than those in Group B”, or, “Group B pups gained weight at twice the rate of Group A pups.”</p></li>
<li><p>Report the direction of differences (greater, larger, smaller, etc) and the magnitude of differences (% difference, how many times, etc.) whenever possible.</p></li>
</ul>
</section>
<section id="statistical-results-in-text" class="level2 smaller flexbox vcenter">
<h2 class="smaller flexbox vcenter anchored" data-anchor-id="statistical-results-in-text">Statistical results in text</h2>
<ul>
<li><p>Statistical test summaries (test name, p-value) are usually reported parenthetically in conjunction with the biological results they support. This parenthetical reference should include the statistical test used, the value, degrees of freedom and the level of significance.</p></li>
<li><p>For example, if you found that the mean height of male Biology majors was significantly larger than that of female Biology majors, you might report this result (in blue) and your statistical conclusion (shown in red) as follows:</p>
<ul>
<li>“Males (180.5 ± 5.1 cm; n=34) averaged 12.5 cm taller than females (168 ± 7.6 cm; n=34) in the pool of Biology majors (two-sample t-test, t = 5.78, 33 d.f., p &lt; 0.001).”</li>
</ul></li>
<li><p>If the summary statistics are shown in a figure, the sentence above need not report them specifically, but must include a reference to the figure where they may be seen:</p>
<ul>
<li>“Males averaged 12.5 cm taller than females in the pool of Biology majors (two-sample t-test, t = 5.78, 33 d.f., p &lt; 0.001; Fig. 1).”</li>
</ul></li>
</ul>
</section>
<section id="statistical-results-in-text-1" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="statistical-results-in-text-1">Statistical results in text</h2>
<ul>
<li>Always enter the appropriate units when reporting data or summary statistics.
<ul>
<li>for an individual value you would write, “the mean length was 10 cm”, or, “the maximum time was 140 min.”</li>
<li>When including a measure of variability, place the unit after the error value, e.g., “…was 10 ± 2.3 m”.</li>
<li>Likewise place the unit after the last in a series of numbers all having the same unit. For example: “lengths of 5, 10, 15, and 20 m”, or “no differences were observed after 2, 4, 6, or 8 min. of incubation”.</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="ethics-in-statistics-and-data-science" class="level1">
<h1>Ethics in Statistics and Data Science</h1>
</section>
<section id="the-history-of-statistics" class="level1">
<h1>The History of Statistics</h1>
<section id="galton-as-the-father-of-eugenics" class="level2">
<h2 class="anchored" data-anchor-id="galton-as-the-father-of-eugenics">Galton as the Father of Eugenics</h2>
<ul>
<li>Francis Galton: Darwin’s half cousin</li>
<li>Studied human variation and genetic inheritance
<ul>
<li>Human height, fingerprints, intelligence</li>
<li>Correlation, regression toward the mean, and “nature versus nurture”</li>
<li>Pioneered twin studies</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week6_Galton.jpeg" class="img-fluid figure-img" data-fig.align="center"></p>
<figcaption>Galton</figcaption>
</figure>
</div>
</section>
<section id="galton-as-the-father-of-eugenics-1" class="level2">
<h2 class="anchored" data-anchor-id="galton-as-the-father-of-eugenics-1">Galton as the Father of Eugenics</h2>
<ul>
<li>Believed that intelligence was hereditary based on surveying prominent academics in Europe</li>
<li>Used the ideas of <strong>correlation</strong> and <strong>regression towards the mean</strong> to argue that the upper class should breed amongst themselves to keep those “good genes” pure</li>
<li>Wanted to provide monetary incentives for “good” couples to marry and reproduce as a way to avoid the upper class being genetically muddied by the lower class</li>
</ul>
</section>
<section id="a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s" class="level2">
<h2 class="anchored" data-anchor-id="a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s">A common sight at state fairs around the U.S. in the 1930s</h2>
<ul>
<li>Competitions for the “perfect family” to encourage public consciousness and support for eugenics</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.013.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="galton-with-charles-davenport-and-g.-stanley-hall" class="level2">
<h2 class="anchored" data-anchor-id="galton-with-charles-davenport-and-g.-stanley-hall">Galton with Charles Davenport and G. Stanley Hall</h2>
<ul>
<li>American Eugenics Record Office (ERO) founded in Cold Springs Harbor</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.014.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="logo-of-the-us-eugenics-society" class="level2">
<h2 class="anchored" data-anchor-id="logo-of-the-us-eugenics-society">Logo of the US eugenics society</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.015.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="eugenics-societies-in-america" class="level2">
<h2 class="anchored" data-anchor-id="eugenics-societies-in-america">Eugenics societies in America</h2>
<ul>
<li>Advocated for state laws to ban interracial marriages and promote sterilization of “unfit” individuals (negative eugenics) - especially black, Latinx, and Native American women</li>
<li>30 states passed laws to force mental institution patients to be sterilized</li>
<li>Between 1907 and 1963, over 64,000 individuals were forcibly sterilized under eugenic legislation in the United States</li>
</ul>
</section>
<section id="ra-fisher-and-eugenics-in-london" class="level2">
<h2 class="anchored" data-anchor-id="ra-fisher-and-eugenics-in-london">RA Fisher and Eugenics in London</h2>
<ul>
<li>Developer of Fishers exact test, analysis of variance (ANOVA), null hypothesis, p values, maximum likelihood, probability density functions</li>
<li>Founding Chairman of the University of Cambridge Eugenics Society</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week6_fisher.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:20.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ra-fisher-and-eugenics" class="level2">
<h2 class="anchored" data-anchor-id="ra-fisher-and-eugenics">RA Fisher and Eugenics</h2>
<ul>
<li>1/3rd of his work “The Genetical Theory of Natural Selection” discussed eugenics and his theory that the fall of civilizations was due to the fertility of their upper classes being diminished</li>
<li>Used these statistical methods to test data on human variation to prove biological differences between human races</li>
<li>Eugenics and racism were the primary motivators for many of these statistical tests that we use today</li>
</ul>
</section>
<section id="eugenics-has-a-direct-line-to-hitler-and-nazism" class="level2">
<h2 class="anchored" data-anchor-id="eugenics-has-a-direct-line-to-hitler-and-nazism">Eugenics has a direct line to Hitler and Nazism</h2>
<ul>
<li>Eugenics existed in America (and England) before it became popular in Germany.</li>
<li>By 1933, California had subjected more people to forceful sterilization than all other U.S. states combined.</li>
<li>The forced sterilization program engineered by the Nazis was partly inspired by California’s.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.016.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sterilizations-continue-in-america" class="level2">
<h2 class="anchored" data-anchor-id="sterilizations-continue-in-america">Sterilizations continue in America</h2>
<ul>
<li>Our history books paint Nazi Germany as the primary evil of that time, while we try to cover up our significant role in eugenics</li>
<li>It wasn’t until 1978 that the US passed regulations on sterilization procedures</li>
<li>California only passed a bill to outlaw sterilization of inmates in 2014</li>
<li>Certain members of the genetic engineering community threaten to bring back eugenics ideas</li>
</ul>
</section>
<section id="so-what-do-we-do-from-here" class="level2">
<h2 class="anchored" data-anchor-id="so-what-do-we-do-from-here">So, what do we do from here?</h2>
<ul>
<li>The statistical methods that Galton, Fisher, and others developed are useful science tools</li>
<li>Important to use these tools for good - improving our planet, human health, and technology</li>
<li>Important to acknowledge and not forget the history of science - educate others to avoid repeating history</li>
</ul>
</section>
<section id="interested-in-learning-more" class="level2">
<h2 class="anchored" data-anchor-id="interested-in-learning-more">Interested in learning more?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:20.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>See also “The Gene” by Siddhartha Mukherjee</li>
</ul>
<hr>
</section>
</section>
<section id="section-2" class="level1 smaller">
<h1 class="smaller"></h1>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>