<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bill Cresko">

<title>Week 5a - Statistics for Bioengineering – BioEngineering Statistics Spring 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f7fe251563e67c05764dc4775ff48cfc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">BioEngineering Statistics Spring 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Policies.html"> 
<span class="menu-text">Policies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Lectures.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Homework.html"> 
<span class="menu-text">Homeworks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#this-week" id="toc-this-week" class="nav-link active" data-scroll-target="#this-week">This week</a></li>
  <li><a href="#statistical-power" id="toc-statistical-power" class="nav-link" data-scroll-target="#statistical-power">Statistical Power</a>
  <ul class="collapse">
  <li><a href="#power" id="toc-power" class="nav-link" data-scroll-target="#power">Power</a></li>
  <li><a href="#power-1" id="toc-power-1" class="nav-link" data-scroll-target="#power-1">Power</a></li>
  <li><a href="#key-components-of-power" id="toc-key-components-of-power" class="nav-link" data-scroll-target="#key-components-of-power">Key components of power</a></li>
  <li><a href="#effect-size-measured-as-cohens-d" id="toc-effect-size-measured-as-cohens-d" class="nav-link" data-scroll-target="#effect-size-measured-as-cohens-d">Effect size measured as Cohen’s D</a></li>
  <li><a href="#why-perform-power-analysis" id="toc-why-perform-power-analysis" class="nav-link" data-scroll-target="#why-perform-power-analysis">Why Perform Power Analysis?</a></li>
  <li><a href="#power-2" id="toc-power-2" class="nav-link" data-scroll-target="#power-2">Power</a></li>
  <li><a href="#power---rough-calculation" id="toc-power---rough-calculation" class="nav-link" data-scroll-target="#power---rough-calculation">Power - rough calculation</a></li>
  <li><a href="#parametric-power-in-r" id="toc-parametric-power-in-r" class="nav-link" data-scroll-target="#parametric-power-in-r">Parametric Power in R</a></li>
  <li><a href="#calculate-sample-size-needed" id="toc-calculate-sample-size-needed" class="nav-link" data-scroll-target="#calculate-sample-size-needed">Calculate sample size needed</a></li>
  <li><a href="#generate-power-curve-for-two-sample-t-test" id="toc-generate-power-curve-for-two-sample-t-test" class="nav-link" data-scroll-target="#generate-power-curve-for-two-sample-t-test">Generate Power Curve for Two-Sample t-Test</a></li>
  <li><a href="#generate-power-curve-for-two-sample-t-test-1" id="toc-generate-power-curve-for-two-sample-t-test-1" class="nav-link" data-scroll-target="#generate-power-curve-for-two-sample-t-test-1">Generate Power Curve for Two-Sample t-Test</a></li>
  <li><a href="#generate-a-sample-curve-for-two-sample-t-test" id="toc-generate-a-sample-curve-for-two-sample-t-test" class="nav-link" data-scroll-target="#generate-a-sample-curve-for-two-sample-t-test">Generate a Sample Curve for Two-Sample t-Test</a></li>
  <li><a href="#plot-power-curve" id="toc-plot-power-curve" class="nav-link" data-scroll-target="#plot-power-curve">Plot power curve</a></li>
  <li><a href="#conduct-a-priori-power-analysis-for-one-way-anova" id="toc-conduct-a-priori-power-analysis-for-one-way-anova" class="nav-link" data-scroll-target="#conduct-a-priori-power-analysis-for-one-way-anova">Conduct A Priori Power Analysis for One-Way ANOVA</a></li>
  <li><a href="#cohens-f" id="toc-cohens-f" class="nav-link" data-scroll-target="#cohens-f">Cohen’s f</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation" id="toc-on-your-own---bootstrap-resampling-power-calculation" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-1" id="toc-on-your-own---bootstrap-resampling-power-calculation-1" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-1">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-2" id="toc-on-your-own---bootstrap-resampling-power-calculation-2" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-2">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-3" id="toc-on-your-own---bootstrap-resampling-power-calculation-3" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-3">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-4" id="toc-on-your-own---bootstrap-resampling-power-calculation-4" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-4">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-5" id="toc-on-your-own---bootstrap-resampling-power-calculation-5" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-5">On your own - Bootstrap resampling power calculation</a></li>
  <li><a href="#on-your-own---bootstrap-resampling-power-calculation-6" id="toc-on-your-own---bootstrap-resampling-power-calculation-6" class="nav-link" data-scroll-target="#on-your-own---bootstrap-resampling-power-calculation-6">On your own - Bootstrap resampling power calculation</a></li>
  </ul></li>
  <li><a href="#linear-models-and-regression" id="toc-linear-models-and-regression" class="nav-link" data-scroll-target="#linear-models-and-regression">Linear Models and Regression</a></li>
  <li><a href="#what-is-a-linear-model" id="toc-what-is-a-linear-model" class="nav-link" data-scroll-target="#what-is-a-linear-model">What is a linear model?</a>
  <ul class="collapse">
  <li><a href="#covariance" id="toc-covariance" class="nav-link" data-scroll-target="#covariance">Covariance</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation">Correlation</a></li>
  <li><a href="#correlation-1" id="toc-correlation-1" class="nav-link" data-scroll-target="#correlation-1">Correlation</a></li>
  <li><a href="#testing-for-correlation" id="toc-testing-for-correlation" class="nav-link" data-scroll-target="#testing-for-correlation">Testing for Correlation</a></li>
  <li><a href="#testing-for-correlation---parametric" id="toc-testing-for-correlation---parametric" class="nav-link" data-scroll-target="#testing-for-correlation---parametric">Testing for Correlation - Parametric</a></li>
  <li><a href="#assumptions-of-parametric-correlation-tests" id="toc-assumptions-of-parametric-correlation-tests" class="nav-link" data-scroll-target="#assumptions-of-parametric-correlation-tests">Assumptions of Parametric Correlation Tests</a></li>
  <li><a href="#nonparametric-correlation-tests" id="toc-nonparametric-correlation-tests" class="nav-link" data-scroll-target="#nonparametric-correlation-tests">Nonparametric Correlation tests</a></li>
  <li><a href="#nonparametric-correlation-tests-1" id="toc-nonparametric-correlation-tests-1" class="nav-link" data-scroll-target="#nonparametric-correlation-tests-1">Nonparametric Correlation tests</a></li>
  <li><a href="#lets-try-it---correlation" id="toc-lets-try-it---correlation" class="nav-link" data-scroll-target="#lets-try-it---correlation">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-1" id="toc-lets-try-it---correlation-1" class="nav-link" data-scroll-target="#lets-try-it---correlation-1">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-2" id="toc-lets-try-it---correlation-2" class="nav-link" data-scroll-target="#lets-try-it---correlation-2">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-3" id="toc-lets-try-it---correlation-3" class="nav-link" data-scroll-target="#lets-try-it---correlation-3">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-4" id="toc-lets-try-it---correlation-4" class="nav-link" data-scroll-target="#lets-try-it---correlation-4">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-5" id="toc-lets-try-it---correlation-5" class="nav-link" data-scroll-target="#lets-try-it---correlation-5">Let’s try it - Correlation</a></li>
  <li><a href="#lets-try-it---correlation-6" id="toc-lets-try-it---correlation-6" class="nav-link" data-scroll-target="#lets-try-it---correlation-6">Let’s try it - Correlation</a></li>
  </ul></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a>
  <ul class="collapse">
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#parent-offspring-regression" id="toc-parent-offspring-regression" class="nav-link" data-scroll-target="#parent-offspring-regression">Parent offspring regression</a></li>
  <li><a href="#bivariate-normality" id="toc-bivariate-normality" class="nav-link" data-scroll-target="#bivariate-normality">Bivariate normality</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation">Covariance and correlation</a></li>
  <li><a href="#anscombes-quartet" id="toc-anscombes-quartet" class="nav-link" data-scroll-target="#anscombes-quartet">Anscombe’s Quartet</a></li>
  <li><a href="#anscombes-quartet-1" id="toc-anscombes-quartet-1" class="nav-link" data-scroll-target="#anscombes-quartet-1">Anscombe’s Quartet</a></li>
  <li><a href="#a-linear-model-to-relate-two-variables" id="toc-a-linear-model-to-relate-two-variables" class="nav-link" data-scroll-target="#a-linear-model-to-relate-two-variables">A linear model to relate two variables</a></li>
  <li><a href="#many-approaches-are-linear-models" id="toc-many-approaches-are-linear-models" class="nav-link" data-scroll-target="#many-approaches-are-linear-models">Many approaches are linear models</a></li>
  <li><a href="#many-approaches-are-linear-models-1" id="toc-many-approaches-are-linear-models-1" class="nav-link" data-scroll-target="#many-approaches-are-linear-models-1">Many approaches are linear models</a></li>
  <li><a href="#plethora-of-linear-models" id="toc-plethora-of-linear-models" class="nav-link" data-scroll-target="#plethora-of-linear-models">Plethora of linear models</a></li>
  <li><a href="#linear-models" id="toc-linear-models" class="nav-link" data-scroll-target="#linear-models">Linear models</a></li>
  <li><a href="#linear-model-parameters" id="toc-linear-model-parameters" class="nav-link" data-scroll-target="#linear-model-parameters">linear model parameters</a></li>
  <li><a href="#linear-model-parameters-1" id="toc-linear-model-parameters-1" class="nav-link" data-scroll-target="#linear-model-parameters-1">linear model parameters</a></li>
  <li><a href="#linear-models-in-r" id="toc-linear-models-in-r" class="nav-link" data-scroll-target="#linear-models-in-r">linear models in R</a></li>
  <li><a href="#r-interlude" id="toc-r-interlude" class="nav-link" data-scroll-target="#r-interlude">R INTERLUDE</a></li>
  <li><a href="#r-interlude-1" id="toc-r-interlude-1" class="nav-link" data-scroll-target="#r-interlude-1">R INTERLUDE</a></li>
  <li><a href="#r-interlude---checking-the-output" id="toc-r-interlude---checking-the-output" class="nav-link" data-scroll-target="#r-interlude---checking-the-output">R INTERLUDE - Checking the output</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Week5a.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 5a - Statistics for Bioengineering</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bill Cresko </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights23)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="this-week" class="level2">
<h2 class="anchored" data-anchor-id="this-week">This week</h2>
<ul>
<li><p>Finish Power</p></li>
<li><p>Start linear models</p></li>
<li><p>Eugenics foundations of statistics</p></li>
</ul>
</section>
<section id="statistical-power" class="level1">
<h1>Statistical Power</h1>
<section id="power" class="level2">
<h2 class="anchored" data-anchor-id="power">Power</h2>
<ul>
<li>Helps us to interpret the failure to reject a null hypothesis</li>
<li>What factors can affect the power of our experiment - our ability to avoid a Type 2 error?
<ul>
<li>Sample size</li>
<li>Effect size (difference between the groups)</li>
<li>Variance (range of values for this trait/measure)</li>
</ul></li>
</ul>
</section>
<section id="power-1" class="level2">
<h2 class="anchored" data-anchor-id="power-1">Power</h2>
<ul>
<li><strong>Type 1 error</strong> - <span class="math inline">\(\alpha\)</span> - incorrectly rejecting a true null hypothesis
<ul>
<li>This is saying that there is an effect when there isn’t</li>
</ul></li>
<li><strong>Type 2 error</strong> - <span class="math inline">\(\beta\)</span> - incorrectly accepting a false null hypothesis
<ul>
<li>This is saying that there isn’t an effect when there is</li>
</ul></li>
<li>Power is the probability of rejecting a false null hypothesis and avoiding type II error</li>
<li>Mostly we shoot for a power of around 80%</li>
<li>Just like <span class="math inline">\(\alpha\)</span>, we want to calculate our power <strong>in advance</strong></li>
</ul>
</section>
<section id="key-components-of-power" class="level2">
<h2 class="anchored" data-anchor-id="key-components-of-power">Key components of power</h2>
<ul>
<li><strong>Effect Size (ES)</strong>: The magnitude of the difference you expect to detect.</li>
<li><strong>Sampling standard deviation (sd):</strong> a measure of variability within groups</li>
<li><strong>Sample Size (n)</strong>: The number of observations in the study.</li>
<li><strong>Significance Level (</strong><span class="math inline">\(\alpha\)</span><strong>)</strong>: The probability of committing a Type I error (rejecting the null hypothesis when it is true), typically set at 0.05.</li>
<li><strong>Power (1 -</strong> <span class="math inline">\(\beta\)</span><strong>)</strong>: The probability of correctly rejecting the null hypothesis, commonly set at 0.80 or 80%.</li>
</ul>
</section>
<section id="effect-size-measured-as-cohens-d" class="level2">
<h2 class="anchored" data-anchor-id="effect-size-measured-as-cohens-d">Effect size measured as Cohen’s D</h2>
<ul>
<li>Cohen’s d is a statistical measure that quantifies the effect size between two group means, expressing the difference in standard deviation units.</li>
<li>It’s used to determine the magnitude of the difference between two groups in studies, like those using t-tests or ANOVA.</li>
<li>Cohen’s d is calculated by dividing the difference between the two group means by the pooled standard deviation.</li>
</ul>
</section>
<section id="why-perform-power-analysis" class="level2">
<h2 class="anchored" data-anchor-id="why-perform-power-analysis">Why Perform Power Analysis?</h2>
<p>Here are the main reasons Why we Perform Power Analysis.</p>
<ul>
<li><strong><em>Determine Sample Size</em></strong>: To ensure your study has enough participants to detect the expected effect.</li>
<li><strong><em>Assess Test Feasibility</em></strong>: To understand if your study can achieve meaningful results with available resources.</li>
<li><strong><em>Optimize Resource Allocation</em></strong>: To avoid over- or under-sampling, ensuring efficient use of time and resources.</li>
</ul>
</section>
<section id="power-2" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="power-2">Power</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6b.002.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="power---rough-calculation" class="level2">
<h2 class="anchored" data-anchor-id="power---rough-calculation">Power - rough calculation</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6b.003.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="parametric-power-in-r" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="parametric-power-in-r">Parametric Power in R</h2>
<p>R provides several packages for conducting power analysis, including <code>pwr</code> and <code>statmod</code>. We’ll explore examples using the <code>pwr</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>effect_size <span class="ot">&lt;-</span> <span class="fl">0.4</span> <span class="co"># The difference between null and alternative hypotheses</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># The number of observations in each group</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># The standard deviation</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># The significance level</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Type II Error</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pwr_result <span class="ot">&lt;-</span><span class="fu">pwr.t.test</span>(<span class="at">n =</span> sample_size, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">d =</span> effect_size <span class="sc">/</span> sd, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sig.level =</span> alpha,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">"two.sample"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>type_II_error <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pwr_result<span class="sc">$</span>power</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> pwr_result<span class="sc">$</span>power</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(type_II_error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.921476</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07852399</code></pre>
</div>
</div>
</section>
<section id="calculate-sample-size-needed" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="calculate-sample-size-needed">Calculate sample size needed</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for two-sample t-test</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>effect_size_t <span class="ot">&lt;-</span> <span class="fl">2.0</span>  </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>d_calc <span class="ot">&lt;-</span> effect_size_t<span class="sc">/</span>sd <span class="co"># Moderate effect size (Cohen's d)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>alpha_t <span class="ot">&lt;-</span> <span class="fl">0.05</span>       <span class="co"># Significance level</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>power_t <span class="ot">&lt;-</span> <span class="fl">0.8</span>        <span class="co"># Desired power</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate required sample size</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>sample_size_t <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(<span class="at">d =</span> d_calc, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sig.level =</span> alpha_t, </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">power =</span> power_t, </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">"two.sample"</span>)<span class="sc">$</span>n</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the result</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample Size for Two-Sample t-Test:"</span>, sample_size_t, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Size for Two-Sample t-Test: 16.71472 </code></pre>
</div>
</div>
</section>
<section id="generate-power-curve-for-two-sample-t-test" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="generate-power-curve-for-two-sample-t-test">Generate Power Curve for Two-Sample t-Test</h2>
<p>Now we will generate power curve for Two-Sample t-Test.</p>
<ul>
<li><p>sample_size_curve: Specifies the sample size per group (100 in this case).</p></li>
<li><p>effect_sizes_curve: Defines a range of effect sizes (Cohen’s d) from 0.2 to 0.8 with a step of 0.1.</p></li>
<li><p>Next calculates the power values for the power curve by iterating through the specified range of effect sizes and using the <code>pwr.t.test</code> function for each effect size to calculate power based on the given sample size, significance level, and type of test.</p></li>
<li><p>Finally, plots the power curve using the calculated power values against the effect sizes, with appropriate labels for the axes and title for the plot. It visualizes how power varies with different effect sizes in the two-sample t-test scenario.</p></li>
</ul>
</section>
<section id="generate-power-curve-for-two-sample-t-test-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="generate-power-curve-for-two-sample-t-test-1">Generate Power Curve for Two-Sample t-Test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for power curve</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sample_size_curve <span class="ot">&lt;-</span> <span class="dv">100</span>    <span class="co"># Sample size per group</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>effect_sizes_curve <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="at">by =</span> <span class="fl">0.1</span>)  <span class="co"># Range of effect sizes</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate power values</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>power_values_curve <span class="ot">&lt;-</span> <span class="fu">sapply</span>(effect_sizes_curve, <span class="cf">function</span>(d) <span class="fu">pwr.t.test</span>(<span class="at">d =</span> d, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">n =</span> sample_size_curve, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">sig.level =</span> alpha_t, </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">type =</span> <span class="st">"two.sample"</span>)<span class="sc">$</span>power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot power curve</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(effect_sizes_curve, power_values_curve, <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Power Curve for Two-Sample t-Test"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Effect Size (Cohen's d)"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Power"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="generate-a-sample-curve-for-two-sample-t-test" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="generate-a-sample-curve-for-two-sample-t-test">Generate a Sample Curve for Two-Sample t-Test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>effect_size_t <span class="ot">&lt;-</span> <span class="fl">2.0</span>  </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sd <span class="sc">&lt;</span> <span class="sc">-</span> <span class="fl">2.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>d_calc <span class="ot">&lt;-</span> effect_size_t<span class="sc">/</span>sd  <span class="co"># Moderate effect size (Cohen's d)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>alpha_t <span class="ot">&lt;-</span> <span class="fl">0.05</span>             <span class="co"># Significance level</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>power_t <span class="ot">&lt;-</span> <span class="fl">0.8</span>              <span class="co"># Desired power</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>sample_sizes_curve <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">2</span>)     <span class="co"># Sample size per group</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>effect_sizes_curve <span class="ot">&lt;-</span> <span class="fl">0.4</span>                     <span class="co"># Range of effect sizes</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate power values</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>power_values_curve <span class="ot">&lt;-</span> <span class="fu">sapply</span>(effect_sizes_curve, <span class="cf">function</span>(d) <span class="fu">pwr.t.test</span>(<span class="at">d =</span> d_calc, </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">n =</span> sample_sizes_curve, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">sig.level =</span> alpha_t, </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">type =</span> <span class="st">"two.sample"</span>)<span class="sc">$</span>power)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-power-curve" class="level2">
<h2 class="anchored" data-anchor-id="plot-power-curve">Plot power curve</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sample_sizes_curve, power_values_curve, <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Sample sizes for Two-Sample t-Test"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Sample size"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Power"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conduct-a-priori-power-analysis-for-one-way-anova" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="conduct-a-priori-power-analysis-for-one-way-anova">Conduct A Priori Power Analysis for One-Way ANOVA</h2>
<p>Here, we set the parameters for conducting a one-way ANOVA power analysis, similar to the t-test but with different effect size and significance level.</p>
<p><code>pwr.anova.test</code> function to calculate the required sample size (<code>sample_size_anova</code>) for the one-way ANOVA based on the specified effect size, number of groups (k = 3), significance level, and desired power.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for one-way ANOVA</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>effect_size_anova <span class="ot">&lt;-</span> <span class="fl">0.25</span>  <span class="co"># Small effect size (Cohen's f)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>alpha_anova <span class="ot">&lt;-</span> <span class="fl">0.05</span>        <span class="co"># Significance level</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>power_anova <span class="ot">&lt;-</span> <span class="fl">0.8</span>         <span class="co"># Desired power</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate required sample size</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>sample_size_anova <span class="ot">&lt;-</span> <span class="fu">pwr.anova.test</span>(<span class="at">k =</span> <span class="dv">3</span>, <span class="at">f =</span> effect_size_anova, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">sig.level =</span> alpha_anova, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">power =</span> power_anova)<span class="sc">$</span>n</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the result</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample Size for One-Way ANOVA:"</span>, sample_size_anova, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample Size for One-Way ANOVA: 52.3966 </code></pre>
</div>
</div>
</section>
<section id="cohens-f" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="cohens-f">Cohen’s f</h2>
<ul>
<li><p>Cohen’s f is an effect size statistic used in Analysis of Variance (ANOVA).</p></li>
<li><p>It measures the amount of variance in the dependent variable that is explained by the independent variable(s), or more generally, how much the group means differ from the grand mean.</p></li>
<li><p>Cohen’s f, along with other effect size measures, provides a standardized way to assess the magnitude of the effect observed in an ANOVA, going beyond simply determining statistical significance.</p></li>
<li><p>Cohen’s f is calculated as the square root of the variance due to the independent variable(s) divided by the total variance (or the variance within groups, depending on the specific type of ANOVA).</p></li>
<li><p>Cohen (1988) suggested the following interpretation for f:</p>
<ul>
<li>f = 0.10 is considered a small effect.</li>
<li>f = 0.25 is considered a medium effect.</li>
<li>f = 0.40 is considered a large effect.</li>
</ul></li>
</ul>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation">On your own - Bootstrap resampling power calculation</h2>
<p>Step 1: simulating our true populations</p>
<ul>
<li><p>What is the distribution type?</p></li>
<li><p>What is the effect size: difference in means between populations?</p></li>
<li><p>What is the variance?</p></li>
</ul>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-1">On your own - Bootstrap resampling power calculation</h2>
<p>Step 1: simulating our true populations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>senior <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">5000</span>, <span class="at">lambda =</span> <span class="dv">10</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fresh <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">5000</span>, <span class="at">lambda =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(senior)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fresh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-2">On your own - Bootstrap resampling power calculation</h2>
<p>Step 2: drawing a sample</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sample_s <span class="ot">&lt;-</span> <span class="fu">sample</span>(senior, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>sample_f <span class="ot">&lt;-</span> <span class="fu">sample</span>(fresh, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Step 2: drawing a sample</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-3" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-3">On your own - Bootstrap resampling power calculation</h2>
<p>Step 3: statistical test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sample_f, sample_s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  sample_f and sample_s
t = 5.2568, df = 16.488, p-value = 7.097e-05
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 4.064332 9.535668
sample estimates:
mean of x mean of y 
     14.5       7.7 </code></pre>
</div>
</div>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-4" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-4">On your own - Bootstrap resampling power calculation</h2>
<p>Step 4: setting up our replicates</p>
<p>Take a look at the “samps_var” vectors, how are they arranged? How would we begin conducting t-tests using each replicate from the two populations?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## sample size of 10</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>samps_var_s <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="fu">sample</span>(senior, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>samps_var_f <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="fu">sample</span>(fresh, <span class="at">size =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-5" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-5">On your own - Bootstrap resampling power calculation</h2>
<p>Step 4: Testing our replicates</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setting up a "test" dataframe</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>tests <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>tests<span class="sc">$</span>SampleSize <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"10"</span>, <span class="dv">100</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(samps_var_f)){</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  tests<span class="sc">$</span>result[i] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(samps_var_s[,i], samps_var_f[,i])<span class="sc">$</span>p.value</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tests<span class="sc">$</span>result <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
   76    24 </code></pre>
</div>
</div>
</section>
<section id="on-your-own---bootstrap-resampling-power-calculation-6" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="on-your-own---bootstrap-resampling-power-calculation-6">On your own - Bootstrap resampling power calculation</h2>
<p>Requires a more complex for loop</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># using seq to set up the sample sizes</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>)){</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  samps_var_s <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="fu">sample</span>(senior, <span class="at">size =</span> x))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  samps_var_f <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="fu">sample</span>(fresh, <span class="at">size =</span> x))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  tests <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  tests<span class="sc">$</span>SampleSize <span class="ot">&lt;-</span> <span class="fu">rep</span>(x, <span class="dv">100</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    tests<span class="sc">$</span>p.value[i] <span class="ot">&lt;-</span> <span class="fu">t.test</span>(samps_var_s[,i], samps_var_f[,i])<span class="sc">$</span>p.value</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, tests)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="linear-models-and-regression" class="level1">
<h1>Linear Models and Regression</h1>
</section>
<section id="what-is-a-linear-model" class="level1">
<h1>What is a linear model?</h1>
<ul>
<li><p>So far, we’ve been comparing a single quantitative trait between two groups</p></li>
<li><p>What if we want to compare two quantitative traits and see if there is an interaction between them?</p></li>
<li><p>We can model linear relationships</p>
<p><span class="math display">\[ y = B_0 + B_1 x + e \]</span></p>
<ul>
<li>e represents the “error” (or “residual”) in the model</li>
</ul></li>
<li><p>Function <code>lm()</code> in R</p></li>
</ul>
<section id="covariance" class="level2">
<h2 class="anchored" data-anchor-id="covariance">Covariance</h2>
<ul>
<li>How do we convey that 2 variables covary?</li>
<li>Covariance statistic: multiplies each y and x deviation from its respective mean, sums that product across all observations, and divides by the total number of observations to yield an average</li>
<li>Positive or negative covariance depending on the direction of the relationship, covariance of 0 if no relationship between the two</li>
</ul>
</section>
<section id="correlation" class="level2">
<h2 class="anchored" data-anchor-id="correlation">Correlation</h2>
<ul>
<li>Remember when we said that the larger the mean, the greater the variance?
<ul>
<li>Example: trying to compare mean body weight between elephants and mice</li>
</ul></li>
<li>This also applies to covariance</li>
<li>We can calculate a <em>correlation coefficient</em> to standardize the covariance measure
<ul>
<li>Dividing the covariance y the standard deviations of x and y variables</li>
<li>Ranges from -1 to 1, with closer to 1 indicating a perfect linear relationship, and values close to 0 indicating no relationship</li>
</ul></li>
</ul>
</section>
<section id="correlation-1" class="level2">
<h2 class="anchored" data-anchor-id="correlation-1">Correlation</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="images/week8_correlation.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="testing-for-correlation" class="level2">
<h2 class="anchored" data-anchor-id="testing-for-correlation">Testing for Correlation</h2>
<ul>
<li>We can calculate a t-statistic for our null hypothesis, and there’s a function in R for this!
<ul>
<li><code>cor.test()</code></li>
</ul></li>
<li>What were the null and alternative hypotheses?</li>
</ul>
</section>
<section id="testing-for-correlation---parametric" class="level2">
<h2 class="anchored" data-anchor-id="testing-for-correlation---parametric">Testing for Correlation - Parametric</h2>
<ul>
<li>R function <code>cor.test()</code></li>
<li>Formal hypothesis tests for correlation
<ul>
<li>Null hypothesis is no correlation (CC = 0)</li>
<li>Alternative hypothesis is some correlation (CC &gt; 0 or &lt; 0)</li>
</ul></li>
<li>Remember that parametric tests come with assumptions
<ul>
<li>The relationship being tested is assumed to be linear (as opposed to strongly curvilinear)</li>
<li>The probability distribution of the 2 variables is assumed to be normal</li>
</ul></li>
</ul>
</section>
<section id="assumptions-of-parametric-correlation-tests" class="level2">
<h2 class="anchored" data-anchor-id="assumptions-of-parametric-correlation-tests">Assumptions of Parametric Correlation Tests</h2>
<ul>
<li>Remember that parametric tests come with assumptions</li>
<li>The relationship being tested is assumed to be linear (as opposed to strongly curvilinear)</li>
<li>The probability distribution of the 2 variables is assumed to be normal</li>
</ul>
</section>
<section id="nonparametric-correlation-tests" class="level2">
<h2 class="anchored" data-anchor-id="nonparametric-correlation-tests">Nonparametric Correlation tests</h2>
<ul>
<li><p>Association between variables is monotonic (consistently increasing or decreasing)</p></li>
<li><p>Spearman’s rank correlation test: good for small sample sizes (&lt; 30)</p></li>
<li><p>Kendall’s tau test: appropriate for larger sample sizes (&gt; 30)Testing for Correlation</p></li>
<li><p>Formal hypothesis tests for correlation</p>
<ul>
<li>Null hypothesis is no correlation (CC = 0)</li>
<li>Alternative hypothesis is some correlation (CC &gt; 0 or &lt; 0)</li>
</ul></li>
<li><p>We can calculate a t-statistic for our null hypothesis, and there’s a function in R for this!</p>
<ul>
<li><code>cor.test()</code></li>
</ul></li>
</ul>
</section>
<section id="nonparametric-correlation-tests-1" class="level2">
<h2 class="anchored" data-anchor-id="nonparametric-correlation-tests-1">Nonparametric Correlation tests</h2>
<ul>
<li>Association between variables is monotonic (consistently increasing or decreasing)</li>
<li>Spearman’s rank correlation test: good for small sample sizes (&lt; 30)</li>
<li>Kendall’s tau test: appropriate for larger sample sizes (&gt; 30)</li>
</ul>
</section>
<section id="lets-try-it---correlation" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation">Let’s try it - Correlation</h2>
<ul>
<li>Check out the help page for <code>cor.test()</code></li>
</ul>
</section>
<section id="lets-try-it---correlation-1" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-1">Let’s try it - Correlation</h2>
<ul>
<li>Work with the <code>Drerio_development_complete.csv</code> data set</li>
<li>Load it into R, and refamiliarize yourself with the contents</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>fish <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span><span class="st">"Drerio_development_complete.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lets-try-it---correlation-2" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-2">Let’s try it - Correlation</h2>
<ul>
<li>What variables might be correlated in this data set?</li>
<li>Try creating a scatterplot with the different variables. Does anything appear to be correlated?</li>
<li>Plot a histogram of the variables - do they appear to be normally distributed?</li>
</ul>
</section>
<section id="lets-try-it---correlation-3" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-3">Let’s try it - Correlation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fish<span class="sc">$</span>Weight_mg, fish<span class="sc">$</span>Length_cm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lets-try-it---correlation-4" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-4">Let’s try it - Correlation</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lets-try-it---correlation-5" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-5">Let’s try it - Correlation</h2>
<ul>
<li>Run a correlation test</li>
<li>Which method should you use?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lets-try-it---correlation-6" class="level2">
<h2 class="anchored" data-anchor-id="lets-try-it---correlation-6">Let’s try it - Correlation</h2>
<ul>
<li>Run a correlation test</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(fish<span class="sc">$</span>Weight_mg, fish<span class="sc">$</span>Length_cm, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">"kendall"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kendall's rank correlation tau

data:  fish$Weight_mg and fish$Length_cm
z = 29.898, p-value &lt; 2.2e-16
alternative hypothesis: true tau is not equal to 0
sample estimates:
      tau 
0.8161046 </code></pre>
</div>
</div>
</section>
</section>
<section id="section" class="level1">
<h1></h1>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">Linear Regression</h2>
<ul>
<li>We can model linear relationships
<ul>
<li><span class="math display">\[ y = B_0 + B_1 x + e \]</span></li>
<li>e represents the “error” (or “residual”) in the model, which accounts for “noise” or random errors in y unexplained by the effect of x</li>
</ul></li>
<li>Function <code>lm()</code> in R</li>
</ul>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
</section>
<section id="parent-offspring-regression" class="level2">
<h2 class="anchored" data-anchor-id="parent-offspring-regression">Parent offspring regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.002.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bivariate-normality" class="level2">
<h2 class="anchored" data-anchor-id="bivariate-normality">Bivariate normality</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.005.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="covariance-and-correlation" class="level2">
<h2 class="anchored" data-anchor-id="covariance-and-correlation">Covariance and correlation</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.006.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anscombes-quartet" class="level2">
<h2 class="anchored" data-anchor-id="anscombes-quartet">Anscombe’s Quartet</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.007.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anscombes-quartet-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="anscombes-quartet-1">Anscombe’s Quartet</h2>
<ul>
<li><p><em>Mean</em> of x in each case 9 (exact)</p></li>
<li><p><em>Variance</em> of x in each case 11 (exact)</p></li>
<li><p>Mean of y in each case 7.50 (to 2 decimal places)</p></li>
<li><p>Variance of y in each case 4.122 or 4.127 (to 3 decimal places)</p></li>
<li><p>Correlation between x and y in each case 0.816 (to 3 decimal places)</p></li>
<li><p>Linear regression line in each case <span class="math display">\[ y = 3.00 + 0.50x\]</span></p></li>
</ul>
</section>
<section id="a-linear-model-to-relate-two-variables" class="level2">
<h2 class="anchored" data-anchor-id="a-linear-model-to-relate-two-variables">A linear model to relate two variables</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.008.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="many-approaches-are-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="many-approaches-are-linear-models">Many approaches are linear models</h2>
<ul>
<li>Is flexible: Applicable to many different study designs</li>
<li>Provides a common set of tools (lm in R for fixed effects)</li>
<li>Includes tools to estimate parameters:
<ul>
<li>(e.g.&nbsp;sizes of effects, like the slope, or change in means)</li>
</ul></li>
<li>Is easier to work with, especially with multiple variables</li>
</ul>
</section>
<section id="many-approaches-are-linear-models-1" class="level2">
<h2 class="anchored" data-anchor-id="many-approaches-are-linear-models-1">Many approaches are linear models</h2>
<ul>
<li>Linear regression</li>
<li>Single factor ANOVA</li>
<li>Analysis of covariance</li>
<li>Multiple regression</li>
<li>Multi-factor ANOVA</li>
<li>Repeated-measures ANOVA</li>
</ul>
</section>
<section id="plethora-of-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="plethora-of-linear-models">Plethora of linear models</h2>
<ul>
<li><p>General Linear Model (<strong>GLM</strong>) - two or more continuous variables</p></li>
<li><p>General Linear Mixed Model (<strong>GLMM</strong>) - a continuous response variable with a mix of continuous and categorical predictor variables</p></li>
<li><p>Generalized Linear Model - a GLMM that doesn’t assume normality of the response (we’ll get to this later)</p></li>
<li><p>Generalized Additive Model (<strong>GAM</strong>) - a model that doesn’t assume linearity (we won’t get to this later)</p></li>
</ul>
</section>
<section id="linear-models" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="linear-models">Linear models</h2>
<p>All an be written in the form</p>
<p>response variable = intercept + (explanatory_variables) + random_error</p>
<p>in the general form:</p>
<p><span class="math display">\[ Y=\beta_0 +\beta_1*X_1 + \beta_2*X_2 +... + error\]</span></p>
<p>where <span class="math inline">\(\beta_0, \beta_1, \beta_2, ....\)</span> are the parameters of the linear model</p>
</section>
<section id="linear-model-parameters" class="level2">
<h2 class="anchored" data-anchor-id="linear-model-parameters">linear model parameters</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.010.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="linear-model-parameters-1" class="level2">
<h2 class="anchored" data-anchor-id="linear-model-parameters-1">linear model parameters</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.009.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="linear-models-in-r" class="level2">
<h2 class="anchored" data-anchor-id="linear-models-in-r">linear models in R</h2>
<p>All of these will <em>include</em> the intercept</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>Y<span class="sc">~</span>X</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>Y<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span>X</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>Y<span class="sc">~</span>X<span class="sc">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All of these will <em>exclude</em> the intercept</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>Y<span class="sc">~-</span><span class="dv">1</span><span class="sc">+</span>X</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>Y<span class="sc">~</span>X<span class="dv">-1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Need to fit the model and then ‘read’ the output</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>trial_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (trial_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude">R INTERLUDE</h2>
<p>Write a script to read in the perchlorate data set. Now, add the code to perform a linear model of two continuous variables. Notice how the output of the linear model is specified to a new variable. Also note that the variables and dataset are placeholders</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>my_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dataset<span class="sc">$</span>variable1 <span class="sc">~</span> dataset<span class="sc">$</span>variable2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now look at a summary of the linear model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my_lm)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s produce a nice regression plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dataset<span class="sc">$</span>variable1 <span class="sc">~</span> dataset<span class="sc">$</span>variable2, <span class="at">col =</span> “blue”)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(my_lm, <span class="at">col =</span> “red”)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that you are adding the fitted line from your linear model Finally, remake this plot in GGPlot2</p>
</section>
<section id="r-interlude-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-1">R INTERLUDE</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>Perchlorate_Data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"perchlorate_data.tsv"</span>, <span class="at">header=</span>T)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Perchlorate_Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Strain Perchlorate_Level T4_Hormone_Level Follicle_Area Number_of_Follicles
1     WK                 A         14.54394       704.939                   9
2     WK                 A         26.95434       935.739                   9
3     WK                 A         17.19650       399.945                   9
4     WK                 A         24.01719       568.041                   9
5     WK                 A         20.80560       661.448                  13
6     WK                 A         14.15130       493.970                  13
  Age_Category Testes_Area Testes_Stage
1       Embryo   125119.90            0
2       Embryo   537018.88            0
3       Embryo   407869.97            0
4       Embryo    39241.09            0
5       Embryo     2286.20            0
6       Embryo    27451.35            0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> Perchlorate_Data<span class="sc">$</span>T4_Hormone_Level</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Perchlorate_Data<span class="sc">$</span>Testes_Area</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>perc_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (perc_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
    Min      1Q  Median      3Q     Max 
-295380 -212504 -142136  214571  757801 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 245576.8    30930.4   7.940 2.21e-14 ***
x              727.5      711.5   1.022    0.307    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 270600 on 388 degrees of freedom
Multiple R-squared:  0.002687,  Adjusted R-squared:  0.0001169 
F-statistic: 1.045 on 1 and 388 DF,  p-value: 0.3072</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(perc_lm, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5a_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-interlude---checking-the-output" class="level2">
<h2 class="anchored" data-anchor-id="r-interlude---checking-the-output">R INTERLUDE - Checking the output</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lmtable.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2"></h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>