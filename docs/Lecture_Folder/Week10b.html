<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bill Cresko">

<title>Week 10b - Statistics for Bioengineering – BioEngineering Statistics Spring 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f7fe251563e67c05764dc4775ff48cfc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">BioEngineering Statistics Spring 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Policies.html"> 
<span class="menu-text">Policies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Lectures.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Homework.html"> 
<span class="menu-text">Homeworks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#todays-topics" id="toc-todays-topics" class="nav-link active" data-scroll-target="#todays-topics">Today’s Topics</a></li>
  <li><a href="#bias-variance-tradeoff" id="toc-bias-variance-tradeoff" class="nav-link" data-scroll-target="#bias-variance-tradeoff">Bias-Variance Tradeoff</a></li>
  <li><a href="#strategies-to-address-the-tradeoff" id="toc-strategies-to-address-the-tradeoff" class="nav-link" data-scroll-target="#strategies-to-address-the-tradeoff">Strategies to Address the Tradeoff</a></li>
  <li><a href="#decision-trees" id="toc-decision-trees" class="nav-link" data-scroll-target="#decision-trees">Decision Trees</a></li>
  <li><a href="#decision-tree-example" id="toc-decision-tree-example" class="nav-link" data-scroll-target="#decision-tree-example">Decision tree example</a></li>
  <li><a href="#introduction-to-impurity-measures" id="toc-introduction-to-impurity-measures" class="nav-link" data-scroll-target="#introduction-to-impurity-measures">Introduction to Impurity Measures</a></li>
  <li><a href="#what-is-impurity" id="toc-what-is-impurity" class="nav-link" data-scroll-target="#what-is-impurity">What is “Impurity”?</a></li>
  <li><a href="#gini-index-definition" id="toc-gini-index-definition" class="nav-link" data-scroll-target="#gini-index-definition">Gini Index: Definition</a></li>
  <li><a href="#gini-index-examples" id="toc-gini-index-examples" class="nav-link" data-scroll-target="#gini-index-examples">Gini Index: Examples</a></li>
  <li><a href="#entropy-definition" id="toc-entropy-definition" class="nav-link" data-scroll-target="#entropy-definition">Entropy: Definition</a></li>
  <li><a href="#entropy-examples" id="toc-entropy-examples" class="nav-link" data-scroll-target="#entropy-examples">Entropy: Examples</a></li>
  <li><a href="#gini-vs-entropy" id="toc-gini-vs-entropy" class="nav-link" data-scroll-target="#gini-vs-entropy">Gini vs Entropy</a></li>
  <li><a href="#information-gain" id="toc-information-gain" class="nav-link" data-scroll-target="#information-gain">Information Gain</a></li>
  <li><a href="#practical-example" id="toc-practical-example" class="nav-link" data-scroll-target="#practical-example">Practical Example</a></li>
  <li><a href="#calculations-after-split" id="toc-calculations-after-split" class="nav-link" data-scroll-target="#calculations-after-split">Calculations After Split</a></li>
  <li><a href="#calculations-after-split-1" id="toc-calculations-after-split-1" class="nav-link" data-scroll-target="#calculations-after-split-1">Calculations After Split</a></li>
  <li><a href="#building-decision-trees-in-r" id="toc-building-decision-trees-in-r" class="nav-link" data-scroll-target="#building-decision-trees-in-r">Building Decision Trees in R</a></li>
  <li><a href="#building-decision-trees-in-r-1" id="toc-building-decision-trees-in-r-1" class="nav-link" data-scroll-target="#building-decision-trees-in-r-1">Building Decision Trees in R</a></li>
  <li><a href="#building-decision-trees-in-r-2" id="toc-building-decision-trees-in-r-2" class="nav-link" data-scroll-target="#building-decision-trees-in-r-2">Building Decision Trees in R</a></li>
  <li><a href="#decision-trees-pros-and-cons" id="toc-decision-trees-pros-and-cons" class="nav-link" data-scroll-target="#decision-trees-pros-and-cons">Decision Trees: Pros and Cons</a></li>
  <li><a href="#random-forests" id="toc-random-forests" class="nav-link" data-scroll-target="#random-forests">Random Forests</a>
  <ul class="collapse">
  <li><a href="#random-forests---embrace-the-ensemble" id="toc-random-forests---embrace-the-ensemble" class="nav-link" data-scroll-target="#random-forests---embrace-the-ensemble">Random Forests - Embrace the Ensemble</a></li>
  <li><a href="#random-forest-implementation" id="toc-random-forest-implementation" class="nav-link" data-scroll-target="#random-forest-implementation">Random Forest Implementation</a></li>
  <li><a href="#random-forest-implementation-1" id="toc-random-forest-implementation-1" class="nav-link" data-scroll-target="#random-forest-implementation-1">Random Forest Implementation</a></li>
  <li><a href="#hyperparameter-tuning-with-cross-validation" id="toc-hyperparameter-tuning-with-cross-validation" class="nav-link" data-scroll-target="#hyperparameter-tuning-with-cross-validation">Hyperparameter Tuning with Cross-Validation</a></li>
  <li><a href="#hyperparameter-tuning-with-cross-validation-1" id="toc-hyperparameter-tuning-with-cross-validation-1" class="nav-link" data-scroll-target="#hyperparameter-tuning-with-cross-validation-1">Hyperparameter Tuning with Cross-Validation</a></li>
  <li><a href="#cross-validation-beyond-built-in-oob" id="toc-cross-validation-beyond-built-in-oob" class="nav-link" data-scroll-target="#cross-validation-beyond-built-in-oob">Cross-Validation: Beyond Built-in OOB</a></li>
  <li><a href="#biomedical-case-study-knee-injury-prediction" id="toc-biomedical-case-study-knee-injury-prediction" class="nav-link" data-scroll-target="#biomedical-case-study-knee-injury-prediction">Biomedical Case Study: Knee Injury Prediction</a></li>
  <li><a href="#clinical-interpretation-variable-importance" id="toc-clinical-interpretation-variable-importance" class="nav-link" data-scroll-target="#clinical-interpretation-variable-importance">Clinical Interpretation: Variable Importance</a></li>
  <li><a href="#clinical-interpretation-variable-importance-1" id="toc-clinical-interpretation-variable-importance-1" class="nav-link" data-scroll-target="#clinical-interpretation-variable-importance-1">Clinical Interpretation: Variable Importance</a></li>
  <li><a href="#model-evaluation-roc-curves-and-auc" id="toc-model-evaluation-roc-curves-and-auc" class="nav-link" data-scroll-target="#model-evaluation-roc-curves-and-auc">Model Evaluation: ROC Curves and AUC</a></li>
  <li><a href="#mathematical-foundation" id="toc-mathematical-foundation" class="nav-link" data-scroll-target="#mathematical-foundation">Mathematical Foundation</a></li>
  <li><a href="#auc-interpretation" id="toc-auc-interpretation" class="nav-link" data-scroll-target="#auc-interpretation">AUC interpretation</a></li>
  <li><a href="#calculation-in-r" id="toc-calculation-in-r" class="nav-link" data-scroll-target="#calculation-in-r">Calculation in R</a></li>
  <li><a href="#calculate-roc-curve-points" id="toc-calculate-roc-curve-points" class="nav-link" data-scroll-target="#calculate-roc-curve-points">Calculate ROC Curve Points</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  <li><a href="#when-to-use-each-method" id="toc-when-to-use-each-method" class="nav-link" data-scroll-target="#when-to-use-each-method">When to Use Each Method</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Week10b.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 10b - Statistics for Bioengineering</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bill Cresko </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.2
Type rfNews() to see new features/changes/bug fixes.

Attaching package: 'randomForest'

The following object is masked from 'package:dplyr':

    combine

The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice

Attaching package: 'caret'

The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.

Attaching package: 'pROC'

The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="todays-topics" class="level2">
<h2 class="anchored" data-anchor-id="todays-topics">Today’s Topics</h2>
<ul>
<li>Bias-Variance tradeoff</li>
<li>Decision trees and random forests</li>
<li>Cross-validation strategies</li>
<li>ROC curves and AUC analysis</li>
<li>Bioengineering applications</li>
</ul>
</section>
<section id="bias-variance-tradeoff" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="bias-variance-tradeoff">Bias-Variance Tradeoff</h2>
<p><span class="math display">\[
\text{Expected Test Error} = \text{Bias}^2 + \text{Variance} + \text{Irreducible Error}
\]</span></p>
<ul>
<li><strong>Bias</strong>: Error from overly simple models (underfitting)</li>
<li><strong>Variance</strong>: Error from overly complex models (overfitting)</li>
<li><strong>Goal</strong>: Balance model complexity with generalization</li>
</ul>
<p><img src="images/bias-variance.jpeg" class="img-fluid"></p>
</section>
<section id="strategies-to-address-the-tradeoff" class="level2">
<h2 class="anchored" data-anchor-id="strategies-to-address-the-tradeoff">Strategies to Address the Tradeoff</h2>
<ul>
<li><p><strong>Regularization</strong> (Lasso, Ridge) to constrain model complexity</p></li>
<li><p><strong>Cross-validation</strong> to choose optimal model complexity</p></li>
<li><p><strong>Ensemble methods</strong> (bagging, boosting) to reduce variance</p>
<ul>
<li>This often used with decision tree models</li>
</ul></li>
</ul>
</section>
<section id="decision-trees" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="decision-trees">Decision Trees</h2>
<ul>
<li><p>A <strong>non-parametric</strong> way to build models</p></li>
<li><p><strong>Key Characteristics:</strong></p>
<ul>
<li>Tree-like structure of decision rules</li>
<li>Easy to interpret and visualize</li>
<li>Handle both numerical and categorical data</li>
<li>No distributional assumptions</li>
<li>Capture non-linear relationships naturally</li>
</ul></li>
<li><p><strong>Algorithm:</strong></p>
<ul>
<li>Recursively split data to maximize information gain until stopping criteria are met</li>
</ul></li>
</ul>
</section>
<section id="decision-tree-example" class="level2">
<h2 class="anchored" data-anchor-id="decision-tree-example">Decision tree example</h2>
<p><img src="images/decision_tree_illustration.png" class="img-fluid"></p>
</section>
<section id="introduction-to-impurity-measures" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-impurity-measures">Introduction to Impurity Measures</h2>
<ul>
<li><strong>Decision trees</strong> need to decide which features to split on</li>
<li><strong>Impurity measures</strong> help quantify how “mixed” or “pure” a dataset is</li>
<li>Two main measures: <strong>Gini Index</strong> and <strong>Entropy</strong></li>
<li>Both measure the same concept but with different mathematical approaches</li>
</ul>
</section>
<section id="what-is-impurity" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="what-is-impurity">What is “Impurity”?</h2>
<ul>
<li><strong>Pure Node:</strong>
<ul>
<li>All samples belong to the same class</li>
<li>Easy to make predictions</li>
<li>Low impurity</li>
</ul></li>
<li><strong>Impure Node:</strong>
<ul>
<li>Samples belong to multiple classes</li>
<li>Harder to make predictions</li>
<li>High impurity</li>
</ul></li>
<li>Example: If participants at a node are “injured” → <strong>pure</strong></li>
<li>If 50% injured, 50% not → <strong>impure</strong></li>
</ul>
</section>
<section id="gini-index-definition" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="gini-index-definition">Gini Index: Definition</h2>
<p>The <strong>Gini Index</strong> measures the probability of misclassifying a randomly chosen sample.</p>
<p><span class="math display">\[\text{Gini} = 1 - \sum_{i=1}^{c} p_i^2\]</span></p>
<ul>
<li>Where:
<ul>
<li><span class="math inline">\(c\)</span> = number of classes</li>
<li><span class="math inline">\(p_i\)</span> = probability of class <span class="math inline">\(i\)</span></li>
</ul></li>
<li><strong>Range:</strong> 0 to 0.5 (for binary classification)
<ul>
<li><strong>0</strong> = perfectly pure</li>
<li><strong>0.5</strong> = maximum impurity (50-50 split)</li>
</ul></li>
</ul>
</section>
<section id="gini-index-examples" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="gini-index-examples">Gini Index: Examples</h2>
<ul>
<li><strong>Example 1: Pure Node</strong>
<ul>
<li>100 inuries, 0 not injuries</li>
<li><span class="math inline">\(p_{injury} = 1.0, p_{not} = 0.0\)</span></li>
<li><span class="math inline">\(\text{Gini} = 1 - (1.0^2 + 0.0^2) = 0\)</span></li>
</ul></li>
<li><strong>Example 2: Mixed Node</strong><br>

<ul>
<li>60 injuries, 40 not injuries</li>
<li><span class="math inline">\(p_{injury} = 0.6, p_{not} = 0.4\)</span></li>
<li><span class="math inline">\(\text{Gini} = 1 - (0.6^2 + 0.4^2)\)</span></li>
<li><span class="math inline">\(\text{Gini} = 1 - (0.36 + 0.16) = 0.48\)</span></li>
</ul></li>
</ul>
</section>
<section id="entropy-definition" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="entropy-definition">Entropy: Definition</h2>
<ul>
<li><strong>Entropy</strong> measures the amount of information or surprise in the data.</li>
</ul>
<p><span class="math display">\[\text{Entropy} = -\sum_{i=1}^{c} p_i \log_2(p_i)\]</span></p>
<ul>
<li>Where:
<ul>
<li><span class="math inline">\(c\)</span> = number of classes<br>
</li>
<li><span class="math inline">\(p_i\)</span> = probability of class <span class="math inline">\(i\)</span></li>
</ul></li>
<li><strong>Range:</strong> 0 to <span class="math inline">\(\log_2(c)\)</span>
<ul>
<li><strong>0</strong> = perfectly pure</li>
<li><strong>1</strong> = maximum impurity (for binary classification)</li>
</ul></li>
</ul>
</section>
<section id="entropy-examples" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="entropy-examples">Entropy: Examples</h2>
<ul>
<li><strong>Example 1: Pure Node</strong>
<ul>
<li>100 injuries, 0 not injufies</li>
<li><span class="math inline">\(p_{injury} = 1.0, p_{not} = 0.0\)</span></li>
<li><span class="math inline">\(\text{Entropy} = -1.0 \log_2(1.0) = 0\)</span></li>
</ul></li>
<li><strong>Example 2: Mixed Node</strong>
<ul>
<li>60 injuries, 40 not injuries</li>
<li><span class="math inline">\(p_{injury} = 0.6, p_{not} = 0.4\)</span></li>
<li><span class="math inline">\(\text{Entropy} = -0.6\log_2(0.6) - 0.4\log_2(0.4)\)</span></li>
<li><span class="math inline">\(\text{Entropy} = 0.44 + 0.53 = 0.97\)</span></li>
</ul></li>
</ul>
</section>
<section id="gini-vs-entropy" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="gini-vs-entropy">Gini vs Entropy</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 36%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>Gini Index</th>
<th>Entropy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Computation</strong></td>
<td>Faster</td>
<td>Slower</td>
</tr>
<tr class="even">
<td><strong>Range (binary)</strong></td>
<td>0 to 0.5</td>
<td>0 to 1.0</td>
</tr>
<tr class="odd">
<td><strong>Sensitivity</strong></td>
<td>Less sensitive to changes</td>
<td>More sensitive to changes</td>
</tr>
</tbody>
</table>
<p><strong>In practice:</strong> Both usually give similar results, Gini preferred for speed.</p>
</section>
<section id="information-gain" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="information-gain">Information Gain</h2>
<p>Both measures are used to calculate <strong>Information Gain</strong>:</p>
<p><span class="math display">\[\text{Information Gain} = \text{Impurity}_{parent} - \sum \frac{n_{child}}{n_{parent}} \times \text{Impurity}_{child}\]</span></p>
<ul>
<li>Decision trees choose splits that <strong>maximize information gain</strong></li>
<li>Higher gain = better split = more homogeneous child nodes</li>
</ul>
</section>
<section id="practical-example" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="practical-example">Practical Example</h2>
<ul>
<li><p>Dataset: 100 patients (60 injured, 40 not injured)</p></li>
<li><p><strong>Before split:</strong></p>
<ul>
<li>Gini = <span class="math inline">\(1 - (0.6^2 + 0.4^2) = 0.48\)</span></li>
<li>Entropy = <span class="math inline">\(-0.6\log_2(0.6) - 0.4\log_2(0.4) = 0.97\)</span></li>
</ul></li>
<li><p><strong>After split on “BMI”:</strong></p>
<ul>
<li>Left: 50 patients (45 injured, 5 not injured)</li>
<li>Right: 50 patients (15 injured, 35 not injured)</li>
</ul></li>
<li><p>Calculate weighted average impurity to find information gain!</p></li>
<li><p>Do this again and again on different variables (features) to see which one provides the biggest gain</p></li>
</ul>
</section>
<section id="calculations-after-split" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="calculations-after-split">Calculations After Split</h2>
<ul>
<li>Left Node (50 patients: 45 injured, 5 not injured)
<ul>
<li>Proportions: <span class="math inline">\(p_{injured} = 45/50 = 0.9\)</span>, <span class="math inline">\(p_{not\_injured} = 5/50 = 0.1\)</span></li>
<li><strong>Gini Left:</strong> <span class="math inline">\(1 - (0.9^2 + 0.1^2) = 0.18\)</span></li>
<li><strong>Entropy Left:</strong> <span class="math inline">\(-0.9\log_2(0.9) - 0.1\log_2(0.1) = 0.469\)</span></li>
</ul></li>
<li>Right Node (50 patients: 15 injured, 35 not injured)
<ul>
<li>Proportions: <span class="math inline">\(p_{injured} = 15/50 = 0.3\)</span>, <span class="math inline">\(p_{not\_injured} = 35/50 = 0.7\)</span></li>
<li><strong>Gini Right:</strong> <span class="math inline">\(1 - (0.3^2 + 0.7^2) = 0.42\)</span></li>
<li><strong>Entropy Right:</strong> <span class="math inline">\(-0.3\log_2(0.3) - 0.7\log_2(0.7) = 0.882\)</span></li>
</ul></li>
</ul>
</section>
<section id="calculations-after-split-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="calculations-after-split-1">Calculations After Split</h2>
<ul>
<li>Weighted Average Impurity After Split
<ul>
<li><strong>Weighted Gini:</strong> <span class="math inline">\(\frac{50}{100} \times 0.18 + \frac{50}{100} \times 0.42 = 0.09 + 0.21 = 0.30\)</span></li>
<li><strong>Weighted Entropy:</strong> <span class="math inline">\(\frac{50}{100} \times 0.469 + \frac{50}{100} \times 0.882 = 0.235 + 0.441 = 0.676\)</span></li>
</ul></li>
<li>Information Gain
<ul>
<li><strong>Gini Information Gain:</strong> <span class="math inline">\(0.48 - 0.30 = 0.18\)</span></li>
<li><strong>Entropy Information Gain:</strong> <span class="math inline">\(0.97 - 0.676 = 0.294\)</span></li>
</ul></li>
</ul>
</section>
<section id="building-decision-trees-in-r" class="level2">
<h2 class="anchored" data-anchor-id="building-decision-trees-in-r">Building Decision Trees in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(iris<span class="sc">$</span>Species, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> iris[train_index, ]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> iris[<span class="sc">-</span>train_index, ]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Build and visualize tree</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>tree_model <span class="ot">&lt;-</span> <span class="fu">rpart</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">method =</span> <span class="st">"class"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_model, <span class="at">type =</span> <span class="dv">4</span>, <span class="at">extra =</span> <span class="dv">102</span>, <span class="at">main =</span> <span class="st">"Iris Classification Tree"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate performance</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree_model, test_data, <span class="at">type =</span> <span class="st">"class"</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions, test_data<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="building-decision-trees-in-r-1" class="level2">
<h2 class="anchored" data-anchor-id="building-decision-trees-in-r-1">Building Decision Trees in R</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week10b_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="building-decision-trees-in-r-2" class="level2">
<h2 class="anchored" data-anchor-id="building-decision-trees-in-r-2">Building Decision Trees in R</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         15          0         0
  versicolor      0         14         2
  virginica       0          1        13

Overall Statistics
                                         
               Accuracy : 0.9333         
                 95% CI : (0.8173, 0.986)
    No Information Rate : 0.3333         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.9            
                                         
 Mcnemar's Test P-Value : NA             

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                 1.0000            0.9333           0.8667
Specificity                 1.0000            0.9333           0.9667
Pos Pred Value              1.0000            0.8750           0.9286
Neg Pred Value              1.0000            0.9655           0.9355
Prevalence                  0.3333            0.3333           0.3333
Detection Rate              0.3333            0.3111           0.2889
Detection Prevalence        0.3333            0.3556           0.3111
Balanced Accuracy           1.0000            0.9333           0.9167</code></pre>
</div>
</div>
</section>
<section id="decision-trees-pros-and-cons" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="decision-trees-pros-and-cons">Decision Trees: Pros and Cons</h2>
<ul>
<li><strong>Advantages:</strong>
<ul>
<li>Highly interpretable</li>
<li>No preprocessing required</li>
<li>Automatic feature selection</li>
<li>Handles interactions naturally</li>
</ul></li>
<li><strong>Limitations:</strong>
<ul>
<li>Prone to overfitting</li>
<li>High variance (unstable)</li>
<li>Bias toward features with more levels</li>
<li>Limited expressiveness for linear relationships</li>
</ul></li>
<li><strong>Solution:</strong> Use ensemble methods like Random Forests!</li>
</ul>
</section>
<section id="random-forests" class="level1">
<h1>Random Forests</h1>
<section id="random-forests---embrace-the-ensemble" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="random-forests---embrace-the-ensemble">Random Forests - Embrace the Ensemble</h2>
<p><strong>Key Innovation:</strong> Combine multiple decision trees through:</p>
<ol type="1">
<li><strong>Bootstrap sampling</strong> (bagging) for training data</li>
<li><strong>Random feature selection</strong> at each split</li>
<li><strong>Aggregate predictions</strong> (voting/averaging)</li>
<li><strong>Out-of-bag validation</strong> for built-in cross-validation</li>
</ol>
<p><strong>Result:</strong> Reduced overfitting, improved accuracy, maintained interpretability through variable importance</p>
</section>
<section id="random-forest-implementation" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="random-forest-implementation">Random Forest Implementation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  Species <span class="sc">~</span> ., </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train_data,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntree =</span> <span class="dv">500</span>,           <span class="co"># Number of trees</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="dv">2</span>,              <span class="co"># Features per split (√p for classification)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="cn">TRUE</span>      <span class="co"># Calculate variable importance</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rf_model)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rf_model, <span class="at">main =</span> <span class="st">"Random Forest Error Rates"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable importance</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(rf_model, <span class="at">main =</span> <span class="st">"Variable Importance"</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(rf_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-forest-implementation-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="random-forest-implementation-1">Random Forest Implementation</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = Species ~ ., data = train_data, ntree = 500,      mtry = 2, importance = TRUE) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 2

        OOB estimate of  error rate: 4.76%
Confusion matrix:
           setosa versicolor virginica class.error
setosa         35          0         0  0.00000000
versicolor      0         33         2  0.05714286
virginica       0          3        32  0.08571429</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week10b_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week10b_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                setosa versicolor virginica MeanDecreaseAccuracy
Sepal.Length  7.147216   9.184321  8.580944            11.835818
Sepal.Width   4.447419   2.125054  5.530193             6.303784
Petal.Length 21.678714  28.332242 26.876953            32.361134
Petal.Width  22.023943  28.785681 31.409603            32.888441
             MeanDecreaseGini
Sepal.Length         8.202889
Sepal.Width          1.463770
Petal.Length        28.830718
Petal.Width         30.736584</code></pre>
</div>
</div>
</section>
<section id="hyperparameter-tuning-with-cross-validation" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="hyperparameter-tuning-with-cross-validation">Hyperparameter Tuning with Cross-Validation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define parameter grid</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>rf_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mtry =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation setup</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">number =</span> <span class="dv">5</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">savePredictions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">classProbs =</span> <span class="cn">TRUE</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Train with tuning</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>rf_tuned <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  Species <span class="sc">~</span> .,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train_data,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneGrid =</span> rf_grid,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> ctrl,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntree =</span> <span class="dv">300</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rf_tuned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hyperparameter-tuning-with-cross-validation-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="hyperparameter-tuning-with-cross-validation-1">Hyperparameter Tuning with Cross-Validation</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week10b_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cross-validation-beyond-built-in-oob" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation-beyond-built-in-oob">Cross-Validation: Beyond Built-in OOB</h2>
<ul>
<li><strong>Why Cross-Validation for Random Forests?</strong>
<ul>
<li>More reliable performance estimates</li>
<li>Fair comparison with other algorithms</li>
<li>Hyperparameter optimization</li>
<li>Nested CV for unbiased evaluation</li>
</ul></li>
<li><strong>Methods:</strong>
<ul>
<li><strong>K-fold CV</strong>: Split into k folds, train on k-1, test on 1</li>
<li><strong>Stratified CV</strong>: Maintains class proportions</li>
<li><strong>Repeated CV</strong>: Multiple rounds for stability</li>
</ul></li>
</ul>
</section>
<section id="biomedical-case-study-knee-injury-prediction" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="biomedical-case-study-knee-injury-prediction">Biomedical Case Study: Knee Injury Prediction</h2>
<p><strong>Context:</strong> Early identification of injury risk factors</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and prepare data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/knee_injury.csv"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>knee_injury <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>knee_injury)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest with CV</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"cv"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">classProbs =</span> <span class="cn">FALSE</span>,  <span class="co"># Set to FALSE</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">summaryFunction =</span> defaultSummary  <span class="co"># Use default instead of twoClassSummary</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>rf_knee <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  knee_injury <span class="sc">~</span> .,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> train_control,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="st">"Accuracy"</span>,  <span class="co"># Change metric since no ROC without probabilities</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">importance =</span> <span class="cn">TRUE</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="clinical-interpretation-variable-importance" class="level2">
<h2 class="anchored" data-anchor-id="clinical-interpretation-variable-importance">Clinical Interpretation: Variable Importance</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and visualize importance</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>importance_scores <span class="ot">&lt;-</span> <span class="fu">varImp</span>(rf_knee)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(importance_scores, <span class="at">main =</span> <span class="st">"Risk Factors for Knee Injury"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="clinical-interpretation-variable-importance-1" class="level2">
<h2 class="anchored" data-anchor-id="clinical-interpretation-variable-importance-1">Clinical Interpretation: Variable Importance</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week10b_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-evaluation-roc-curves-and-auc" class="level2">
<h2 class="anchored" data-anchor-id="model-evaluation-roc-curves-and-auc">Model Evaluation: ROC Curves and AUC</h2>
<ul>
<li><p><strong>ROC Curve:</strong> Plots True Positive Rate vs False Positive Rate across all classification thresholds</p></li>
<li><p><strong>Key Metrics:</strong></p>
<ul>
<li><strong>Sensitivity (TPR)</strong>: <span class="math inline">\(\frac{TP}{TP + FN}\)</span> - How well we catch positive cases</li>
<li><strong>Specificity (TNR)</strong>: <span class="math inline">\(\frac{TN}{TN + FP}\)</span> - How well we avoid false alarms</li>
<li><strong>AUC</strong>: Area under ROC curve - Overall discriminative ability</li>
<li><strong>AUC Range</strong>: 0 to 1 (higher is better)</li>
</ul></li>
</ul>
</section>
<section id="mathematical-foundation" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-foundation">Mathematical Foundation</h2>
<p>For discrete points <span class="math inline">\((x_i, y_i)\)</span> on the ROC curve:</p>
<p><span class="math display">\[AUC = \sum_{i=1}^{n-1} \frac{1}{2}(x_{i+1} - x_i)(y_i + y_{i+1})\]</span></p>
<ul>
<li>Where:
<ul>
<li><span class="math inline">\(x_i\)</span> = FPR at threshold <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(y_i\)</span> = TPR at threshold <span class="math inline">\(i\)</span></li>
<li>Points are sorted by increasing FPR</li>
</ul></li>
</ul>
</section>
<section id="auc-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="auc-interpretation">AUC interpretation</h2>
<ul>
<li>AUC = 0.5: Random guessing</li>
<li>AUC = 0.7-0.8: Acceptable</li>
<li>AUC = 0.8-0.9: Excellent</li>
<li>AUC &gt; 0.9: Outstanding (check for overfitting)</li>
</ul>
</section>
<section id="calculation-in-r" class="level2">
<h2 class="anchored" data-anchor-id="calculation-in-r">Calculation in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create binary outcome with some relationship to predictors</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fu">plogis</span>(<span class="fl">0.5</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>)))</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>train_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="fl">0.7</span> <span class="sc">*</span> n)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x1[train_idx], <span class="at">x2 =</span> x2[train_idx], <span class="at">y =</span> y[train_idx])</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> x1[<span class="sc">-</span>train_idx], <span class="at">x2 =</span> x2[<span class="sc">-</span>train_idx], <span class="at">y =</span> y[<span class="sc">-</span>train_idx])</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit logistic regression</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> train_data, <span class="at">family =</span> binomial)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predicted probabilities</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>pred_probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, test_data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> test_data<span class="sc">$</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="calculate-roc-curve-points" class="level2">
<h2 class="anchored" data-anchor-id="calculate-roc-curve-points">Calculate ROC Curve Points</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using ROCR package</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>pred_obj <span class="ot">&lt;-</span> <span class="fu">prediction</span>(pred_probs, actual)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>perf_obj <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract TPR and FPR</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>fpr <span class="ot">&lt;-</span> perf_obj<span class="sc">@</span>x.values[[<span class="dv">1</span>]]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>tpr <span class="ot">&lt;-</span> perf_obj<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>thresholds <span class="ot">&lt;-</span> perf_obj<span class="sc">@</span>alpha.values[[<span class="dv">1</span>]]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate AUC using ROCR</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>auc_rocr <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_obj, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative using pROC package</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(actual, pred_probs, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>auc_proc <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
<div class="cell" data-output-location="slide">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comprehensive visualization</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:randomForest':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC Curve plot</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>roc_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">FPR =</span> fpr, <span class="at">TPR =</span> tpr)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(roc_data, <span class="fu">aes</span>(<span class="at">x =</span> FPR, <span class="at">y =</span> TPR)) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> TPR), <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"darkorange"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"ROC Curve (AUC ="</span>, <span class="fu">round</span>(auc_rocr, <span class="dv">4</span>), <span class="st">")"</span>),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"False Positive Rate"</span>, <span class="at">y =</span> <span class="st">"True Positive Rate"</span>) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of predicted probabilities</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>prob_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Probability =</span> pred_probs,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual =</span> <span class="fu">factor</span>(actual, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Negative"</span>, <span class="st">"Positive"</span>))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prob_data, <span class="fu">aes</span>(<span class="at">x =</span> Probability, <span class="at">fill =</span> Actual)) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Predicted Probabilities"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Probability"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week10b_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="when-to-use-each-method" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="when-to-use-each-method">When to Use Each Method</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Best For</th>
<th>Limitations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Logistic Regression</strong></td>
<td>Linear relationships, inference needs, regulatory requirements</td>
<td>Assumes linearity, manual interaction terms</td>
</tr>
<tr class="even">
<td><strong>Decision Trees</strong></td>
<td>High interpretability needs, small datasets, understanding interactions</td>
<td>Overfitting, instability</td>
</tr>
<tr class="odd">
<td><strong>Random Forest</strong></td>
<td>Prediction accuracy, complex patterns, robust performance</td>
<td>Less interpretable, computational cost</td>
</tr>
</tbody>
</table>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<p><img src="images/week_01.002.jpeg" class="img-fluid"></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>