<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bill Cresko">

<title>Week 2b - Statistics for Bioengineering – BioEngineering Statistics Spring 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">BioEngineering Statistics Spring 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Policies.html"> 
<span class="menu-text">Policies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Lectures.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#today-we-will" id="toc-today-we-will" class="nav-link active" data-scroll-target="#today-we-will">Today we will</a></li>
  <li><a href="#markdown-and-latex" id="toc-markdown-and-latex" class="nav-link" data-scroll-target="#markdown-and-latex">Markdown and LaTeX</a>
  <ul class="collapse">
  <li><a href="#what-is-markdown" id="toc-what-is-markdown" class="nav-link" data-scroll-target="#what-is-markdown">What is markdown?</a></li>
  <li><a href="#formatting-text" id="toc-formatting-text" class="nav-link" data-scroll-target="#formatting-text">Formatting text</a></li>
  <li><a href="#formatting-text-1" id="toc-formatting-text-1" class="nav-link" data-scroll-target="#formatting-text-1">Formatting text</a></li>
  <li><a href="#formatting-lists" id="toc-formatting-lists" class="nav-link" data-scroll-target="#formatting-lists">Formatting lists</a></li>
  <li><a href="#formatting-lists-1" id="toc-formatting-lists-1" class="nav-link" data-scroll-target="#formatting-lists-1">Formatting lists</a></li>
  <li><a href="#inserting-images-or-urls" id="toc-inserting-images-or-urls" class="nav-link" data-scroll-target="#inserting-images-or-urls">Inserting images or URLs</a></li>
  <li><a href="#including-code-chunks" id="toc-including-code-chunks" class="nav-link" data-scroll-target="#including-code-chunks">Including code chunks</a></li>
  <li><a href="#what-is-latex" id="toc-what-is-latex" class="nav-link" data-scroll-target="#what-is-latex">What is LaTeX?</a></li>
  <li><a href="#operators-and-symbols" id="toc-operators-and-symbols" class="nav-link" data-scroll-target="#operators-and-symbols">Operators and Symbols</a></li>
  <li><a href="#operators-and-symbols-1" id="toc-operators-and-symbols-1" class="nav-link" data-scroll-target="#operators-and-symbols-1">Operators and Symbols</a></li>
  <li><a href="#equations" id="toc-equations" class="nav-link" data-scroll-target="#equations">Equations</a></li>
  <li><a href="#differential-equations" id="toc-differential-equations" class="nav-link" data-scroll-target="#differential-equations">Differential Equations</a></li>
  <li><a href="#matrix-formulations" id="toc-matrix-formulations" class="nav-link" data-scroll-target="#matrix-formulations">Matrix formulations</a></li>
  <li><a href="#in-line-versus-fenced" id="toc-in-line-versus-fenced" class="nav-link" data-scroll-target="#in-line-versus-fenced">In-line versus fenced</a></li>
  <li><a href="#markdown-is-very-flexible" id="toc-markdown-is-very-flexible" class="nav-link" data-scroll-target="#markdown-is-very-flexible">Markdown is very flexible</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-with-ggplot2" id="toc-exploratory-data-analysis-with-ggplot2" class="nav-link" data-scroll-target="#exploratory-data-analysis-with-ggplot2">Exploratory Data Analysis with ggplot2</a>
  <ul class="collapse">
  <li><a href="#reading-in-and-exporting-data-frames" id="toc-reading-in-and-exporting-data-frames" class="nav-link" data-scroll-target="#reading-in-and-exporting-data-frames">Reading in and Exporting Data Frames</a></li>
  <li><a href="#indexing-in-data-frames" id="toc-indexing-in-data-frames" class="nav-link" data-scroll-target="#indexing-in-data-frames">Indexing in data frames</a></li>
  <li><a href="#types-of-vectors-of-data" id="toc-types-of-vectors-of-data" class="nav-link" data-scroll-target="#types-of-vectors-of-data">Types of vectors of data</a></li>
  <li><a href="#types-of-vectors-of-data-1" id="toc-types-of-vectors-of-data-1" class="nav-link" data-scroll-target="#types-of-vectors-of-data-1">Types of vectors of data</a></li>
  </ul></li>
  <li><a href="#ggplot2" id="toc-ggplot2" class="nav-link" data-scroll-target="#ggplot2">ggplot2</a>
  <ul class="collapse">
  <li><a href="#plotting-using-ggplot2" id="toc-plotting-using-ggplot2" class="nav-link" data-scroll-target="#plotting-using-ggplot2">Plotting using <code>ggplot2()</code></a></li>
  <li><a href="#ggplot2-and-the-grammar-of-graphics" id="toc-ggplot2-and-the-grammar-of-graphics" class="nav-link" data-scroll-target="#ggplot2-and-the-grammar-of-graphics">GGPlot2 and the Grammar of Graphics</a></li>
  <li><a href="#ggplot2-and-the-grammar-of-graphics-1" id="toc-ggplot2-and-the-grammar-of-graphics-1" class="nav-link" data-scroll-target="#ggplot2-and-the-grammar-of-graphics-1">GGPlot2 and the Grammar of Graphics</a></li>
  <li><a href="#plotting-using-ggplot" id="toc-plotting-using-ggplot" class="nav-link" data-scroll-target="#plotting-using-ggplot">Plotting using <code>ggplot()</code></a></li>
  <li><a href="#scatterplots-with-ggplot" id="toc-scatterplots-with-ggplot" class="nav-link" data-scroll-target="#scatterplots-with-ggplot">Scatterplots with <code>ggplot</code></a></li>
  <li><a href="#boxplots-in-ggplot" id="toc-boxplots-in-ggplot" class="nav-link" data-scroll-target="#boxplots-in-ggplot">Boxplots in <code>ggplot</code></a></li>
  <li><a href="#the-geom_bar-function" id="toc-the-geom_bar-function" class="nav-link" data-scroll-target="#the-geom_bar-function">The <code>geom_bar</code> function</a></li>
  <li><a href="#the-geom_histogram-and-geom_freqpolyfunction" id="toc-the-geom_histogram-and-geom_freqpolyfunction" class="nav-link" data-scroll-target="#the-geom_histogram-and-geom_freqpolyfunction">The <code>geom_histogram</code> and <code>geom_freqpoly</code>function</a></li>
  <li><a href="#the-geom_boxplot-function" id="toc-the-geom_boxplot-function" class="nav-link" data-scroll-target="#the-geom_boxplot-function">The <code>geom_boxplot</code> function</a></li>
  <li><a href="#the-geom_point-geom_smooth-functions" id="toc-the-geom_point-geom_smooth-functions" class="nav-link" data-scroll-target="#the-geom_point-geom_smooth-functions">The <code>geom_point</code> &amp; <code>geom_smooth</code> functions</a></li>
  <li><a href="#combining-geoms" id="toc-combining-geoms" class="nav-link" data-scroll-target="#combining-geoms">Combining geoms</a></li>
  <li><a href="#adding-labels" id="toc-adding-labels" class="nav-link" data-scroll-target="#adding-labels">Adding labels</a></li>
  <li><a href="#what-type-of-plot-do-i-use-for-each-data-type" id="toc-what-type-of-plot-do-i-use-for-each-data-type" class="nav-link" data-scroll-target="#what-type-of-plot-do-i-use-for-each-data-type">What type of plot do I use for each data type?</a></li>
  </ul></li>
  <li><a href="#randomness-in-statistics" id="toc-randomness-in-statistics" class="nav-link" data-scroll-target="#randomness-in-statistics">Randomness in Statistics</a></li>
  <li><a href="#probability-and-distributions" id="toc-probability-and-distributions" class="nav-link" data-scroll-target="#probability-and-distributions">Probability and distributions</a>
  <ul class="collapse">
  <li><a href="#different-flavors-of-inferential-statistics" id="toc-different-flavors-of-inferential-statistics" class="nav-link" data-scroll-target="#different-flavors-of-inferential-statistics">Different flavors of inferential statistics</a></li>
  <li><a href="#what-is-probability" id="toc-what-is-probability" class="nav-link" data-scroll-target="#what-is-probability">What is probability</a></li>
  <li><a href="#random-variables-probability" id="toc-random-variables-probability" class="nav-link" data-scroll-target="#random-variables-probability">Random variables &amp; probability</a></li>
  <li><a href="#random-variables-probability-1" id="toc-random-variables-probability-1" class="nav-link" data-scroll-target="#random-variables-probability-1">Random variables &amp; probability</a></li>
  <li><a href="#bernoulli-distribution" id="toc-bernoulli-distribution" class="nav-link" data-scroll-target="#bernoulli-distribution">Bernoulli distribution</a></li>
  <li><a href="#bernoulli-distribution-1" id="toc-bernoulli-distribution-1" class="nav-link" data-scroll-target="#bernoulli-distribution-1">Bernoulli distribution</a></li>
  <li><a href="#probability-rules" id="toc-probability-rules" class="nav-link" data-scroll-target="#probability-rules">Probability rules</a></li>
  <li><a href="#probability-rules-1" id="toc-probability-rules-1" class="nav-link" data-scroll-target="#probability-rules-1">Probability rules</a></li>
  <li><a href="#lets-simulate-some-coin-flips" id="toc-lets-simulate-some-coin-flips" class="nav-link" data-scroll-target="#lets-simulate-some-coin-flips">Let’s simulate some coin flips</a></li>
  <li><a href="#lets-simulate-some-coin-flips-1" id="toc-lets-simulate-some-coin-flips-1" class="nav-link" data-scroll-target="#lets-simulate-some-coin-flips-1">Let’s simulate some coin flips</a></li>
  <li><a href="#expectation-and-moments-of-distributions" id="toc-expectation-and-moments-of-distributions" class="nav-link" data-scroll-target="#expectation-and-moments-of-distributions">Expectation and Moments of Distributions</a></li>
  <li><a href="#joint-probability" id="toc-joint-probability" class="nav-link" data-scroll-target="#joint-probability">Joint probability</a></li>
  <li><a href="#conditional-probability" id="toc-conditional-probability" class="nav-link" data-scroll-target="#conditional-probability">Conditional probability</a></li>
  <li><a href="#what-is-likelihood-vs.-probability" id="toc-what-is-likelihood-vs.-probability" class="nav-link" data-scroll-target="#what-is-likelihood-vs.-probability">What is Likelihood vs.&nbsp;Probability?</a></li>
  <li><a href="#extra-bayesian-material" id="toc-extra-bayesian-material" class="nav-link" data-scroll-target="#extra-bayesian-material">Extra Bayesian material</a></li>
  <li><a href="#who-wants-to-win-a-car" id="toc-who-wants-to-win-a-car" class="nav-link" data-scroll-target="#who-wants-to-win-a-car">Who wants to win a car?</a></li>
  </ul></li>
  <li><a href="#common-probability-distributions" id="toc-common-probability-distributions" class="nav-link" data-scroll-target="#common-probability-distributions">Common probability distributions</a>
  <ul class="collapse">
  <li><a href="#geometric-distribution" id="toc-geometric-distribution" class="nav-link" data-scroll-target="#geometric-distribution"><strong>Geometric Distribution</strong></a></li>
  <li><a href="#geometric-distribution-1" id="toc-geometric-distribution-1" class="nav-link" data-scroll-target="#geometric-distribution-1"><strong>Geometric Distribution</strong></a></li>
  <li><a href="#geometric-distribution-2" id="toc-geometric-distribution-2" class="nav-link" data-scroll-target="#geometric-distribution-2"><strong>Geometric Distribution</strong></a></li>
  <li><a href="#testing-geometric-distributions" id="toc-testing-geometric-distributions" class="nav-link" data-scroll-target="#testing-geometric-distributions">Testing Geometric Distributions</a></li>
  <li><a href="#testing-geometric-distributions-1" id="toc-testing-geometric-distributions-1" class="nav-link" data-scroll-target="#testing-geometric-distributions-1">Testing Geometric Distributions</a></li>
  <li><a href="#binomial-distribution" id="toc-binomial-distribution" class="nav-link" data-scroll-target="#binomial-distribution"><strong>Binomial Distribution</strong></a></li>
  <li><a href="#binomial-distribution-1" id="toc-binomial-distribution-1" class="nav-link" data-scroll-target="#binomial-distribution-1">Binomial Distribution</a></li>
  <li><a href="#binomial-probability-distribution" id="toc-binomial-probability-distribution" class="nav-link" data-scroll-target="#binomial-probability-distribution">Binomial Probability Distribution</a></li>
  <li><a href="#testing-binomial-distributions" id="toc-testing-binomial-distributions" class="nav-link" data-scroll-target="#testing-binomial-distributions">Testing Binomial Distributions</a></li>
  <li><a href="#testing-binomial-distributions-1" id="toc-testing-binomial-distributions-1" class="nav-link" data-scroll-target="#testing-binomial-distributions-1">Testing Binomial Distributions</a></li>
  <li><a href="#negative-binomial-distribution" id="toc-negative-binomial-distribution" class="nav-link" data-scroll-target="#negative-binomial-distribution"><strong>Negative Binomial Distribution</strong></a></li>
  <li><a href="#negative-binomial-distribution-1" id="toc-negative-binomial-distribution-1" class="nav-link" data-scroll-target="#negative-binomial-distribution-1"><strong>Negative Binomial Distribution</strong></a></li>
  <li><a href="#poisson-probability-distribution" id="toc-poisson-probability-distribution" class="nav-link" data-scroll-target="#poisson-probability-distribution"><strong>Poisson Probability Distribution</strong></a></li>
  <li><a href="#poisson-probability-distribution-1" id="toc-poisson-probability-distribution-1" class="nav-link" data-scroll-target="#poisson-probability-distribution-1">Poisson Probability Distribution</a></li>
  <li><a href="#poisson-probability-distribution-2" id="toc-poisson-probability-distribution-2" class="nav-link" data-scroll-target="#poisson-probability-distribution-2">Poisson Probability Distribution</a></li>
  <li><a href="#poisson-probability-distribution-gene-length-by-bins-of-500-nucleotides" id="toc-poisson-probability-distribution-gene-length-by-bins-of-500-nucleotides" class="nav-link" data-scroll-target="#poisson-probability-distribution-gene-length-by-bins-of-500-nucleotides">Poisson Probability Distribution | gene length by bins of 500 nucleotides</a></li>
  <li><a href="#poisson-probability-distribution-increasing-parameter-values-of-lambda" id="toc-poisson-probability-distribution-increasing-parameter-values-of-lambda" class="nav-link" data-scroll-target="#poisson-probability-distribution-increasing-parameter-values-of-lambda">Poisson Probability Distribution | increasing parameter values of <span class="math inline">\(\lambda\)</span></a></li>
  <li><a href="#testing-poisson-distributions" id="toc-testing-poisson-distributions" class="nav-link" data-scroll-target="#testing-poisson-distributions">Testing Poisson Distributions</a></li>
  <li><a href="#uniform-distribution" id="toc-uniform-distribution" class="nav-link" data-scroll-target="#uniform-distribution"><strong>Uniform Distribution</strong></a></li>
  <li><a href="#uniform-distribution-1" id="toc-uniform-distribution-1" class="nav-link" data-scroll-target="#uniform-distribution-1">Uniform Distribution</a></li>
  <li><a href="#exponential-distribution" id="toc-exponential-distribution" class="nav-link" data-scroll-target="#exponential-distribution">Exponential Distribution</a></li>
  <li><a href="#exponential-distribution-1" id="toc-exponential-distribution-1" class="nav-link" data-scroll-target="#exponential-distribution-1">Exponential Distribution</a></li>
  <li><a href="#gamma-distribution" id="toc-gamma-distribution" class="nav-link" data-scroll-target="#gamma-distribution"><strong>Gamma Distribution</strong></a></li>
  <li><a href="#gamma-distribution-1" id="toc-gamma-distribution-1" class="nav-link" data-scroll-target="#gamma-distribution-1">Gamma Distribution</a></li>
  <li><a href="#the-gaussian-or-normal-distribution" id="toc-the-gaussian-or-normal-distribution" class="nav-link" data-scroll-target="#the-gaussian-or-normal-distribution">The Gaussian or Normal Distribution</a></li>
  <li><a href="#log-normal-pdf-continuous-version-of-poisson--ish" id="toc-log-normal-pdf-continuous-version-of-poisson--ish" class="nav-link" data-scroll-target="#log-normal-pdf-continuous-version-of-poisson--ish">Log-normal PDF | Continuous version of Poisson (-ish)</a></li>
  <li><a href="#transformations-to-normalize-data" id="toc-transformations-to-normalize-data" class="nav-link" data-scroll-target="#transformations-to-normalize-data">Transformations to ‘normalize’ data</a></li>
  <li><a href="#transformations-to-normalize-data-1" id="toc-transformations-to-normalize-data-1" class="nav-link" data-scroll-target="#transformations-to-normalize-data-1">Transformations to ‘normalize’ data</a></li>
  <li><a href="#binomial-to-normal-categorical-to-continuous" id="toc-binomial-to-normal-categorical-to-continuous" class="nav-link" data-scroll-target="#binomial-to-normal-categorical-to-continuous">Binomial to Normal | Categorical to continuous</a></li>
  <li><a href="#the-normal-aka-gaussian-probability-density-function-pdf" id="toc-the-normal-aka-gaussian-probability-density-function-pdf" class="nav-link" data-scroll-target="#the-normal-aka-gaussian-probability-density-function-pdf">The Normal (aka Gaussian) | Probability Density Function (PDF)</a></li>
  <li><a href="#normal-pdf" id="toc-normal-pdf" class="nav-link" data-scroll-target="#normal-pdf">Normal PDF</a></li>
  <li><a href="#normal-pdf-a-function-of-two-parameters" id="toc-normal-pdf-a-function-of-two-parameters" class="nav-link" data-scroll-target="#normal-pdf-a-function-of-two-parameters">Normal PDF | A function of two parameters</a>
  <ul class="collapse">
  <li><a href="#mu-and-sigma" id="toc-mu-and-sigma" class="nav-link" data-scroll-target="#mu-and-sigma">(<span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>)</a></li>
  </ul></li>
  <li><a href="#normal-pdf-estimates-of-mean-and-variance" id="toc-normal-pdf-estimates-of-mean-and-variance" class="nav-link" data-scroll-target="#normal-pdf-estimates-of-mean-and-variance">Normal PDF | estimates of mean and variance</a></li>
  <li><a href="#normal-pdf-1" id="toc-normal-pdf-1" class="nav-link" data-scroll-target="#normal-pdf-1">Normal PDF</a></li>
  <li><a href="#why-is-the-normal-special-in-biology" id="toc-why-is-the-normal-special-in-biology" class="nav-link" data-scroll-target="#why-is-the-normal-special-in-biology">Why is the Normal special in biology?</a></li>
  <li><a href="#why-is-the-normal-special-in-biology-1" id="toc-why-is-the-normal-special-in-biology-1" class="nav-link" data-scroll-target="#why-is-the-normal-special-in-biology-1">Why is the Normal special in biology?</a></li>
  <li><a href="#why-is-the-normal-special-in-biology-2" id="toc-why-is-the-normal-special-in-biology-2" class="nav-link" data-scroll-target="#why-is-the-normal-special-in-biology-2">Why is the Normal special in biology?</a></li>
  <li><a href="#parent-offspring-resemblance" id="toc-parent-offspring-resemblance" class="nav-link" data-scroll-target="#parent-offspring-resemblance">Parent-offspring resemblance</a></li>
  <li><a href="#genetic-model-of-complex-traits" id="toc-genetic-model-of-complex-traits" class="nav-link" data-scroll-target="#genetic-model-of-complex-traits">Genetic model of complex traits</a></li>
  <li><a href="#distribution-of-f_2-genotypes-really-just-binomial-sampling" id="toc-distribution-of-f_2-genotypes-really-just-binomial-sampling" class="nav-link" data-scroll-target="#distribution-of-f_2-genotypes-really-just-binomial-sampling">Distribution of <span class="math inline">\(F_2\)</span> genotypes | really just binomial sampling</a></li>
  <li><a href="#why-else-is-the-normal-special" id="toc-why-else-is-the-normal-special" class="nav-link" data-scroll-target="#why-else-is-the-normal-special">Why else is the Normal special?</a></li>
  <li><a href="#z-scores-of-normal-variables" id="toc-z-scores-of-normal-variables" class="nav-link" data-scroll-target="#z-scores-of-normal-variables">z-scores of normal variables</a></li>
  <li><a href="#z-scores-of-normal-variables-1" id="toc-z-scores-of-normal-variables-1" class="nav-link" data-scroll-target="#z-scores-of-normal-variables-1">z-scores of normal variables</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling?</a>
  <ul class="collapse">
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">Resources:</a></li>
  <li><a href="#r-packages-youll-need-today" id="toc-r-packages-youll-need-today" class="nav-link" data-scroll-target="#r-packages-youll-need-today">R packages you’ll need today</a></li>
  <li><a href="#tidyverse-vs.-base-r-cont." id="toc-tidyverse-vs.-base-r-cont." class="nav-link" data-scroll-target="#tidyverse-vs.-base-r-cont.">Tidyverse vs.&nbsp;base R (cont.)</a></li>
  <li><a href="#tidyverse-packages" id="toc-tidyverse-packages" class="nav-link" data-scroll-target="#tidyverse-packages">Tidyverse packages</a></li>
  <li><a href="#tidyverse-packages-cont." id="toc-tidyverse-packages-cont." class="nav-link" data-scroll-target="#tidyverse-packages-cont.">Tidyverse packages (cont.)</a></li>
  <li><a href="#tidyverse-packages-cont.-1" id="toc-tidyverse-packages-cont.-1" class="nav-link" data-scroll-target="#tidyverse-packages-cont.-1">Tidyverse packages (cont.)</a></li>
  <li><a href="#an-aside-on-pipes" id="toc-an-aside-on-pipes" class="nav-link" data-scroll-target="#an-aside-on-pipes">An aside on pipes: %&gt;%</a></li>
  <li><a href="#an-aside-on-pipes-cont." id="toc-an-aside-on-pipes-cont." class="nav-link" data-scroll-target="#an-aside-on-pipes-cont.">An aside on pipes: %&gt;% (cont.)</a></li>
  <li><a href="#dplyr" id="toc-dplyr" class="nav-link" data-scroll-target="#dplyr">dplyr</a></li>
  <li><a href="#key-dplyr-verbs" id="toc-key-dplyr-verbs" class="nav-link" data-scroll-target="#key-dplyr-verbs">Key dplyr verbs</a></li>
  <li><a href="#other-dplyr-goodies" id="toc-other-dplyr-goodies" class="nav-link" data-scroll-target="#other-dplyr-goodies">Other dplyr goodies</a></li>
  <li><a href="#data-cleaning-and-manipulation" id="toc-data-cleaning-and-manipulation" class="nav-link" data-scroll-target="#data-cleaning-and-manipulation">Data cleaning and manipulation</a></li>
  <li><a href="#gapminder-data" id="toc-gapminder-data" class="nav-link" data-scroll-target="#gapminder-data">gapminder data</a></li>
  <li><a href="#gapminder-data-1" id="toc-gapminder-data-1" class="nav-link" data-scroll-target="#gapminder-data-1">gapminder data</a></li>
  <li><a href="#gapminder-data-2" id="toc-gapminder-data-2" class="nav-link" data-scroll-target="#gapminder-data-2">gapminder data</a></li>
  <li><a href="#gapminder-data-3" id="toc-gapminder-data-3" class="nav-link" data-scroll-target="#gapminder-data-3">gapminder data</a></li>
  <li><a href="#gapminder-data-4" id="toc-gapminder-data-4" class="nav-link" data-scroll-target="#gapminder-data-4">gapminder data</a></li>
  <li><a href="#gapminder-data-5" id="toc-gapminder-data-5" class="nav-link" data-scroll-target="#gapminder-data-5">gapminder data</a></li>
  <li><a href="#gapminder-data-6" id="toc-gapminder-data-6" class="nav-link" data-scroll-target="#gapminder-data-6">gapminder data</a></li>
  <li><a href="#gapminder-data-7" id="toc-gapminder-data-7" class="nav-link" data-scroll-target="#gapminder-data-7">gapminder data</a></li>
  <li><a href="#the-tidyverse" id="toc-the-tidyverse" class="nav-link" data-scroll-target="#the-tidyverse">The tidyverse</a></li>
  </ul></li>
  <li><a href="#dplyr-specific-functions" id="toc-dplyr-specific-functions" class="nav-link" data-scroll-target="#dplyr-specific-functions">dplyr-specific functions</a>
  <ul class="collapse">
  <li><a href="#rename" id="toc-rename" class="nav-link" data-scroll-target="#rename">rename</a></li>
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select">select</a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter">filter</a></li>
  <li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate">mutate</a></li>
  <li><a href="#group_by" id="toc-group_by" class="nav-link" data-scroll-target="#group_by">group_by</a></li>
  <li><a href="#summarise" id="toc-summarise" class="nav-link" data-scroll-target="#summarise">summarise</a></li>
  <li><a href="#joins" id="toc-joins" class="nav-link" data-scroll-target="#joins">joins</a></li>
  <li><a href="#joins-1" id="toc-joins-1" class="nav-link" data-scroll-target="#joins-1">joins</a></li>
  <li><a href="#piping" id="toc-piping" class="nav-link" data-scroll-target="#piping">piping</a></li>
  </ul></li>
  <li><a href="#next-time" id="toc-next-time" class="nav-link" data-scroll-target="#next-time">Next time</a></li>
  <li><a href="#week-7a---exploratory-data-analysis" id="toc-week-7a---exploratory-data-analysis" class="nav-link" data-scroll-target="#week-7a---exploratory-data-analysis">Week 7A - Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#midterm-feedback" id="toc-midterm-feedback" class="nav-link" data-scroll-target="#midterm-feedback">Midterm Feedback</a></li>
  </ul></li>
  <li><a href="#where-do-we-begin" id="toc-where-do-we-begin" class="nav-link" data-scroll-target="#where-do-we-begin">Where do we begin?</a>
  <ul class="collapse">
  <li><a href="#understanding-populations-and-their-parameters" id="toc-understanding-populations-and-their-parameters" class="nav-link" data-scroll-target="#understanding-populations-and-their-parameters">Understanding Populations and their Parameters</a></li>
  </ul></li>
  <li><a href="#simulations-to-compare-parameter-estimates" id="toc-simulations-to-compare-parameter-estimates" class="nav-link" data-scroll-target="#simulations-to-compare-parameter-estimates">Simulations to compare parameter estimates</a></li>
  <li><a href="#simulations-to-compare-parameter-estimates-1" id="toc-simulations-to-compare-parameter-estimates-1" class="nav-link" data-scroll-target="#simulations-to-compare-parameter-estimates-1">Simulations to compare parameter estimates</a>
  <ul class="collapse">
  <li><a href="#simulations-to-compare-parameter-estimates-2" id="toc-simulations-to-compare-parameter-estimates-2" class="nav-link" data-scroll-target="#simulations-to-compare-parameter-estimates-2">Simulations to compare parameter estimates</a></li>
  <li><a href="#calculating-parameters" id="toc-calculating-parameters" class="nav-link" data-scroll-target="#calculating-parameters">Calculating parameters</a></li>
  <li><a href="#calculating-parameters-1" id="toc-calculating-parameters-1" class="nav-link" data-scroll-target="#calculating-parameters-1">Calculating parameters</a></li>
  </ul></li>
  <li><a href="#sampling" id="toc-sampling" class="nav-link" data-scroll-target="#sampling">Sampling</a>
  <ul class="collapse">
  <li><a href="#sampling-exercise" id="toc-sampling-exercise" class="nav-link" data-scroll-target="#sampling-exercise">Sampling Exercise</a></li>
  <li><a href="#sampling-exercise-1" id="toc-sampling-exercise-1" class="nav-link" data-scroll-target="#sampling-exercise-1">Sampling Exercise</a></li>
  <li><a href="#randomness-in-sampling" id="toc-randomness-in-sampling" class="nav-link" data-scroll-target="#randomness-in-sampling">Randomness in Sampling</a></li>
  <li><a href="#surveying-your-sampling" id="toc-surveying-your-sampling" class="nav-link" data-scroll-target="#surveying-your-sampling">Surveying your Sampling</a></li>
  <li><a href="#surveying-your-sampling-1" id="toc-surveying-your-sampling-1" class="nav-link" data-scroll-target="#surveying-your-sampling-1">Surveying your Sampling</a></li>
  <li><a href="#surveying-your-sampling-2" id="toc-surveying-your-sampling-2" class="nav-link" data-scroll-target="#surveying-your-sampling-2">Surveying your Sampling</a></li>
  </ul></li>
  <li><a href="#sampling-distributions" id="toc-sampling-distributions" class="nav-link" data-scroll-target="#sampling-distributions">Sampling Distributions</a>
  <ul class="collapse">
  <li><a href="#normal-sampling-distributions" id="toc-normal-sampling-distributions" class="nav-link" data-scroll-target="#normal-sampling-distributions">Normal Sampling Distributions</a></li>
  <li><a href="#normal-sampling-distributions-1" id="toc-normal-sampling-distributions-1" class="nav-link" data-scroll-target="#normal-sampling-distributions-1">Normal Sampling Distributions</a></li>
  <li><a href="#sampling-distributions---its-been-normal-this-whole-time" id="toc-sampling-distributions---its-been-normal-this-whole-time" class="nav-link" data-scroll-target="#sampling-distributions---its-been-normal-this-whole-time">Sampling Distributions - It’s been Normal this whole time?!</a></li>
  <li><a href="#sampling-distributions---exercise" id="toc-sampling-distributions---exercise" class="nav-link" data-scroll-target="#sampling-distributions---exercise">Sampling Distributions - Exercise</a></li>
  <li><a href="#the-central-limit-theorem" id="toc-the-central-limit-theorem" class="nav-link" data-scroll-target="#the-central-limit-theorem">The Central Limit Theorem</a></li>
  </ul></li>
  <li><a href="#standard-error---the-range-of-the-sampling-distribution" id="toc-standard-error---the-range-of-the-sampling-distribution" class="nav-link" data-scroll-target="#standard-error---the-range-of-the-sampling-distribution">Standard Error - the Range of the Sampling Distribution</a>
  <ul class="collapse">
  <li><a href="#standard-error" id="toc-standard-error" class="nav-link" data-scroll-target="#standard-error">Standard Error</a></li>
  <li><a href="#standard-error-1" id="toc-standard-error-1" class="nav-link" data-scroll-target="#standard-error-1">Standard error</a></li>
  <li><a href="#calculating-the-standard-error" id="toc-calculating-the-standard-error" class="nav-link" data-scroll-target="#calculating-the-standard-error">Calculating the Standard Error</a></li>
  <li><a href="#calculating-the-standard-error-1" id="toc-calculating-the-standard-error-1" class="nav-link" data-scroll-target="#calculating-the-standard-error-1">Calculating the Standard Error</a></li>
  </ul></li>
  <li><a href="#bootstrapping" id="toc-bootstrapping" class="nav-link" data-scroll-target="#bootstrapping">Bootstrapping</a>
  <ul class="collapse">
  <li><a href="#easy-steps-for-bootstrapping-in-r" id="toc-easy-steps-for-bootstrapping-in-r" class="nav-link" data-scroll-target="#easy-steps-for-bootstrapping-in-r">Easy steps for bootstrapping in R</a></li>
  <li><a href="#bootstrapping-1" id="toc-bootstrapping-1" class="nav-link" data-scroll-target="#bootstrapping-1">Bootstrapping</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">Confidence Intervals</a></li>
  </ul></li>
  <li><a href="#relationship-between-mean-and-variance" id="toc-relationship-between-mean-and-variance" class="nav-link" data-scroll-target="#relationship-between-mean-and-variance">Relationship between Mean and Variance</a>
  <ul class="collapse">
  <li><a href="#relationship-between-mean-and-variance-1" id="toc-relationship-between-mean-and-variance-1" class="nav-link" data-scroll-target="#relationship-between-mean-and-variance-1">Relationship between mean and variance</a></li>
  <li><a href="#test-it-out" id="toc-test-it-out" class="nav-link" data-scroll-target="#test-it-out">Test it out</a></li>
  <li><a href="#coefficient-of-variation" id="toc-coefficient-of-variation" class="nav-link" data-scroll-target="#coefficient-of-variation">Coefficient of Variation</a></li>
  </ul></li>
  <li><a href="#week-6a-ethics-in-data-science" id="toc-week-6a-ethics-in-data-science" class="nav-link" data-scroll-target="#week-6a-ethics-in-data-science">Week 6A: Ethics in Data Science</a>
  <ul class="collapse">
  <li><a href="#today-well-be-talking-about" id="toc-today-well-be-talking-about" class="nav-link" data-scroll-target="#today-well-be-talking-about">Today we’ll be talking about</a></li>
  </ul></li>
  <li><a href="#what-stats-are-we-learning" id="toc-what-stats-are-we-learning" class="nav-link" data-scroll-target="#what-stats-are-we-learning">What Stats are we learning?</a>
  <ul class="collapse">
  <li><a href="#thinking-about-your-final-project" id="toc-thinking-about-your-final-project" class="nav-link" data-scroll-target="#thinking-about-your-final-project">Thinking about your final project</a></li>
  </ul></li>
  <li><a href="#the-history-of-statistics" id="toc-the-history-of-statistics" class="nav-link" data-scroll-target="#the-history-of-statistics">The History of Statistics</a>
  <ul class="collapse">
  <li><a href="#galton-as-the-father-of-eugenics" id="toc-galton-as-the-father-of-eugenics" class="nav-link" data-scroll-target="#galton-as-the-father-of-eugenics">Galton as the Father of Eugenics</a></li>
  <li><a href="#galton-as-the-father-of-eugenics-1" id="toc-galton-as-the-father-of-eugenics-1" class="nav-link" data-scroll-target="#galton-as-the-father-of-eugenics-1">Galton as the Father of Eugenics</a></li>
  <li><a href="#a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s" id="toc-a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s" class="nav-link" data-scroll-target="#a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s">A common sight at state fairs around the U.S. in the 1930s</a></li>
  <li><a href="#galton-with-charles-davenport-and-g.-stanley-hall" id="toc-galton-with-charles-davenport-and-g.-stanley-hall" class="nav-link" data-scroll-target="#galton-with-charles-davenport-and-g.-stanley-hall">Galton with Charles Davenport and G. Stanley Hall</a></li>
  <li><a href="#logo-of-the-us-eugenics-society" id="toc-logo-of-the-us-eugenics-society" class="nav-link" data-scroll-target="#logo-of-the-us-eugenics-society">Logo of the US eugenics society</a></li>
  <li><a href="#eugenics-societies-in-america" id="toc-eugenics-societies-in-america" class="nav-link" data-scroll-target="#eugenics-societies-in-america">Eugenics societies in America</a></li>
  <li><a href="#ra-fisher-and-eugenics-in-london" id="toc-ra-fisher-and-eugenics-in-london" class="nav-link" data-scroll-target="#ra-fisher-and-eugenics-in-london">RA Fisher and Eugenics in London</a></li>
  <li><a href="#ra-fisher-and-eugenics" id="toc-ra-fisher-and-eugenics" class="nav-link" data-scroll-target="#ra-fisher-and-eugenics">RA Fisher and Eugenics</a></li>
  <li><a href="#eugenics-has-a-direct-line-to-hitler-and-nazism" id="toc-eugenics-has-a-direct-line-to-hitler-and-nazism" class="nav-link" data-scroll-target="#eugenics-has-a-direct-line-to-hitler-and-nazism">Eugenics has a direct line to Hitler and Nazism</a></li>
  <li><a href="#sterilizations-continue-in-america" id="toc-sterilizations-continue-in-america" class="nav-link" data-scroll-target="#sterilizations-continue-in-america">Sterilizations continue in America</a></li>
  <li><a href="#so-what-do-we-do-from-here" id="toc-so-what-do-we-do-from-here" class="nav-link" data-scroll-target="#so-what-do-we-do-from-here">So, what do we do from here?</a></li>
  <li><a href="#interested-in-learning-more" id="toc-interested-in-learning-more" class="nav-link" data-scroll-target="#interested-in-learning-more">Interested in learning more?</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Week2b.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 2b - Statistics for Bioengineering</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bill Cresko </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="today-we-will" class="level2">
<h2 class="anchored" data-anchor-id="today-we-will">Today we will</h2>
<ul>
<li>Finish Markdown, Latex</li>
<li>Exploratory data analysis with ggplot2</li>
<li>Probability and distributions</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Homeworks will be assigned this evening and be due in 2 weeks</p>
</div>
</div>
</section>
<section id="markdown-and-latex" class="level1">
<h1>Markdown and LaTeX</h1>
<section id="what-is-markdown" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="what-is-markdown">What is markdown?</h2>
<ul>
<li>Lightweight <em>formal</em> markup languages are used to add formatting to plaintext documents
<ul>
<li>Adding basic syntax to the text will make elements look different once rendered/knit</li>
<li>Available in many base editors</li>
</ul></li>
<li>You then need a markdown application with a markdown processor/parser to render your text files into something more exciting
<ul>
<li>Static and dynamic outputs!</li>
<li>pdf, HTML, presentations, websites, scientific articles, books etc</li>
</ul></li>
</ul>
</section>
<section id="formatting-text" class="level2">
<h2 class="anchored" data-anchor-id="formatting-text">Formatting text</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span>Italic<span class="sc">*</span> or _Italic_</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span>Bold<span class="sc">**</span> or __Bold__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><em>Italic</em> or <em>Italic</em></li>
<li><strong>Bold</strong> or <strong>Bold</strong></li>
</ul>
</section>
<section id="formatting-text-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="formatting-text-1">Formatting text</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="st">"You know the greatest danger facing us is ourselves, an irrational fear of the unknown. </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="st">But there’s no such thing as the unknown — only things temporarily hidden, temporarily not understood."</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="sc">---</span> Captain James T. Kirk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>“You know the greatest danger facing us is ourselves, an irrational fear of the unknown. But there’s no such thing as the unknown — only things temporarily hidden, temporarily not understood.”</p>
<p>— Captain James T. Kirk</p>
</blockquote>
</section>
<section id="formatting-lists" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="formatting-lists">Formatting lists</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> list_element</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span> sub_list_element <span class="co">#double tab to indent</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span> sub_list_element <span class="co">#double tab to indent</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span> sub_list_element <span class="co">#double tab to indent</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span> list_element</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span> sub_list_element <span class="co">#double tab to indent</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#note the space after each dash- this is important!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>list_element
<ul>
<li>sub_list_element</li>
<li>sub_list_element</li>
<li>sub_list_element</li>
</ul></li>
<li>list_element
<ul>
<li>sub_list_element</li>
</ul></li>
</ul>
</section>
<section id="formatting-lists-1" class="level2">
<h2 class="anchored" data-anchor-id="formatting-lists-1">Formatting lists</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span> One</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span> Two</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span> Three</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fl">4.</span> Four</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>One</li>
<li>Two</li>
<li>Three</li>
<li>Four</li>
</ol>
</section>
<section id="inserting-images-or-urls" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="inserting-images-or-urls">Inserting images or URLs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>[Link](https<span class="sc">:</span><span class="er">//</span>commonmark.org<span class="sc">/</span>help<span class="sc">/</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>[Image](https<span class="sc">:</span><span class="er">//</span>i1.wp.com<span class="sc">/</span>evomics.org<span class="sc">/</span>wp<span class="sc">-</span>content<span class="sc">/</span>uploads<span class="sc">/</span><span class="dv">2012</span><span class="sc">/</span><span class="dv">07</span><span class="sc">/</span><span class="dv">20120115</span><span class="sc">-</span>IMG_0297.jpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://commonmark.org/help/">Link</a> <img src="https://i1.wp.com/evomics.org/wp-content/uploads/2012/07/20120115-IMG_0297.jpg" class="img-fluid" alt="Image"></p>
</section>
<section id="including-code-chunks" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="including-code-chunks">Including code chunks</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
</section>
<section id="what-is-latex" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="what-is-latex">What is LaTeX?</h2>
<ul>
<li>Pronounced «Lah-tech» or «Lay-tech» (to rhyme with «Bertolt Brecht»)</li>
<li>A document preparation system for high-quality typesetting</li>
<li>It is most often used for medium-to-large technical or scientific documents</li>
<li>Can be used for almost any form of publishing.</li>
<li>Typesetting journal articles, technical reports, books, and slide presentations</li>
<li>Allows for precise mathematical statements</li>
<li>https://www.latex-project.org</li>
<li><strong>Importantly, LaTeX can be included right into Markdown documents</strong></li>
</ul>
</section>
<section id="operators-and-symbols" class="level2">
<h2 class="anchored" data-anchor-id="operators-and-symbols">Operators and Symbols</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span> \large a<span class="sc">^</span>x, \sqrt[n]{x}, \vec{\jmath}, \tilde{\imath}<span class="sc">$</span><span class="er">$</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[ \large a^x, \sqrt[n]{x}, \vec{\jmath}, \tilde{\imath}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span> \large \alpha, \beta, \gamma<span class="sc">$</span><span class="er">$</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[ \large \alpha, \beta, \gamma\]</span></p>
</section>
<section id="operators-and-symbols-1" class="level2">
<h2 class="anchored" data-anchor-id="operators-and-symbols-1">Operators and Symbols</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span> \large\approx, \neq, \nsim <span class="sc">$</span><span class="er">$</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[ \large\approx, \neq, \nsim \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span>\large \partial, \mathbb{R}, \flat<span class="sc">$</span><span class="er">$</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[\large \partial, \mathbb{R}, \flat\]</span></p>
</section>
<section id="equations" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="equations">Equations</h2>
<p>Binomial sampling equation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span>\large <span class="fu">f</span>(k) <span class="ot">=</span> {n \choose k} p<span class="sc">^</span>{k} (<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">^</span>{n<span class="sc">-</span>k}<span class="sc">$</span><span class="er">$</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[\large f(k) = {n \choose k} p^{k} (1-p)^{n-k}\]</span></p>
<p>Poisson Sampling Equation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span>\large <span class="fu">Pr</span>(<span class="at">Y=</span>r) <span class="ot">=</span> \frac{e<span class="sc">^</span>{<span class="sc">-</span>\mu}\mu<span class="sc">^</span>r}{r<span class="sc">!</span>}<span class="sc">$</span><span class="er">$</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[\large Pr(Y=r) = \frac{e^{-\mu}\mu^r}{r!}\]</span></p>
</section>
<section id="differential-equations" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="differential-equations">Differential Equations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span>\iint xy<span class="sc">^</span><span class="dv">2</span>\,dx\,dy <span class="ot">=</span>\frac{<span class="dv">1</span>}{<span class="dv">6</span>}x<span class="sc">^</span><span class="dv">2</span>y<span class="sc">^</span><span class="dv">3</span><span class="sc">$</span><span class="er">$</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[\iint xy^2\,dx\,dy =\frac{1}{6}x^2y^3\]</span></p>
</section>
<section id="matrix-formulations" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="matrix-formulations">Matrix formulations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span><span class="er">$</span>  \begin{matrix}</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        <span class="sc">-</span><span class="dv">2</span> <span class="sc">&amp;</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="dv">0</span> <span class="sc">&amp;</span> \cdots <span class="sc">&amp;</span> <span class="dv">0</span>  \\</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">&amp;</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="dv">0</span> <span class="sc">&amp;</span> \cdots <span class="sc">&amp;</span> <span class="dv">0</span>  \\</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span> <span class="sc">&amp;</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">&amp;</span> <span class="dv">1</span> <span class="sc">&amp;</span> \cdots <span class="sc">&amp;</span> <span class="dv">0</span>  \\</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span> <span class="sc">&amp;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">&amp;</span> \ddots <span class="sc">&amp;</span> \vdots \\</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        \vdots <span class="sc">&amp;</span> \vdots <span class="sc">&amp;</span> \vdots <span class="sc">&amp;</span> \ddots <span class="sc">&amp;</span> \ddots <span class="sc">&amp;</span> <span class="dv">1</span>  \\</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span> <span class="sc">&amp;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="dv">0</span> <span class="sc">&amp;</span> \cdots <span class="sc">&amp;</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    \end{matrix} <span class="sc">$</span><span class="er">$</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math display">\[  \begin{matrix}
        -2 &amp; 1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0  \\
        1 &amp; -2 &amp; 1 &amp; 0 &amp; \cdots &amp; 0  \\
        0 &amp; 1 &amp; -2 &amp; 1 &amp; \cdots &amp; 0  \\
        0 &amp; 0 &amp; 1 &amp; -2 &amp; \ddots &amp; \vdots \\
        \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp; 1  \\
        0 &amp; 0 &amp; 0 &amp; \cdots &amp; 1 &amp; -2
    \end{matrix} \]</span></p>
</section>
<section id="in-line-versus-fenced" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="in-line-versus-fenced">In-line versus fenced</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>This equation, <span class="sc">$</span>y<span class="ot">=</span>\frac{<span class="dv">1</span>}{<span class="dv">2</span>}<span class="sc">$</span>, is included inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This equation, <span class="math inline">\(y=\frac{1}{2}\)</span>, is included inline</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>Whereas this equation, <span class="sc">$</span><span class="er">$</span>y<span class="ot">=</span>\frac{<span class="dv">1</span>}{<span class="dv">2</span>}<span class="sc">$</span><span class="er">$</span>, is put on a separate line</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Whereas this equation <span class="math display">\[y=\frac{1}{2}\]</span> is put on a separate line</p>
</section>
<section id="markdown-is-very-flexible" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="markdown-is-very-flexible">Markdown is very flexible</h2>
<ul>
<li>You can import RMarkdown templates into RStudio and open as a new Rmarkdown file</li>
<li>Better yet there are packages that add functionality
<ul>
<li>books</li>
<li>journal articles</li>
<li>slide shows (these slides!)</li>
<li>interactive exercises</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="exploratory-data-analysis-with-ggplot2" class="level1">
<h1>Exploratory Data Analysis with ggplot2</h1>
<section id="reading-in-and-exporting-data-frames" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="reading-in-and-exporting-data-frames">Reading in and Exporting Data Frames</h2>
<p><br>
<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>YourFile <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'yourfile.csv'</span>, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>, <span class="at">sep=</span><span class="st">','</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>YourFile <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'yourfile.txt'</span>, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>, <span class="at">sep=</span><span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(YourFile, <span class="st">"yourfile.csv"</span>, <span class="at">quote=</span>F, <span class="at">row.names=</span>T, <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(YourFile, <span class="st">"yourfile.txt"</span>, <span class="at">quote=</span>F, <span class="at">row.names=</span>T, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="indexing-in-data-frames" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="indexing-in-data-frames">Indexing in data frames</h2>
<ul>
<li>Next up - indexing just a subset of the data</li>
<li>This is a very important idea in R, that you can analyze just a subset of the data.</li>
<li>This is analyzing only the data in the file you made that has the factor value ‘mixed’.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (YourFile[,<span class="dv">2</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (YourFile<span class="sc">$</span>variable)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (YourFile[<span class="dv">2</span>,])</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (YourFile<span class="sc">$</span>variable1, YourFile<span class="sc">$</span>variable2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="types-of-vectors-of-data" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="types-of-vectors-of-data">Types of vectors of data</h2>
<ul>
<li><p><code>int</code> stands for integers</p></li>
<li><p><code>dbl</code> stands for doubles, or real numbers</p></li>
<li><p><code>chr</code> stands for character vectors, or strings</p></li>
<li><p><code>dttm</code> stands for date-times (a date + a time)</p></li>
<li><p><code>lgl</code> stands for logical, vectors that contain only TRUE or FALSE</p></li>
<li><p><code>fctr</code> stands for factors, which R uses to represent categorical variables with fixed possible values</p></li>
<li><p><code>date</code> stands for dates</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Integer and double vectors are known collectively as numeric vectors.</li>
<li>In <code>R</code> numbers are doubles by default.</li>
</ul>
</div>
</div>
</section>
<section id="types-of-vectors-of-data-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="types-of-vectors-of-data-1">Types of vectors of data</h2>
<ul>
<li>Logical vectors can take only three possible values:
<ul>
<li><code>FALSE</code></li>
<li><code>TRUE</code></li>
<li><code>NA</code> which is ‘not available’.</li>
</ul></li>
<li>Integers have one special value: NA, while doubles have four:
<ul>
<li><code>NA</code></li>
<li><code>NaN</code> which is ‘not a number’</li>
<li><code>Inf</code></li>
<li><code>-Inf</code></li>
</ul></li>
</ul>
</section>
</section>
<section id="ggplot2" class="level1">
<h1>ggplot2</h1>
<section id="plotting-using-ggplot2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="plotting-using-ggplot2">Plotting using <code>ggplot2()</code></h2>
<ul>
<li>Part of the <code>tidyverse</code> suite of packages</li>
<li>In most cases, you start with <code>ggplot2()</code></li>
<li>Supply a dataset and aesthetic mapping with <code>aes()</code></li>
<li>Determine the type of plot using <code>geom_point()</code> or <code>geom_histogram()</code> or others</li>
<li>Many more options and controls available!</li>
<li>More info: https://ggplot2.tidyverse.org/</li>
</ul>
</section>
<section id="ggplot2-and-the-grammar-of-graphics" class="level2">
<h2 class="anchored" data-anchor-id="ggplot2-and-the-grammar-of-graphics">GGPlot2 and the Grammar of Graphics</h2>
<ul>
<li>GG stands for ‘Grammar of Graphics’</li>
<li>A good paragraph uses good grammar to convey information</li>
<li>A good figure uses good grammar in the same way</li>
<li>Seven general components can be used to create most figures</li>
</ul>
</section>
<section id="ggplot2-and-the-grammar-of-graphics-1" class="level2">
<h2 class="anchored" data-anchor-id="ggplot2-and-the-grammar-of-graphics-1">GGPlot2 and the Grammar of Graphics</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4a.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-using-ggplot" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="plotting-using-ggplot">Plotting using <code>ggplot()</code></h2>
<ul>
<li>Install and load <code>ggplot2</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggplot2")</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scatterplots-with-ggplot" class="level2">
<h2 class="anchored" data-anchor-id="scatterplots-with-ggplot">Scatterplots with <code>ggplot</code></h2>
<ul>
<li>Use the preloaded <code>mpg</code> dataset available in RStudio</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">color =</span> class)) <span class="sc">+</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplots-in-ggplot" class="level2">
<h2 class="anchored" data-anchor-id="boxplots-in-ggplot">Boxplots in <code>ggplot</code></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(manufacturer, hwy, <span class="at">colour =</span> class)) <span class="sc">+</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-geom_bar-function" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="the-geom_bar-function">The <code>geom_bar</code> function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>cut))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now try this…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">color=</span>cut))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and this…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">fill=</span>cut))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and finally this…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">fill=</span>clarity), <span class="at">position=</span><span class="st">"dodge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-geom_histogram-and-geom_freqpolyfunction" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="the-geom_histogram-and-geom_freqpolyfunction">The <code>geom_histogram</code> and <code>geom_freqpoly</code>function</h2>
<p>With this function you can make a histogram</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>carat), <span class="at">binwidth=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This allows you to make a frequency polygram</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>carat), <span class="at">binwidth=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-geom_boxplot-function" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="the-geom_boxplot-function">The <code>geom_boxplot</code> function</h2>
<p>Boxplots are very useful for visualizing data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">y=</span>price)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(class, hwy, <span class="at">FUN=</span>median), <span class="at">y=</span>hwy)) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coordflip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>class, <span class="at">y=</span>hwy)) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  coordflip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-geom_point-geom_smooth-functions" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="the-geom_point-geom_smooth-functions">The <code>geom_point</code> &amp; <code>geom_smooth</code> functions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds2, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geompoint</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geompoint</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>class, <span class="at">nrow=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geompoint</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(drv<span class="sc">~</span>cyl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geomsmooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combining-geoms" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="combining-geoms">Combining geoms</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="adding-labels" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="adding-labels">Adding labels</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>class)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Fuel efficiency generally decreases with engine size"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Data from fueleconomy.gov"</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="what-type-of-plot-do-i-use-for-each-data-type" class="level2">
<h2 class="anchored" data-anchor-id="what-type-of-plot-do-i-use-for-each-data-type">What type of plot do I use for each data type?</h2>
<hr>
<hr>
</section>
</section>
<section id="randomness-in-statistics" class="level1 smaller">
<h1 class="smaller">Randomness in Statistics</h1>
<ul>
<li>We often want to know truths about the world, but the best we can do is estimate them - and uncertainty in those estimates is a given.</li>
<li>The process of statistics is largely about quantifying and managing uncertainty.</li>
<li>Frequently, we want to understand how likely a particular observation or set of observations is (e.g.&nbsp;from a sample of a population), given some expectation.</li>
<li>Expectations can be based on theoretical probability distributions</li>
</ul>
</section>
<section id="probability-and-distributions" class="level1">
<h1>Probability and distributions</h1>
<section id="different-flavors-of-inferential-statistics" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="different-flavors-of-inferential-statistics">Different flavors of inferential statistics</h2>
<ul>
<li><strong>Frequentist Statistics</strong>
<ul>
<li>Classical or standard approaches</li>
<li>Null hypothesis testing<br>
<br>
</li>
</ul></li>
<li><strong>Hierarchical Probabilistic Modeling</strong>
<ul>
<li>Maximum Likelihood</li>
<li>Bayesian Analyses</li>
<li>Machine Learning</li>
</ul></li>
</ul>
</section>
<section id="what-is-probability" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="what-is-probability">What is probability</h2>
<ul>
<li><strong>Frequency interpretation</strong></li>
</ul>
<p>“Probabilities are understood as mathematically convenient approximations to long run relative frequencies.”</p>
<ul>
<li><strong>Subjective (Bayesian) interpretation</strong></li>
</ul>
<p>“A probability statement expresses the opinion of some individual regarding how certain an event is to occur.”</p>
</section>
<section id="random-variables-probability" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="random-variables-probability">Random variables &amp; probability</h2>
<ul>
<li><p><strong>Probability</strong> is the expression of belief in some future outcome</p></li>
<li><p>A <strong>random variable</strong> can take on different values with different probabilities</p></li>
<li><p>The <strong>sample space</strong> of a random variable is the universe of all possible values</p></li>
</ul>
</section>
<section id="random-variables-probability-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="random-variables-probability-1">Random variables &amp; probability</h2>
<ul>
<li>The <strong>sample space</strong> can be represented by a
<ul>
<li><strong>probability distribution</strong> (discrete)</li>
<li><strong>probability density function (PDF)</strong> (continuous)</li>
<li>algebra and calculus are used for each respectively</li>
<li>probabilities of a sample space <strong>always sum to 1.0</strong></li>
</ul></li>
<li>How does it make sense that a sample space will always sum to 1?</li>
</ul>
</section>
<section id="bernoulli-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="bernoulli-distribution">Bernoulli distribution</h2>
<ul>
<li><p>Describes the expected outcome of a single event with probability <code>p</code></p></li>
<li><p>Example of flipping of a <strong>fair</strong> coin once</p></li>
</ul>
<p><span class="math display">\[Pr(X=\text{Head}) = \frac{1}{2} = 0.5 = p \]</span></p>
<p><span class="math display">\[Pr(X=\text{Tails}) = \frac{1}{2} = 0.5 = 1 - p = q \]</span></p>
</section>
<section id="bernoulli-distribution-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="bernoulli-distribution-1">Bernoulli distribution</h2>
<ul>
<li>If the coin isn’t fair then <span class="math inline">\(p \neq 0.5\)</span></li>
<li>However, the probabilities still sum to 1</li>
</ul>
<p><span class="math display">\[ p + (1-p) = 1 \]</span> <span class="math display">\[ p + q = 1 \]</span></p>
<ul>
<li>Same is true for other binary possibilities
<ul>
<li>success or failure</li>
<li>yes or no answers</li>
<li>choosing an allele from a population based upon allele frequencies (Hardy-Weinberg ring any bells??)</li>
</ul></li>
</ul>
</section>
<section id="probability-rules" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="probability-rules">Probability rules</h2>
<ul>
<li>Flip a coin twice</li>
<li>Represent the first flip as ‘X’ and the second flip as ‘Y’</li>
</ul>
<p><span class="math display">\[ Pr(\text{X=H and Y=H}) = p*p = p^2 \]</span> <span class="math display">\[ Pr(\text{X=H and Y=T}) = p*q = pq = p^2 \]</span> <span class="math display">\[ Pr(\text{X=T and Y=H}) = q*p = pq \]</span> <span class="math display">\[ Pr(\text{X=T and Y=T}) = q*q = q^2 \]</span></p>
</section>
<section id="probability-rules-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="probability-rules-1">Probability rules</h2>
<ul>
<li>Probability that the <code>H</code> and <code>T</code> can occur in any order</li>
</ul>
<p><span class="math display">\[ \text{Pr(X=H) or Pr(X=T)} = p+q=1\]</span></p>
<p><span class="math display">\[ \text{Pr(X=H and Y=T) or Pr(X=T and Y=H)} = \]</span> <span class="math display">\[ (p*q) + (p*q) = 2pq \]</span></p>
<ul>
<li>These are the <strong>‘and’</strong> and <strong>‘or’</strong> rules of probability
<ul>
<li>‘and’ means multiply the probabilities</li>
<li>‘or’ means sum the probabilities</li>
<li>most probability distributions can be built up from these simple rules</li>
</ul></li>
</ul>
</section>
<section id="lets-simulate-some-coin-flips" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="lets-simulate-some-coin-flips">Let’s simulate some coin flips</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tossing a fair coin</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>coin <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"heads"</span>, <span class="st">"tails"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(coin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tails" "heads"</code></pre>
</div>
</div>
</section>
<section id="lets-simulate-some-coin-flips-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="lets-simulate-some-coin-flips-1">Let’s simulate some coin flips</h2>
<ul>
<li>What happens when we change the probabilities or the sample size? How confident are we that our coin is fair?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>flips <span class="ot">&lt;-</span> <span class="fu">sample</span>(coin, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">size=</span><span class="dv">10</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(flips))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="expectation-and-moments-of-distributions" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="expectation-and-moments-of-distributions">Expectation and Moments of Distributions</h2>
<ul>
<li>Distributions have <strong>moments</strong> that can be estimated</li>
<li>1st, 2nd, 3rd and 4th moments of a distribution?</li>
<li>The expectation or mean of a random variable X is:</li>
</ul>
<p><span class="math display">\[E[X] = \sum_{\text{all x}}^{}xP(X=x) = \mu\]</span></p>
<ul>
<li>Often we want to know how dispersed the random variable is around its mean.</li>
<li>One measure of dispersion is the variance</li>
</ul>
<p><span class="math display">\[Var(X) = E[X^2] = \sigma^2\]</span></p>
</section>
<section id="joint-probability" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="joint-probability">Joint probability</h2>
<p><span class="math display">\[Pr(X,Y) = Pr(X) * Pr(Y)\]</span></p>
<ul>
<li>Note that this is true for two <strong>independent</strong> events</li>
<li>However, for two non-independent events we also have to take into account their <strong>covariance</strong></li>
<li>To do this we need <strong>conditional probabilities</strong></li>
</ul>
</section>
<section id="conditional-probability" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="conditional-probability">Conditional probability</h2>
<ul>
<li>For two <strong>independent</strong> variables: Probability of Y, given X, or the probability of X, given Y.</li>
</ul>
<p><span class="math display">\[Pr(Y|X) = Pr(Y)\text{ and }Pr(X|Y) = Pr(X)\]</span></p>
<ul>
<li>For two <strong>non-independent</strong> variables</li>
</ul>
<p><span class="math display">\[Pr(Y|X) \neq Pr(Y)\text{ and }Pr(X|Y) \neq Pr(X)\]</span></p>
<ul>
<li>Variables that are non-independent have a shared variance, which is also known as the <strong>covariance</strong></li>
<li>Covariance standardized to a mean of zero and a unit standard deviation is <strong>correlation</strong></li>
</ul>
</section>
<section id="what-is-likelihood-vs.-probability" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="what-is-likelihood-vs.-probability">What is Likelihood vs.&nbsp;Probability?</h2>
<ul>
<li><p>The <strong>probability</strong> of an event is the proportion of times that the event would occur if we repeated a random trial over and over again under the same conditions.</p></li>
<li><p>The <strong>likelihood</strong> is a conditional probability of a parameter value given a set of data</p></li>
<li><p>The likelihood of a population parameter <strong>equaling a specific value, given the data</strong></p></li>
</ul>
<p><code>L[parameter|data] = Pr[data|parameter]</code></p>
<ul>
<li><strong>Likelihood function</strong> which can have a maximum</li>
</ul>
</section>
<section id="extra-bayesian-material" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="extra-bayesian-material">Extra Bayesian material</h2>
</section>
<section id="who-wants-to-win-a-car" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="who-wants-to-win-a-car">Who wants to win a car?</h2>
<ul>
<li><p>Pretend that there are three doors, and behind one is a car. Behind the other doors are cats.</p></li>
<li><p>You choose one of the doors, and then Monte Hall opens one of the two remaining doors to reveal a cat.</p></li>
<li><p>At this point you have the choice of changing doors or staying with your original choice.</p></li>
<li><p><strong>What should you do?</strong></p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/cats/two.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="common-probability-distributions" class="level1">
<h1>Common probability distributions</h1>
<section id="geometric-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="geometric-distribution"><strong>Geometric Distribution</strong></h2>
<ul>
<li>If a single event has two possible outcomes the probability of having to observe <code>k</code> trials before the first “one” appears is given by the <strong>geometric distribution</strong></li>
<li>The probability that the first “one” would appear on the first trial is <code>p</code>, but the probability that the first “one” appears on the second trial is <code>(1-p)*p</code></li>
<li>By generalizing this procedure, the probability that there will be <code>k-1</code> failures before the first success is:</li>
</ul>
<p><span class="math display">\[P(X=k)=(1-p)^{k-1}p\]</span></p>
<ul>
<li>mean = <span class="math inline">\(\frac{1}{p}\)</span></li>
<li>variance = <span class="math inline">\(\frac{(1-p)}{p^2}\)</span></li>
</ul>
</section>
<section id="geometric-distribution-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="geometric-distribution-1"><strong>Geometric Distribution</strong></h2>
<ul>
<li>Example: If the probability of extinction of an endangered population is estimated to be 0.1 every year, what is the expected time until extinction?</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/prob.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="geometric-distribution-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="geometric-distribution-2"><strong>Geometric Distribution</strong></h2>
<ul>
<li>The distribution gives the probability of extinction in a given year (requiring that the population did not go extinct in all of the years prior)</li>
<li>If we want to know the probability of the population going exticnt by year 4, we simply add up the probabilities for years 1-3 using “or” rules</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/prob.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="testing-geometric-distributions" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="testing-geometric-distributions">Testing Geometric Distributions</h2>
<ul>
<li>dgeom gives the density (probability) of an event (p) after (x) failures</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dgeom(x=20, p=0.1)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.01215767</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dgeom</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="testing-geometric-distributions-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="testing-geometric-distributions-1">Testing Geometric Distributions</h2>
<ul>
<li>pgeom gives the cumulative probability of event (p) in (q) trials</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgeom</span>(<span class="at">q=</span><span class="dv">20</span>, <span class="at">p=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.890581</code></pre>
</div>
</div>
</section>
<section id="binomial-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="binomial-distribution"><strong>Binomial Distribution</strong></h2>
<ul>
<li><p>A <strong>binomial distribution</strong> results from the <strong>combination</strong> of several independent Bernoulli events</p></li>
<li><p><strong>Example</strong></p>
<ul>
<li>Pretend that you flip 20 fair coins
<ul>
<li>or collect alleles from a heterozygote</li>
</ul></li>
<li>Now repeat that process and record the number of heads</li>
<li>We expect that most of the time we will get approximately 10 heads</li>
<li>Sometimes we get many fewer heads or many more heads</li>
</ul></li>
</ul>
</section>
<section id="binomial-distribution-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="binomial-distribution-1">Binomial Distribution</h2>
<ul>
<li>The distribution of probabilities for each combination of outcomes is</li>
</ul>
<p><span class="math display">\[\large f(k) = {n \choose k} p^{k} (1-p)^{n-k}\]</span></p>
<ul>
<li><code>n</code> is the total number of trials</li>
<li><code>k</code> is the number of successes</li>
<li><code>p</code> is the probability of success</li>
<li><code>q</code> is the probability of not success</li>
<li>For binomial as with the Bernoulli <code>p = 1-q</code></li>
</ul>
</section>
<section id="binomial-probability-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="binomial-probability-distribution">Binomial Probability Distribution</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.003.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="testing-binomial-distributions" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="testing-binomial-distributions">Testing Binomial Distributions</h2>
<ul>
<li>dbinom gives the density (probability) of number successes (x) in number trials (size), with (prob) probability between 0-1</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dbinom(x=5, size=10, p=0.5)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.246</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dbinom</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">p=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="testing-binomial-distributions-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="testing-binomial-distributions-1">Testing Binomial Distributions</h2>
<ul>
<li>pbinom gives the cumulative probability of reaching at least (q) number of successes after (size) number of trials</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">size=</span><span class="dv">100</span>, <span class="at">p=</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="negative-binomial-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="negative-binomial-distribution"><strong>Negative Binomial Distribution</strong></h2>
<ul>
<li>Extension of the geometric distribution describing the waiting time until <code>r</code> “successes” have happened.</li>
<li>Generalizes the geometric distribution</li>
<li>Probability of the <span class="math inline">\(r^{th}\)</span> “success” appearing on the <span class="math inline">\(k^{th}\)</span> trial</li>
<li>mean = <span class="math inline">\(\frac{r}{p}\)</span></li>
<li>variance = <span class="math inline">\(r(1-p)/p^2\)</span></li>
</ul>
</section>
<section id="negative-binomial-distribution-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="negative-binomial-distribution-1"><strong>Negative Binomial Distribution</strong></h2>
<ul>
<li>Example: If a predator must capture 10 prey before it can grow large enough to reproduce</li>
<li>What would the mean age of onset of reproduction be if the probability of capturing a prey on any given day is 0.1?</li>
<li>Notice that the variance is quite high (~1000) and that the distribution looks quite skewed</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/prob.018.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="poisson-probability-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="poisson-probability-distribution"><strong>Poisson Probability Distribution</strong></h2>
<ul>
<li><p>Another common situation in biology is when each trial is discrete, but the number of observations of each outcome is observed/counted</p></li>
<li><p>Some examples are</p>
<ul>
<li>counts of snails in several plots of land</li>
<li>observations of the firing of a neuron in a unit of time</li>
<li>count of genes in a genome binned to units of 500 AA</li>
</ul></li>
<li><p>Just like before you have ‘successes’, but</p>
<ul>
<li>now you count them for each replicate</li>
<li>the replicates now are units of area or time</li>
<li>the values can now range from 0 to a large number</li>
</ul></li>
</ul>
</section>
<section id="poisson-probability-distribution-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="poisson-probability-distribution-1">Poisson Probability Distribution</h2>
<ul>
<li>For example, you can examine 1000 genes
<ul>
<li>count the number of base pairs in the coding region of each gene</li>
<li>what is the probability of observing a gene with ‘r’ bp?</li>
</ul></li>
<li><code>Pr(Y=r)</code> is the probability that the number of occurrences of an event <code>y</code> equals a count <code>r</code> in the total number of trials</li>
</ul>
</section>
<section id="poisson-probability-distribution-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="poisson-probability-distribution-2">Poisson Probability Distribution</h2>
<ul>
<li>Note that this is a single parameter function because <span class="math inline">\(\mu = \sigma^2\)</span></li>
<li>The two together are often just represented by <span class="math inline">\(\lambda\)</span></li>
</ul>
<p><span class="math display">\[Pr(y=r) = \frac{e^{-\lambda}\lambda^r}{r!}\]</span></p>
<ul>
<li>This means that for a variable that is truly Poisson distributed:
<ul>
<li>the mean and variance should be equal to one another</li>
<li>variables that are approximately Poisson distributed but have a larger variance than mean are often called ‘overdispersed’</li>
<li>quite common in RNA-seq and microbiome data</li>
</ul></li>
</ul>
</section>
<section id="poisson-probability-distribution-gene-length-by-bins-of-500-nucleotides" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="poisson-probability-distribution-gene-length-by-bins-of-500-nucleotides">Poisson Probability Distribution | gene length by bins of 500 nucleotides</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.004.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="poisson-probability-distribution-increasing-parameter-values-of-lambda" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="poisson-probability-distribution-increasing-parameter-values-of-lambda">Poisson Probability Distribution | increasing parameter values of <span class="math inline">\(\lambda\)</span></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.005.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="testing-poisson-distributions" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="testing-poisson-distributions">Testing Poisson Distributions</h2>
<p>Number of counts (x) given a mean and variance of lambda</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="at">x=</span><span class="dv">2</span>, <span class="at">lambda=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1839397</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dpois</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">lambda=</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="uniform-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="uniform-distribution"><strong>Uniform Distribution</strong></h2>
<ul>
<li>Means that the probability is equal for all possible outcomes</li>
<li>Like drawing m&amp;m out of a bag with equal proportions of colors</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dunif</span>(<span class="at">x=</span><span class="dv">1</span>,<span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1</code></pre>
</div>
</div>
</section>
<section id="uniform-distribution-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="uniform-distribution-1">Uniform Distribution</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dunif</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/prob.019.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exponential-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="exponential-distribution">Exponential Distribution</h2>
<ul>
<li>For example, let equal the instantaneous death rate of an individual.</li>
<li>The lifespan of the individual would be described by an exponential distribution (assuming that does not change over time).</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/prob.020.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exponential-distribution-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="exponential-distribution-1">Exponential Distribution</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dexp</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">rate =</span> <span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gamma-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="gamma-distribution"><strong>Gamma Distribution</strong></h2>
<ul>
<li>The gamma distribution generalizes the exponential distribution.</li>
<li>It describes the waiting time until the <span class="math inline">\(r^{th}\)</span> event for a process that occurs randomly over time at a rate <span class="math inline">\(\lambda\)</span></li>
</ul>
</section>
<section id="gamma-distribution-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="gamma-distribution-1">Gamma Distribution</h2>
<ul>
<li><p><strong>Example</strong>: If, in a PCR reaction, DNA polymerase synthesizes new DNA strands at a rate of 1 per millisecond, how long until 1000 new DNA strands are produced?</p></li>
<li><p>Assume that DNA synthesis does not deplete the pool of primers or nucleotides in the chamber, so that each event is independent of other events in the PCR chamber.</p></li>
</ul>
</section>
<section id="the-gaussian-or-normal-distribution" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="the-gaussian-or-normal-distribution">The Gaussian or Normal Distribution</h2>
</section>
<section id="log-normal-pdf-continuous-version-of-poisson--ish" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="log-normal-pdf-continuous-version-of-poisson--ish">Log-normal PDF | Continuous version of Poisson (-ish)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.006.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="transformations-to-normalize-data" class="level2 smaller vcenter flexbox">
<h2 class="smaller vcenter flexbox anchored" data-anchor-id="transformations-to-normalize-data">Transformations to ‘normalize’ data</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.007.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="transformations-to-normalize-data-1" class="level2 smaller vcenter flexbox">
<h2 class="smaller vcenter flexbox anchored" data-anchor-id="transformations-to-normalize-data-1">Transformations to ‘normalize’ data</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.008.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="binomial-to-normal-categorical-to-continuous" class="level2 smaller vcenter flexbox">
<h2 class="smaller vcenter flexbox anchored" data-anchor-id="binomial-to-normal-categorical-to-continuous">Binomial to Normal | Categorical to continuous</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.009.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-normal-aka-gaussian-probability-density-function-pdf" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="the-normal-aka-gaussian-probability-density-function-pdf">The Normal (aka Gaussian) | Probability Density Function (PDF)</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.011.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="normal-pdf" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="normal-pdf">Normal PDF</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.012.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="normal-pdf-a-function-of-two-parameters" class="level2">
<h2 class="anchored" data-anchor-id="normal-pdf-a-function-of-two-parameters">Normal PDF | A function of two parameters</h2>
<section id="mu-and-sigma" class="level3 smaller">
<h3 class="smaller anchored" data-anchor-id="mu-and-sigma">(<span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>)</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.032.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<p>where <span class="math display">\[\large \pi \approx 3.14159\]</span></p>
<p><span class="math display">\[\large \epsilon \approx 2.71828\]</span></p>
<p>To write that a variable (v) is distributed as a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>, we write the following:</p>
<p><span class="math display">\[\large v \sim \mathcal{N} (\mu,\sigma^2)\]</span></p>
</section>
</section>
<section id="normal-pdf-estimates-of-mean-and-variance" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="normal-pdf-estimates-of-mean-and-variance">Normal PDF | estimates of mean and variance</h2>
<p>Estimate of the mean from a single sample</p>
<p><span class="math display">\[\Large \bar{x} = \frac{1}{n}\sum_{i=1}^{n}{x_i} \]</span></p>
<p>Estimate of the variance from a single sample</p>
<p><span class="math display">\[\Large s^2 = \frac{1}{n-1}\sum_{i=1}^{n}{(x_i - \bar{x})^2} \]</span></p>
</section>
<section id="normal-pdf-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="normal-pdf-1">Normal PDF</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.010.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="why-is-the-normal-special-in-biology" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="why-is-the-normal-special-in-biology">Why is the Normal special in biology?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.013.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="why-is-the-normal-special-in-biology-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="why-is-the-normal-special-in-biology-1">Why is the Normal special in biology?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.015.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="why-is-the-normal-special-in-biology-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="why-is-the-normal-special-in-biology-2">Why is the Normal special in biology?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.014.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="parent-offspring-resemblance" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="parent-offspring-resemblance">Parent-offspring resemblance</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.016.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:45.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="genetic-model-of-complex-traits" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="genetic-model-of-complex-traits">Genetic model of complex traits</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution-of-f_2-genotypes-really-just-binomial-sampling" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="distribution-of-f_2-genotypes-really-just-binomial-sampling">Distribution of <span class="math inline">\(F_2\)</span> genotypes | really just binomial sampling</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.018.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="why-else-is-the-normal-special" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="why-else-is-the-normal-special">Why else is the Normal special?</h2>
<ul>
<li>The normal distribution is immensely useful because of the central limit theorem, which says that the mean of many random variables independently drawn from the same distribution is distributed approximately normally</li>
<li>One can think of numerous situations, such as
<ul>
<li>when multiple genes contribute to a phenotype</li>
<li>or that many factors contribute to a biological process</li>
</ul></li>
<li>In addition, whenever there is variance introduced by stochastic factors the central limit theorem holds</li>
<li>Thus, normal distributions occur throughout genomics</li>
<li>It’s also the basis of the majority of classical statistics</li>
</ul>
</section>
<section id="z-scores-of-normal-variables" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="z-scores-of-normal-variables">z-scores of normal variables</h2>
<ul>
<li>Often we want to make variables more comparable to one another</li>
<li>For example, consider measuring the leg length of mice and of elephants
<ul>
<li>Which animal has longer legs in absolute terms?</li>
<li>Proportional to their body size?</li>
</ul></li>
<li>A good way to answer these last questions is to use ‘z-scores’</li>
</ul>
</section>
<section id="z-scores-of-normal-variables-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="z-scores-of-normal-variables-1">z-scores of normal variables</h2>
<ul>
<li>z-scores are standardized to a mean of 0 and a standard deviation of 1</li>
<li>We can modify any normal distribution to have a mean of 0 and a standard deviation of 1</li>
<li>Another term for this is the standard normal distribution</li>
</ul>
<p><span class="math display">\[\huge z_i = \frac{(x_i - \bar{x})}{s}\]</span></p>
<hr>
</section>
</section>
<section id="data-wrangling" class="level1">
<h1>Data Wrangling?</h1>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources:</h2>
<ul>
<li><a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">Vignette</a> (from the <strong>tidyr</strong> package)</li>
<li><a href="https://vita.had.co.nz/papers/tidy-data.pdf">Original paper</a> (Hadley Wickham, 2014 JSS)</li>
</ul>
</section>
<section id="r-packages-youll-need-today" class="level2">
<h2 class="anchored" data-anchor-id="r-packages-youll-need-today">R packages you’ll need today</h2>
<p><a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a></p>
<p><a href="hhttps://github.com/hadley/nycflights13"><strong>nycflights13</strong></a></p>
</section>
<section id="tidyverse-vs.-base-r-cont." class="level2">
<h2 class="anchored" data-anchor-id="tidyverse-vs.-base-r-cont.">Tidyverse vs.&nbsp;base R (cont.)</h2>
<p>One point of convenience is that there is often a direct correspondence between a tidyverse command and its base R equivalent.</p>
<p>These generally follow a <code>tidyverse::snake_case</code> vs <code>base::period.case</code> rule. E.g. Compare:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>tidyverse</th>
<th>base</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>?readr::read_csv</code></td>
<td><code>?utils::read.csv</code></td>
</tr>
<tr class="even">
<td><code>?dplyr::if_else</code></td>
<td><code>?base::ifelse</code></td>
</tr>
<tr class="odd">
<td><code>?tibble::tibble</code></td>
<td><code>?base::data.frame</code></td>
</tr>
</tbody>
</table>
<p>Etcetera.</p>
<p>If you call up the above examples, you’ll see that the tidyverse alternative typically offers some enhancements or other useful options (and sometimes restrictions) over its base counterpart.</p>
<p>–</p>
<p><strong>Remember:</strong> There are (almost) always multiple ways to achieve a single goal in R.</p>
<hr>
</section>
<section id="tidyverse-packages" class="level2">
<h2 class="anchored" data-anchor-id="tidyverse-packages">Tidyverse packages</h2>
<p>Let’s load the tidyverse meta-package and check the output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>–</p>
<p>We see that we have actually loaded a number of packages (which could also be loaded individually): <strong>ggplot2</strong>, <strong>tibble</strong>, <strong>dplyr</strong>, etc. - We can also see information about the package versions and some <a href="https://raw.githack.com/uo-ec607/lectures/master/04-rlang/04-rlang.html#59">namespace conflicts</a>.</p>
<hr>
</section>
<section id="tidyverse-packages-cont." class="level2">
<h2 class="anchored" data-anchor-id="tidyverse-packages-cont.">Tidyverse packages (cont.)</h2>
<p>The tidyverse actually comes with a lot more packages than those that are just loaded automatically.<sup>1</sup></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyverse_packages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "broom"         "conflicted"    "cli"           "dbplyr"       
 [5] "dplyr"         "dtplyr"        "forcats"       "ggplot2"      
 [9] "googledrive"   "googlesheets4" "haven"         "hms"          
[13] "httr"          "jsonlite"      "lubridate"     "magrittr"     
[17] "modelr"        "pillar"        "purrr"         "ragg"         
[21] "readr"         "readxl"        "reprex"        "rlang"        
[25] "rstudioapi"    "rvest"         "stringr"       "tibble"       
[29] "tidyr"         "xml2"          "tidyverse"    </code></pre>
</div>
</div>
<p>We’ll use several of these additional packages during the remainder of this course.</p>
<ul>
<li>E.g. The <strong>lubridate</strong> package for working with dates and the <strong>rvest</strong> package for webscraping.</li>
<li>However, bear in mind that these packages will have to be loaded separately.</li>
</ul>
<p>.footnote[ <sup>1</sup> It also includes a <em>lot</em> of dependencies upon installation. This is a matter of some <a href="http://www.tinyverse.org/">controversy</a>.]</p>
<hr>
</section>
<section id="tidyverse-packages-cont.-1" class="level2">
<h2 class="anchored" data-anchor-id="tidyverse-packages-cont.-1">Tidyverse packages (cont.)</h2>
<p>I hope to cover most of the tidyverse packages over the length of this course.</p>
<p>Today, however, I’m only really going to focus on two packages: 1. <a href="https://dplyr.tidyverse.org/"><strong>dplyr</strong></a> 2. <a href="https://tidyr.tidyverse.org/"><strong>tidyr</strong></a></p>
<p>These are the workhorse packages for cleaning and wrangling data. They are thus the ones that you will likely make the most use of (alongside <strong>ggplot2</strong>, which we already met back in Lecture 1). - Data cleaning and wrangling occupies an inordinate amount of time, no matter where you are in your research career.</p>
</section>
<section id="an-aside-on-pipes" class="level2">
<h2 class="anchored" data-anchor-id="an-aside-on-pipes">An aside on pipes: %&gt;%</h2>
<p>The tidyverse loads its own pipe operator, denoted <code>%&gt;%</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">## These next two lines of code do exactly the same thing.</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span> <span class="fu">filter</span>(manufacturer<span class="sc">==</span><span class="st">"audi"</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">hwy_mean =</span> <span class="fu">mean</span>(hwy))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(<span class="fu">group_by</span>(<span class="fu">filter</span>(mpg, manufacturer<span class="sc">==</span><span class="st">"audi"</span>), model), <span class="at">hwy_mean =</span> <span class="fu">mean</span>(hwy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>–</p>
<p>The first line reads from left to right, exactly how I thought of the operations in my head. - Take this object (<code>mpg</code>), do this (<code>filter</code>), then do this (<code>group_by</code>), etc.</p>
<p>The second line totally inverts this logical order (the final operation comes first!) - Who wants to read things inside out?</p>
</section>
<section id="an-aside-on-pipes-cont." class="level2">
<h2 class="anchored" data-anchor-id="an-aside-on-pipes-cont.">An aside on pipes: %&gt;% (cont.)</h2>
<p>The piped version of the code is even more readable if we write it over several lines. Here it is again and, this time, I’ll run it for good measure so you can see the output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(manufacturer<span class="sc">==</span><span class="st">"audi"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hwy_mean =</span> <span class="fu">mean</span>(hwy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  model      hwy_mean
  &lt;chr&gt;         &lt;dbl&gt;
1 a4             28.3
2 a4 quattro     25.8
3 a6 quattro     24  </code></pre>
</div>
</div>
<p>Remember: Using vertical space costs nothing and makes for much more readable/writeable code than cramming things horizontally.</p>
</section>
<section id="dplyr" class="level2">
<h2 class="anchored" data-anchor-id="dplyr">dplyr</h2>

<div style="float:left">

</div>
<hr color="#EB811B" size="1px" width="796px">

</section>
<section id="key-dplyr-verbs" class="level2">
<h2 class="anchored" data-anchor-id="key-dplyr-verbs">Key dplyr verbs</h2>
<p>There are five key dplyr verbs that you need to learn.</p>
<ol type="1">
<li><p><code>filter</code>: Filter (i.e.&nbsp;subset) rows based on their values.</p></li>
<li><p><code>arrange</code>: Arrange (i.e.&nbsp;reorder) rows based on their values.</p></li>
<li><p><code>select</code>: Select (i.e.&nbsp;subset) columns by their names:</p></li>
<li><p><code>mutate</code>: Create new columns.</p></li>
<li><p><code>summarise</code>: Collapse multiple rows into a single summary value.<sup>1</sup></p></li>
</ol>
</section>
<section id="other-dplyr-goodies" class="level2">
<h2 class="anchored" data-anchor-id="other-dplyr-goodies">Other dplyr goodies</h2>
<p><code>group_by</code> and <code>ungroup</code>: For (un)grouping. - Particularly useful with the <code>summarise</code> and <code>mutate</code> commands, as we’ve already seen.</p>
<p><br>
</p>
<p><code>slice</code>: Subset rows by position rather than filtering by values. - E.g. <code>starwars %&gt;% slice(c(1, 5))</code></p>
<p><br>
</p>
<p><code>pull</code>: Extract a column from as a data frame as a vector or scalar. - E.g. <code>starwars %&gt;% filter(gender=="female") %&gt;% pull(height)</code></p>
<p><br>
</p>
<p><code>count</code> and <code>distinct</code>: Number and isolate unique observations. - E.g. <code>starwars %&gt;% count(species)</code>, or <code>starwars %&gt;% distinct(species)</code> - You could also use a combination of <code>mutate</code>, <code>group_by</code>, and <code>n()</code>, e.g.&nbsp;<code>starwars %&gt;% group_by(species) %&gt;% mutate(num = n())</code>.</p>
<hr>
</section>
<section id="data-cleaning-and-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning-and-manipulation">Data cleaning and manipulation</h2>
<ul>
<li><p>Here, we differentiate “data cleaning” from “data manipulation”, which is perhaps an arbitrary distinction.</p></li>
<li><p>“Data cleaning” typically refers to altering variable class information, fixing mistakes that could have arisen in the data (e.g., an extra ‘.’ symbol in a numeric value), and things of this nature.</p></li>
<li><p>“Data manipulation”, in my mind, refers to altering the structure of the data in a way that changes the functional structure the data (e.g., an addition of a column, deletion of rows, long/wide formatting change).</p></li>
</ul>
</section>
<section id="gapminder-data" class="level2">
<h2 class="anchored" data-anchor-id="gapminder-data">gapminder data</h2>
<p>The gapminder data are commonly used to explore concepts of data exploration and manipulation, maybe because of the combination of character and numeric variables, nested structure in terms of country and year, or maybe it is just out of ease in copying notes from other people.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="at">file =</span> <span class="st">"http://www.stat.ubc.ca/~jenny/notOcto/STAT545A/examples/gapminder/data/gapminderDataFiveYear.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      country year      pop continent lifeExp gdpPercap
1 Afghanistan 1952  8425333      Asia  28.801  779.4453
2 Afghanistan 1957  9240934      Asia  30.332  820.8530
3 Afghanistan 1962 10267083      Asia  31.997  853.1007
4 Afghanistan 1967 11537966      Asia  34.020  836.1971
5 Afghanistan 1972 13079460      Asia  36.088  739.9811
6 Afghanistan 1977 14880372      Asia  38.438  786.1134</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1704 obs. of  6 variables:
 $ country  : chr  "Afghanistan" "Afghanistan" "Afghanistan" "Afghanistan" ...
 $ year     : int  1952 1957 1962 1967 1972 1977 1982 1987 1992 1997 ...
 $ pop      : num  8425333 9240934 10267083 11537966 13079460 ...
 $ continent: chr  "Asia" "Asia" "Asia" "Asia" ...
 $ lifeExp  : num  28.8 30.3 32 34 36.1 ...
 $ gdpPercap: num  779 821 853 836 740 ...</code></pre>
</div>
</div>
</section>
<section id="gapminder-data-1" class="level2">
<h2 class="anchored" data-anchor-id="gapminder-data-1">gapminder data</h2>
<p>We can use what we learned before in terms of base <code>R</code> functions to calculate summary statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mean life expectancy</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat<span class="sc">$</span>lifeExp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59.47444</code></pre>
</div>
</div>
<p>But what does mean life expectancy really tell us, when we also have information on space (<code>country</code>) and time (<code>year</code>)? So we may wish to subset the data to a specific country or time period. We can do this using <code>which</code> statements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>dat[<span class="fu">which</span>(dat<span class="sc">$</span>country <span class="sc">==</span> <span class="st">'Afghanistan'</span>), ]</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>dat[<span class="fu">which</span>(dat<span class="sc">$</span>year <span class="sc">&lt;</span> <span class="dv">1960</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Recall that <code>which</code> evaluates a condition, and then determines the index of each TRUE value. So for the first example, the <code>which</code> tells us the indices where the vector <code>dat$country</code> is equal to “Afghanistan”. Putting this result vector of indices within the square brackets allows us to subset the data.frame based on these indices (specifically, we are subsetting specific rows of data).</p>
<p>In the second example, we want to see all data that was recorded prior to 1960. As you will quickly realize, there are always multiple ways to do the same thing when programming. For instance, this second statement could be done in base <code>R</code> using the <code>subset</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(dat, dat<span class="sc">$</span>year <span class="sc">&lt;</span> <span class="dv">1960</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>subset</code> function also allows you to ‘select’ specific columns in the output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(dat, dat<span class="sc">$</span>year <span class="sc">&lt;</span> <span class="dv">1955</span>, <span class="at">select=</span><span class="fu">c</span>(lifeExp,gdpPercap))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, this is the same as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>dat[<span class="fu">which</span>(dat<span class="sc">$</span>year <span class="sc">&lt;</span> <span class="dv">1960</span>), <span class="fu">c</span>(<span class="st">"lifeExp"</span>,<span class="st">"gdpPercap"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gapminder-data-2" class="level2">
<h2 class="anchored" data-anchor-id="gapminder-data-2">gapminder data</h2>
<p>To refresh your memory and clarify the use of conditionals, the list below provides a bit more information.</p>
<ul>
<li><p>==: equals exactly</p></li>
<li><p>&lt;, &lt;=: is smaller than, is smaller than or equal to</p></li>
<li><p><code>&gt;</code>, &gt;=: is bigger than, is bigger than or equal to</p></li>
<li><p>!=: not equal to</p></li>
</ul>
</section>
<section id="gapminder-data-3" class="level2">
<h2 class="anchored" data-anchor-id="gapminder-data-3">gapminder data</h2>
<p>And some that we did not go into before, but will go into a bit more detail on now:</p>
<ul>
<li><p>!: NOT operator, to specify things that should be omitted</p></li>
<li><p>&amp;: AND operator, allows you to chain two conditions which must both be met</p></li>
<li><p>|: OR operator, to chains two conditions when at least one should be met</p></li>
<li><p>%in%: belongs to one of the following (usually followed by a vector of possible values)</p></li>
</ul>
<p>The AND (&amp;) and the OR (|) operators are also super useful when you want to separate data based on multiple conditions.</p>
</section>
<section id="gapminder-data-4" class="level2">
<h2 class="anchored" data-anchor-id="gapminder-data-4">gapminder data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>dat[<span class="fu">which</span>(dat<span class="sc">$</span>country<span class="sc">==</span><span class="st">'Afghanistan'</span> <span class="sc">&amp;</span> dat<span class="sc">$</span>year<span class="sc">==</span><span class="dv">1977</span>),]</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>dat[<span class="fu">which</span>(dat<span class="sc">$</span>lifeExp <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">|</span> dat<span class="sc">$</span>gdpPercap <span class="sc">&lt;</span> <span class="dv">500</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, the %in% operator is super useful when you want to subset data based on multiple conditions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fails</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>dat[<span class="fu">which</span>(dat<span class="sc">$</span>country <span class="sc">==</span> <span class="fu">c</span>(<span class="st">'Afghanistan'</span>, <span class="st">'Turkey'</span>)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         country year      pop continent lifeExp gdpPercap
1    Afghanistan 1952  8425333      Asia  28.801  779.4453
3    Afghanistan 1962 10267083      Asia  31.997  853.1007
5    Afghanistan 1972 13079460      Asia  36.088  739.9811
7    Afghanistan 1982 12881816      Asia  39.854  978.0114
9    Afghanistan 1992 16317921      Asia  41.674  649.3414
11   Afghanistan 2002 25268405      Asia  42.129  726.7341
1574      Turkey 1957 25670939    Europe  48.079 2218.7543
1576      Turkey 1967 33411317    Europe  54.336 2826.3564
1578      Turkey 1977 42404033    Europe  59.507 4269.1223
1580      Turkey 1987 52881328    Europe  63.108 5089.0437
1582      Turkey 1997 63047647    Europe  68.835 6601.4299
1584      Turkey 2007 71158647    Europe  71.777 8458.2764</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#does not fail</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>dat[<span class="fu">which</span>(dat<span class="sc">$</span>country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">'Afghanistan'</span>, <span class="st">'Turkey'</span>)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         country year      pop continent lifeExp gdpPercap
1    Afghanistan 1952  8425333      Asia  28.801  779.4453
2    Afghanistan 1957  9240934      Asia  30.332  820.8530
3    Afghanistan 1962 10267083      Asia  31.997  853.1007
4    Afghanistan 1967 11537966      Asia  34.020  836.1971
5    Afghanistan 1972 13079460      Asia  36.088  739.9811
6    Afghanistan 1977 14880372      Asia  38.438  786.1134
7    Afghanistan 1982 12881816      Asia  39.854  978.0114
8    Afghanistan 1987 13867957      Asia  40.822  852.3959
9    Afghanistan 1992 16317921      Asia  41.674  649.3414
10   Afghanistan 1997 22227415      Asia  41.763  635.3414
11   Afghanistan 2002 25268405      Asia  42.129  726.7341
12   Afghanistan 2007 31889923      Asia  43.828  974.5803
1573      Turkey 1952 22235677    Europe  43.585 1969.1010
1574      Turkey 1957 25670939    Europe  48.079 2218.7543
1575      Turkey 1962 29788695    Europe  52.098 2322.8699
1576      Turkey 1967 33411317    Europe  54.336 2826.3564
1577      Turkey 1972 37492953    Europe  57.005 3450.6964
1578      Turkey 1977 42404033    Europe  59.507 4269.1223
1579      Turkey 1982 47328791    Europe  61.036 4241.3563
1580      Turkey 1987 52881328    Europe  63.108 5089.0437
1581      Turkey 1992 58179144    Europe  66.146 5678.3483
1582      Turkey 1997 63047647    Europe  68.835 6601.4299
1583      Turkey 2002 67308928    Europe  70.845 6508.0857
1584      Turkey 2007 71158647    Europe  71.777 8458.2764</code></pre>
</div>
</div>
</section>
<section id="gapminder-data-5" class="level2">
<h2 class="anchored" data-anchor-id="gapminder-data-5">gapminder data</h2>
<p>Related to %in%, is <code>match</code>. <code>match</code> is best for identifying the index of single types in a vector of unique values. For instance,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>dat[<span class="fu">match</span>(<span class="fu">c</span>(<span class="st">'Afghanistan'</span>, <span class="st">'Turkey'</span>), dat<span class="sc">$</span>country),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         country year      pop continent lifeExp gdpPercap
1    Afghanistan 1952  8425333      Asia  28.801  779.4453
1573      Turkey 1952 22235677    Europe  43.585 1969.1010</code></pre>
</div>
</div>
</section>
<section id="gapminder-data-6" class="level2">
<h2 class="anchored" data-anchor-id="gapminder-data-6">gapminder data</h2>
<p>only returns two rows, because it only matches the first instance of both countries in the data. We can use match to get the index associated with a single value (useful when writing functions).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(<span class="st">'dog'</span>, <span class="fu">c</span>(<span class="st">'dog'</span>, <span class="st">'cat'</span>, <span class="st">'snake'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#not ideal behavior</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(<span class="st">'dog'</span>, <span class="fu">c</span>(<span class="st">'dog'</span>, <span class="st">'cat'</span>, <span class="st">'snake'</span>, <span class="st">'dog'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>or it can be used to identify multiple instances of a single value across a vector of values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(<span class="fu">c</span>(<span class="st">'dog'</span>, <span class="st">'cat'</span>, <span class="st">'snake'</span>, <span class="st">'dog'</span>), <span class="st">'dog'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1 NA NA  1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(<span class="fu">c</span>(<span class="st">'dog'</span>, <span class="st">'cat'</span>, <span class="st">'snake'</span>, <span class="st">'dog'</span>), <span class="fu">c</span>(<span class="st">'dog'</span>, <span class="st">'cat'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  2 NA  1</code></pre>
</div>
</div>
</section>
<section id="gapminder-data-7" class="level2">
<h2 class="anchored" data-anchor-id="gapminder-data-7">gapminder data</h2>
<p>While a bit opaque, these functions are pretty useful in a variety of situations. Speaking of data manipulation functions that are useful but a bit conceptually difficult, <code>do.call</code> and <code>Reduce</code> are solid base <code>R</code> functions.</p>
<p><code>do.call</code> is a way of calling the same function recursively on multiple objects, and may have similar output to <code>Reduce</code>, which is also a way to recursively apply a function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>lst <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>lst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 [1]  1  2  3  4  5  6  7  8  9 10

[[2]]
 [1]  1  2  3  4  5  6  7  8  9 10

[[3]]
 [1]  1  2  3  4  5  6  7  8  9 10

[[4]]
 [1]  1  2  3  4  5  6  7  8  9 10

[[5]]
 [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#this makes a single rbind call with each element of the list as an argument</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">do.call</span>(rbind, lst))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> int [1:5, 1:10] 1 1 1 1 1 2 2 2 2 2 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#this does it iteratively (so makes n-1 rbind calls)</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Reduce</span>(rbind, lst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
init    1    2    3    4    5    6    7    8    9    10
        1    2    3    4    5    6    7    8    9    10
        1    2    3    4    5    6    7    8    9    10
        1    2    3    4    5    6    7    8    9    10
        1    2    3    4    5    6    7    8    9    10</code></pre>
</div>
</div>
</section>
<section id="the-tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="the-tidyverse">The tidyverse</h2>
<ul>
<li><p>There are many <code>R</code> libraries designed to manipulate data and work with specific data structures (e.g., <code>purrr</code> for list objects, <code>lubridate</code> for dates, etc.).</p></li>
<li><p>For the sake of brevity and generality, we will examine one main useful packages for data manipulation: <code>dplyr</code>.</p></li>
</ul>
</section>
</section>
<section id="dplyr-specific-functions" class="level1">
<h1>dplyr-specific functions</h1>
<section id="rename" class="level2">
<h2 class="anchored" data-anchor-id="rename">rename</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">A=</span><span class="fu">runif</span>(<span class="dv">100</span>), <span class="at">B=</span><span class="fu">runif</span>(<span class="dv">100</span>), <span class="at">D=</span><span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(df, <span class="at">a=</span>A, <span class="at">b=</span>B, <span class="at">d=</span>D)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is the same functionality as the base <code>R</code> function <code>colnames</code> (or <code>names</code> for a data.frame)</p>
<pre><code>names(df2) &lt;- c('a', 'b', 'd')
#or 
names(df2) &lt;- tolower(names(df))</code></pre>
<p>The nice part about <code>dplyr::rename()</code> is that we specify the old and new column names, meaning that there is little risk of an indexing error as with using the <code>colnames()</code> or <code>names()</code> functions.</p>
</section>
<section id="select" class="level2">
<h2 class="anchored" data-anchor-id="select">select</h2>
<p>Many of the next functions are directly analogs of functions from another programming language used to query databases (SQL). This makes it really nice to learn, as you can essentially learn two languages while learning one. SQL is pretty powerful when working with relational data. I will not go into what I mean by this, unless there is time during lecture and interest among you all.</p>
<p>We use <code>dplyr::select</code> when we want to…select…columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(df2, a)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(df2, <span class="at">obs =</span> <span class="fu">starts_with</span>(<span class="st">'a'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filter" class="level2">
<h2 class="anchored" data-anchor-id="filter">filter</h2>
<p><code>dplyr::filter</code> is another one of those useful functions that we already know how to use in base <code>R</code>. Previously, we have used <code>which</code> statements or the <code>subset</code> function. <code>dplyr::filter</code> is used to filter down a data.frame by some condition applied to rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(df2, a <span class="sc">&lt;</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mutate" class="level2">
<h2 class="anchored" data-anchor-id="mutate">mutate</h2>
<p><code>dplyr::mutate</code> is used when we wish to create a new covariate based on our existing covariates. For instance, if we wanted to create a column <code>e</code> on <code>df2</code> that was the sum of <code>a+b</code> divided by <code>d</code>…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(df2, <span class="at">e=</span>(a<span class="sc">+</span>b)<span class="sc">/</span>d)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df2,<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          a          b          d           e
1 0.3243548 0.79117276  1.5810743  0.70555041
2 0.2800363 0.28220355 -0.4963027 -1.13285681
3 0.9318768 0.75790762  0.9595241  1.76106510
4 0.7583689 0.04228768  1.2519443  0.63953053
5 0.1081216 0.07187200  2.8208981  0.06380719</code></pre>
</div>
</div>
<p>Notice that the function creates a new column and appends it to the existing data.frame, but does not “write in place”. That is, the <code>df2</code> object is not modified unless it is stored (which we do above).</p>
</section>
<section id="group_by" class="level2">
<h2 class="anchored" data-anchor-id="group_by">group_by</h2>
<p><code>dplyr::group_by</code> is really useful as an intermediate step to getting at summary statistics which take into account grouping by a character or factor variable. For instance, if we wanted to calculate the mean life expectancy (<code>lifeExp</code>) for every <code>country</code> in the gapminder data (<code>dat</code>), we would first have to group by <code>country</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>datG <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(dat, country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is a bit like a non-function, since <code>dat</code> and <code>datG</code> are essentially the same….but they are not for the purposes of computing group-wise statistics. This is done using the <code>dplyr::summarise</code> function.</p>
</section>
<section id="summarise" class="level2">
<h2 class="anchored" data-anchor-id="summarise">summarise</h2>
<p>So if we wanted to calculate mean life expectancy (<code>lifeExp</code>) per country, we could use the grouped data.frame <code>datG</code> and the <code>dplyr::summarise</code> function to do so.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">summarise</span>(datG, <span class="at">mnLife=</span><span class="fu">mean</span>(lifeExp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 2
   country     mnLife
   &lt;chr&gt;        &lt;dbl&gt;
 1 Afghanistan   37.5
 2 Albania       68.4
 3 Algeria       59.0
 4 Angola        37.9
 5 Argentina     69.1
 6 Australia     74.7
 7 Austria       73.1
 8 Bahrain       65.6
 9 Bangladesh    49.8
10 Belgium       73.6
# ℹ 132 more rows</code></pre>
</div>
</div>
</section>
<section id="joins" class="level2">
<h2 class="anchored" data-anchor-id="joins">joins</h2>
<p>joins are something taken directly from SQL. Table joins are ways of combining relational data by some index variable. That is, we often have situations where our data are inherently multi-dimensional. If we have a data.frame containing rows corresponding to observations of a species at a given location, we could have another data.frame containing species-level morphometric or trait data. While we could mash this into a single data.frame, it would repeat many values, which is not ideal for data clarity or memory management.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>species <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'dog'</span>, <span class="st">'cat'</span>, <span class="st">'bird'</span>),<span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>info <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">species=</span><span class="fu">c</span>(<span class="st">'dog'</span>, <span class="st">'cat'</span>, <span class="st">'bird'</span>, <span class="st">'snake'</span>),</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">annoying=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">100</span>, <span class="dv">1</span>), </span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanBodySize=</span><span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="joins-1" class="level2">
<h2 class="anchored" data-anchor-id="joins-1">joins</h2>
<p>Now we can join some stuff together, combining data on mean species-level characteristics with individual-level observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># maintains the structure of df (the "left" data structure)</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(df, info, <span class="at">by=</span><span class="st">'species'</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># maintains the structure of info (the "right" data structure)</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="fu">right_join</span>(df,info, <span class="at">by=</span><span class="st">'species'</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co"># return things that are in info but not in df</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(info, df, <span class="at">by=</span><span class="st">'species'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are other forms of joins (<code>full_join</code>, <code>inner_join</code>, etc.), but I find that I mostly use the <code>left</code> or <code>right</code> variations of the joins, as it specifically allows me to control the output (i.e., using <code>dplyr::left_join</code>, I know that the resulting data.frame will have the same number of rows as the left hand data.frame).</p>
</section>
<section id="piping" class="level2">
<h2 class="anchored" data-anchor-id="piping">piping</h2>
<p>Alright. So before we discussed joins, we were describing the different main verbs of <code>dplyr</code>. We discussed <code>rename</code>, <code>select</code>, <code>mutate</code>, <code>group_by</code>, and <code>summarise</code>. A final point, and something <code>tidyverse</code> folks really love, is the use of these functions in nested statements through the use of piping.</p>
<p>Pipes in bash scripting look like |, pipes in <code>R</code> syntax look like %&gt;%. It does not matter what it looks like though, it matter what it does. Here is a simple example of the use of piping. We can go back to the example of calculating the mean life expectancy per country from the gapminder data.</p>
<p>The usual way</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(dat, country)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(tmp, <span class="at">mnLifeExp=</span><span class="fu">mean</span>(lifeExp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The piped way</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>tmp3 <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">mnLifeExp=</span><span class="fu">mean</span>(lifeExp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results of these two are identical (<code>all(tmp3==tmp2)</code> returns TRUE).</p>
<p>This is useful, as commands can be chained together, including the creation of new variables, subsetting and summarising of existing variables, etc. One thing to keep in mind is to check intermediate results – instead of just piping all the way through – as data manipulation errors can be introduced mid-statement and go unnoticed. That is, in some situations, piping does not help reproducibility. Many proponents argue that it helps with code readability, while many others say that actively makes code less human readable. It definitely does require adopting a certain syntax and the assumption that every end user is on the <code>tidyverse</code> train, which is not ideal when reproducibility involves everyone, not just the cool tidy/Hadley/RStudio crowd.</p>
</section>
</section>
<section id="next-time" class="level1">
<h1>Next time</h1>
<ul>
<li>Exploratory data analysis - what do you do immediately after collecting your data?</li>
</ul>
</section>
<section id="week-7a---exploratory-data-analysis" class="level1">
<h1>Week 7A - Exploratory Data Analysis</h1>
<section id="midterm-feedback" class="level2">
<h2 class="anchored" data-anchor-id="midterm-feedback">Midterm Feedback</h2>
<ul>
<li>Thank you all for providing thoughtful feedback on the last Problem Set!</li>
<li>You all really enjoy in-class exercises - we’ll do more of that!</li>
<li>The homework difficulty doesn’t always align well with the lectures - will try to remedy this</li>
</ul>
</section>
</section>
<section id="where-do-we-begin" class="level1">
<h1>Where do we begin?</h1>
<ul>
<li>A major goal of statistics is to estimate <strong>parameters</strong> of a population so that we can compare them to values that are of practical importance to our understanding of the system, or to compare parameter estimates between and among different populations</li>
<li>This is the first important step before getting to hypothesis testing!</li>
</ul>
<section id="understanding-populations-and-their-parameters" class="level2">
<h2 class="anchored" data-anchor-id="understanding-populations-and-their-parameters">Understanding Populations and their Parameters</h2>
<ul>
<li>We often think about the samples we are collecting as a part of a larger population</li>
<li>Since we can’t measure every member of that population, we instead use sampling to estimate the parameters of the population as a whole
<ul>
<li>Some common parameters: mean, range, median</li>
<li>If we performed random sampling, we assume that the parameter estimates of our sample are equitable to the true population parameters</li>
</ul></li>
</ul>
</section>
</section>
<section id="simulations-to-compare-parameter-estimates" class="level1">
<h1>Simulations to compare parameter estimates</h1>
<ul>
<li>Let’s use our distribution functions from last time to set up some data to play with</li>
<li>Let’s imagine our data is made up of counts, with an average of 5 counts - which distribution would fit that data best?</li>
<li>Ex: number of hours spent doing homework by UO undergraduates</li>
</ul>
</section>
<section id="simulations-to-compare-parameter-estimates-1" class="level1">
<h1>Simulations to compare parameter estimates</h1>
<ul>
<li>Let’s use our distribution functions from last time to set up some data to play with</li>
<li>Let’s imagine our data is made up of counts, with an average of 5 counts - which distribution would fit that data best?</li>
<li>Ex: number of hours spent doing homework by UO undergraduates</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>true_pop <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(true_pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="simulations-to-compare-parameter-estimates-2" class="level2">
<h2 class="anchored" data-anchor-id="simulations-to-compare-parameter-estimates-2">Simulations to compare parameter estimates</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>true_pop <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(true_pop, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">16</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculating-parameters" class="level2">
<h2 class="anchored" data-anchor-id="calculating-parameters">Calculating parameters</h2>
<ul>
<li>How would we calculate the mean and range for this population?</li>
</ul>
</section>
<section id="calculating-parameters-1" class="level2">
<h2 class="anchored" data-anchor-id="calculating-parameters-1">Calculating parameters</h2>
<ul>
<li>How would we calculate the mean and range for this population?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(true_pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.927</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(true_pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0 13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(true_pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
</section>
</section>
<section id="sampling" class="level1">
<h1>Sampling</h1>
<ul>
<li>Those values represent our true population parameters, which we often cannot know.</li>
<li>Sampling is the method used in academia and science to try and estimate the true population values.</li>
<li>We have also discussed how <strong>sample size</strong> can greatly affect the accuracy of our estimates</li>
</ul>
<section id="sampling-exercise" class="level2">
<h2 class="anchored" data-anchor-id="sampling-exercise">Sampling Exercise</h2>
<ul>
<li>Since we are working with simulated data, we can also afford to simulate our sampling!</li>
<li>Try taking a sample from our <code>true_pop</code> dataset and change the sample size, then calculate the mean and range for your sample and see how it compares to the true values.</li>
<li>How many college students are you including in your survey?</li>
</ul>
</section>
<section id="sampling-exercise-1" class="level2">
<h2 class="anchored" data-anchor-id="sampling-exercise-1">Sampling Exercise</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean: " "4.95"  </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Range: " "1"       "10"     </code></pre>
</div>
</div>
</section>
<section id="randomness-in-sampling" class="level2">
<h2 class="anchored" data-anchor-id="randomness-in-sampling">Randomness in Sampling</h2>
<ul>
<li>Because of the randomness of sampling, you may get close to the true estimates even with a small sample size - but your results will change each time you take a new sample of the same size</li>
<li>How do we get a feel for how accurate each sample size is? Or which sample size is recommended?</li>
</ul>
</section>
<section id="surveying-your-sampling" class="level2">
<h2 class="anchored" data-anchor-id="surveying-your-sampling">Surveying your Sampling</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>samps_var <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">50</span>, <span class="fu">sample</span>(true_pop, <span class="dv">10</span>)) <span class="co">#Take 50 samples of size 10</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>samps_var_means <span class="ot">&lt;-</span> <span class="fu">apply</span>(samps_var, <span class="dv">2</span>, mean) <span class="co">#Calculate the mean from each sample</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(samps_var_means) <span class="co">#Plot the distribution of sample means</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="surveying-your-sampling-1" class="level2">
<h2 class="anchored" data-anchor-id="surveying-your-sampling-1">Surveying your Sampling</h2>
<ul>
<li>We get close to the true mean (4.9) about 2/3rds of the time - is this good enough?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(samps_var_means <span class="sc">&gt;</span> <span class="fl">4.5</span> <span class="sc">&amp;</span> samps_var_means <span class="sc">&lt;</span> <span class="fl">5.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
   19    31 </code></pre>
</div>
</div>
</section>
<section id="surveying-your-sampling-2" class="level2">
<h2 class="anchored" data-anchor-id="surveying-your-sampling-2">Surveying your Sampling</h2>
<ul>
<li>This sampling variation is what we have to deal with, and account for, as empirical scientists.</li>
<li>If this had been a real-world scenario, we likely would be basing our estimate for the true mean on just a single sample mean.</li>
<li>Getting close to the idea of <strong>power</strong> - does our experimental design have the power to detect the parameters we are interested in?</li>
</ul>
</section>
</section>
<section id="sampling-distributions" class="level1">
<h1>Sampling Distributions</h1>
<ul>
<li>The previous exercise illustrates the concept of a sampling distribution.</li>
<li>We sampled over and over again (50 times) and calculated the mean for each sample to demonstrate the sampling distribution for the mean, our original parameter of interest.</li>
<li>One important point is that the sampling distribution for a given parameter is often very different from the variable’s distribution in the population. In many cases, the sampling distribution is normal or approximately so.</li>
</ul>
<section id="normal-sampling-distributions" class="level2">
<h2 class="anchored" data-anchor-id="normal-sampling-distributions">Normal Sampling Distributions</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.025.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="normal-sampling-distributions-1" class="level2">
<h2 class="anchored" data-anchor-id="normal-sampling-distributions-1">Normal Sampling Distributions</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week2b_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sampling-distributions---its-been-normal-this-whole-time" class="level2">
<h2 class="anchored" data-anchor-id="sampling-distributions---its-been-normal-this-whole-time">Sampling Distributions - It’s been Normal this whole time?!</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week7_normalsampling.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sampling-distributions---exercise" class="level2">
<h2 class="anchored" data-anchor-id="sampling-distributions---exercise">Sampling Distributions - Exercise</h2>
<ul>
<li>Try creating some data using one of the other distributions we discussed last time (Exponential Distribution) and then create a sampling distribution. Is it normal?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>true_pop <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, rate)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>samps_var <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> , <span class="fu">sample</span>(true_pop, <span class="at">size =</span> ))</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>samps_var_means <span class="ot">&lt;-</span> <span class="fu">apply</span>(samps_var, <span class="dv">2</span>, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-central-limit-theorem" class="level2">
<h2 class="anchored" data-anchor-id="the-central-limit-theorem">The Central Limit Theorem</h2>
<ul>
<li>For most real world data sets we can’t empirically determine a sampling distribution by taking many actual samples, because we often have just the one sample.</li>
<li>Fortunately, we can rely on the <strong>Central Limit Theorem</strong> to make some assumptions about sampling distributions, particularly when estimating a mean from a single sample, or when estimating most any parameter using a “pseudo” or re-sampling process we refer to as “<strong>bootstrapping</strong>”</li>
</ul>
</section>
</section>
<section id="standard-error---the-range-of-the-sampling-distribution" class="level1">
<h1>Standard Error - the Range of the Sampling Distribution</h1>
<ul>
<li>The sampling distribution models all values we might have obtained from our sample and their probabilities of occurrence.</li>
<li>The standard error of an estimate can be conceptualized as the standard deviation of a sampling distribution.</li>
<li>So, whenever we obtain a parameter estimate, we need to include the standard error in some form or another, which is a measure of the precision of our estimate.</li>
</ul>
<section id="standard-error" class="level2">
<h2 class="anchored" data-anchor-id="standard-error">Standard Error</h2>
<ul>
<li>The sample size and the spread of the distribution (range) - contribute to what is known as the standard error of a random variable.</li>
<li>The standard error for any given sample attribute (such as a sample mean), can be calculated either based on distributional assumptions, or by a process called “resampling.”</li>
</ul>
</section>
<section id="standard-error-1" class="level2">
<h2 class="anchored" data-anchor-id="standard-error-1">Standard error</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week_2.028.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculating-the-standard-error" class="level2">
<h2 class="anchored" data-anchor-id="calculating-the-standard-error">Calculating the Standard Error</h2>
<ul>
<li>Standard Error of the Mean (SEM)</li>
<li>SEM = SD / sqrt(sample size)</li>
</ul>
</section>
<section id="calculating-the-standard-error-1" class="level2">
<h2 class="anchored" data-anchor-id="calculating-the-standard-error-1">Calculating the Standard Error</h2>
<ul>
<li>Think conceptually - how will SEM change as sample size increases?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>true_pop <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>samps_var <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="fu">sample</span>(true_pop, <span class="at">size =</span> <span class="dv">5</span>))</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>samps_var_means <span class="ot">&lt;-</span> <span class="fu">apply</span>(samps_var, <span class="dv">2</span>, mean)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>sem <span class="ot">=</span> <span class="fu">sd</span>(samps_var_means)<span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(samps_var_means))</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1299607</code></pre>
</div>
</div>
</section>
</section>
<section id="bootstrapping" class="level1">
<h1>Bootstrapping</h1>
<p>-Unfortunately, most other kinds of estimates (anything not the mean) do not have this amazing property, but we can rely on another approach to calculate the standard error. - This involves generating your own sampling distribution for the estimate using the “<strong>bootstrap</strong>,” a method invented by Efron (1979). - We call the bootstrap, and other methods that do not rely on distributional assumptions of the variable itself, “<strong>nonparametric</strong>” approaches.</p>
<section id="easy-steps-for-bootstrapping-in-r" class="level2">
<h2 class="anchored" data-anchor-id="easy-steps-for-bootstrapping-in-r">Easy steps for bootstrapping in R</h2>
<ol type="1">
<li>Take a random sample (with replacement) from your sample data</li>
<li>Calculate the estimate using the measurements in the bootstrap sample (step 1). This is the first bootstrap replicate estimate</li>
<li>Repeat steps 1 and 2 a large number of times (1000 times is reasonable)</li>
<li>Calculate the sample standard deviation of all the bootstrap replicate estimates obtained in step 3 (SSD = sd(sample)/sqrt(sample size))</li>
</ol>
</section>
<section id="bootstrapping-1" class="level2">
<h2 class="anchored" data-anchor-id="bootstrapping-1">Bootstrapping</h2>
<ul>
<li>The resulting quantity is called the “bootstrap standard error”</li>
<li>The bootstrap can be applied to almost any sample statistic, including means, proportions, correlations, and regression parameters.</li>
<li>It works when there is no ready formula for a standard error, for example when estimating the median, trimmed mean, correlation, eigenvalue, etc.</li>
<li>It is nonparametric, so doesn’t require normally-distributed data, as mentioned. - - It works well for parameter estimates that are based on complicated sampling procedures or calculations. For example, it is used to assess confidence in local relationships within phylogenetic trees.</li>
</ul>
</section>
<section id="confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="confidence-intervals">Confidence Intervals</h2>
<ul>
<li>A confidence interval is a range of values about a parameter estimate, such that we are X% certain that the true population parameter value lies within that interval.</li>
<li>For now, know that for a normally distributed sample, a confidence interval about the population mean can be calculated using the t.test() function in base R.</li>
<li>The 95% confidence interval is commonly reported in statistical analysis results, by convention, but other values are occasionally reported as well.</li>
</ul>
</section>
</section>
<section id="relationship-between-mean-and-variance" class="level1">
<h1>Relationship between Mean and Variance</h1>
<ul>
<li>Population means and variances (and hence standard deviations) tend to have a strong, positive relationship.</li>
<li>So an otherwise similarly shaped distribution, but with a much larger mean, will by default have a much larger standard deviation</li>
</ul>
<section id="relationship-between-mean-and-variance-1" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-mean-and-variance-1">Relationship between mean and variance</h2>
<ul>
<li>This means it is inappropriate to compare variations of different populations with largely different means
<ul>
<li>For instance, comparing the standard deviation for a body measurement in a population of mice, with the same body measurement in a population of elephants is not meaningful.</li>
</ul></li>
</ul>
</section>
<section id="test-it-out" class="level2">
<h2 class="anchored" data-anchor-id="test-it-out">Test it out</h2>
<ul>
<li>Try changing the lambda of the original population, and see how the SD changes</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>true_pop <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sd</span>(true_pop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="coefficient-of-variation" class="level2">
<h2 class="anchored" data-anchor-id="coefficient-of-variation">Coefficient of Variation</h2>
<ul>
<li>To make standard deviations comparable across populations with very different means, we can instead compare a standardized metric called the “coefficient of variation” (CV), which is simply the sample standard deviation divided by the sample mean (and usually expressed as a % by multiplying by 100).</li>
</ul>
<hr>
<hr>
</section>
</section>
<section id="week-6a-ethics-in-data-science" class="level1">
<h1>Week 6A: Ethics in Data Science</h1>
<section id="today-well-be-talking-about" class="level2">
<h2 class="anchored" data-anchor-id="today-well-be-talking-about">Today we’ll be talking about</h2>
<ul>
<li>A roadmap for the rest of the term</li>
<li>The unethical history of statistics and data science</li>
<li>Last week’s homework</li>
</ul>
</section>
</section>
<section id="what-stats-are-we-learning" class="level1">
<h1>What Stats are we learning?</h1>
<ul>
<li>Probability, distributions, and sampling</li>
<li>Exploratory data analysis</li>
<li>Test statistics, p-values, type 1 and 2 errors</li>
<li>Types of data, t-tests</li>
<li>Linear models, ordinary least squares, ANOVA</li>
<li>Experimental design</li>
</ul>
<section id="thinking-about-your-final-project" class="level2">
<h2 class="anchored" data-anchor-id="thinking-about-your-final-project">Thinking about your final project</h2>
<ul>
<li>As we’re going through these statistical techniques, think about which one(s) might be most appropriate for your data analysis.</li>
<li>The project ideally will take in some sort of raw data, analyze it (summary statistics, significance tests), and plot your findings.</li>
<li>Can incorporate Unix and/or R, can be presented via a script and/or RMarkdown document.</li>
</ul>
</section>
</section>
<section id="the-history-of-statistics" class="level1">
<h1>The History of Statistics</h1>
<section id="galton-as-the-father-of-eugenics" class="level2">
<h2 class="anchored" data-anchor-id="galton-as-the-father-of-eugenics">Galton as the Father of Eugenics</h2>
<ul>
<li>Francis Galton: Darwin’s half cousin</li>
<li>Studied human variation and genetic inheritance
<ul>
<li>Human height, fingerprints, intelligence</li>
<li>Correlation, regression toward the mean, and “nature versus nurture”</li>
<li>Pioneered twin studies</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week6_Galton.jpeg" class="img-fluid figure-img" data-fig.align="center"></p>
<figcaption>Galton</figcaption>
</figure>
</div>
</section>
<section id="galton-as-the-father-of-eugenics-1" class="level2">
<h2 class="anchored" data-anchor-id="galton-as-the-father-of-eugenics-1">Galton as the Father of Eugenics</h2>
<ul>
<li>Believed that intelligence was hereditary based on surveying prominent academics in Europe</li>
<li>Used the ideas of <strong>correlation</strong> and <strong>regression towards the mean</strong> to argue that the upper class should breed amongst themselves to keep those “good genes” pure</li>
<li>Wanted to provide monetary incentives for “good” couples to marry and reproduce as a way to avoid the upper class being genetically muddied by the lower class</li>
</ul>
</section>
<section id="a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s" class="level2">
<h2 class="anchored" data-anchor-id="a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s">A common sight at state fairs around the U.S. in the 1930s</h2>
<ul>
<li>Competitions for the “perfect family” to encourage public consciousness and support for eugenics</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.013.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="galton-with-charles-davenport-and-g.-stanley-hall" class="level2">
<h2 class="anchored" data-anchor-id="galton-with-charles-davenport-and-g.-stanley-hall">Galton with Charles Davenport and G. Stanley Hall</h2>
<ul>
<li>American Eugenics Record Office (ERO) founded in Cold Springs Harbor</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.014.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="logo-of-the-us-eugenics-society" class="level2">
<h2 class="anchored" data-anchor-id="logo-of-the-us-eugenics-society">Logo of the US eugenics society</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.015.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="eugenics-societies-in-america" class="level2">
<h2 class="anchored" data-anchor-id="eugenics-societies-in-america">Eugenics societies in America</h2>
<ul>
<li>Advocated for state laws to ban interracial marriages and promote sterilization of “unfit” individuals (negative eugenics) - especially black, Latinx, and Native American women</li>
<li>30 states passed laws to force mental institution patients to be sterilized</li>
<li>Between 1907 and 1963, over 64,000 individuals were forcibly sterilized under eugenic legislation in the United States</li>
</ul>
</section>
<section id="ra-fisher-and-eugenics-in-london" class="level2">
<h2 class="anchored" data-anchor-id="ra-fisher-and-eugenics-in-london">RA Fisher and Eugenics in London</h2>
<ul>
<li>Developer of Fishers exact test, analysis of variance (ANOVA), null hypothesis, p values, maximum likelihood, probability density functions</li>
<li>Founding Chairman of the University of Cambridge Eugenics Society</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week6_fisher.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:20.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ra-fisher-and-eugenics" class="level2">
<h2 class="anchored" data-anchor-id="ra-fisher-and-eugenics">RA Fisher and Eugenics</h2>
<ul>
<li>1/3rd of his work “The Genetical Theory of Natural Selection” discussed eugenics and his theory that the fall of civilizations was due to the fertility of their upper classes being diminished</li>
<li>Used these statistical methods to test data on human variation to prove biological differences between human races</li>
<li>Eugenics and racism were the primary motivators for many of these statistical tests that we use today</li>
</ul>
</section>
<section id="eugenics-has-a-direct-line-to-hitler-and-nazism" class="level2">
<h2 class="anchored" data-anchor-id="eugenics-has-a-direct-line-to-hitler-and-nazism">Eugenics has a direct line to Hitler and Nazism</h2>
<ul>
<li>Eugenics existed in America (and England) before it became popular in Germany.</li>
<li>By 1933, California had subjected more people to forceful sterilization than all other U.S. states combined.</li>
<li>The forced sterilization program engineered by the Nazis was partly inspired by California’s.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.016.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sterilizations-continue-in-america" class="level2">
<h2 class="anchored" data-anchor-id="sterilizations-continue-in-america">Sterilizations continue in America</h2>
<ul>
<li>Our history books paint Nazi Germany as the primary evil of that time, while we try to cover up our significant role in eugenics</li>
<li>It wasn’t until 1978 that the US passed regulations on sterilization procedures</li>
<li>California only passed a bill to outlaw sterilization of inmates in 2014</li>
<li>Certain members of the genetic engineering community threaten to bring back eugenics ideas</li>
</ul>
</section>
<section id="so-what-do-we-do-from-here" class="level2">
<h2 class="anchored" data-anchor-id="so-what-do-we-do-from-here">So, what do we do from here?</h2>
<ul>
<li>The statistical methods that Galton, Fisher, and others developed are useful science tools</li>
<li>Important to use these tools for good - improving our planet, human health, and technology</li>
<li>Important to acknowledge and not forget the history of science - educate others to avoid repeating history</li>
</ul>
</section>
<section id="interested-in-learning-more" class="level2">
<h2 class="anchored" data-anchor-id="interested-in-learning-more">Interested in learning more?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:20.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>See also “The Gene” by Siddhartha Mukherjee</li>
</ul>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>